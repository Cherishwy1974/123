<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1920, initial-scale=1.0">
    <title>02_2.1_æé™çš„å®šä¹‰ä¸å­˜åœ¨æ¡ä»¶</title>

    <!-- æœ¬åœ°æ€æºå®‹ä½“å­—ä½“æ–‡ä»¶ -->
    <link rel="stylesheet" href="./noto-serif-sc.css">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            /* ä½¿ç”¨æœ¬åœ°æ€æºå®‹ä½“ï¼Œæä¾›ä¼˜é›…çš„ä¸­æ–‡æ˜¾ç¤ºæ•ˆæœ */
            font-family: 'Noto Serif SC', 'Source Han Serif SC', 'Source Han Serif CN',
                         'Songti SC', 'SimSun', 'å®‹ä½“', serif;
            background: #1a1a2e;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        .blackboard {
            width: 100vw;
            height: 100vh;
            background: #1a1a2e;
            position: relative;
            border: 10px solid #795548;
            margin: 0;
        }

        /* è™šæ‹Ÿäººæ˜¾ç¤ºåŒºåŸŸ - ç¨å¾®ä¸‹ç§»ï¼Œé¿å…é®æŒ¡å†…å®¹ */
        .avatar-container {
            position: fixed;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 975px;
            height: 1105px;
            overflow: hidden;
            z-index: 50;
            pointer-events: none;
            background: transparent;
            border: none;
            box-shadow: none;
        }

        .wrapper {
            width: 100%;
            height: 100%;
            background: transparent;
            pointer-events: auto;
        }

        /* æ•™å­¦å†…å®¹åŒºåŸŸ - é¿è®©è™šæ‹Ÿäººï¼Œå·¦å³åˆ†å¸ƒ */
        .content-area {
            position: absolute;
            top: 20px;
            left: 50px;
            right: 50px;
            bottom: 120px;
            z-index: 10;
            overflow: hidden;
        }

        .page {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            opacity: 0;
            visibility: hidden;
            transition: all 0.7s ease-in-out;
            padding: 20px;
            display: grid;
            grid-template-columns: 2fr 3fr; /* è°ƒæ•´æ¯”ä¾‹ï¼Œç»™å›¾æ›´å¤§ç©ºé—´ */
            gap: 20px;
            align-items: center;
        }

        .page.active {
            opacity: 1;
            visibility: visible;
        }

        /* ç¬¬1é¡µï¼ˆå°é¢ï¼‰ç‰¹æ®Šæ ·å¼ */
        .page[data-page="1"] {
            display: flex;
            grid-template-columns: none;
        }

        .page[data-page="1"] > div {
            display: flex;
            width: 100%;
            height: 100%;
        }

        .page[data-page="10"] {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* æ€»ç»“é¡µæ ·å¼ */
        .intro-box {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            color: #ffffff;
        }

        .course-title {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            color: #f1c40f;
            margin-bottom: 0.5rem;
        }

        .course-subtitle {
            font-size: 1.2rem;
            text-align: center;
            color: #9ca3af;
            margin-bottom: 2rem;
        }

        .content-list {
            margin: 2rem 0;
        }

        .content-item {
            font-size: 1.1rem;
            padding: 0.8rem 1.5rem;
            margin: 0.8rem 0;
            background: rgba(255,255,255,0.1);
            border-left: 4px solid #4CAF50;
            border-radius: 5px;
            color: #e0e0e0;
        }

        .chalk-text {
            color: #ffffff;
            font-family: 'Noto Serif SC', 'Source Han Serif SC', 'Source Han Serif CN',
                         'Songti SC', 'SimSun', 'å®‹ä½“', serif;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .page-title {
            font-size: 24px;
            font-weight: bold;
            color: #e1bee7;
            margin-bottom: 1.5rem;
        }


        .text-large {
            font-size: 20px;
            margin-bottom: 0.8rem;
            color: #81c784;
            font-weight: 600;
            line-height: 1.4;
        }

        .text-medium {
            font-size: 16px;
            margin-bottom: 0.8rem;
            line-height: 1.7;
            color: #f3e5f5;
            font-weight: 500;
        }

        .emphasis {
            color: #FF6B6B;
            font-size: 18px;
        }

        .text-medium p {
            margin-bottom: 1rem;
        }

        .text-medium strong {
            color: #81c784;
            font-weight: 600;
        }

        .graph-container {
            background: transparent;
            border: none;
            padding: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ - é»˜è®¤éšè— */
        .status-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background: rgba(0,0,0,0.5);
            color: white;
            border-radius: 5px;
            font-size: 12px;
            z-index: 100;
            transition: opacity 0.3s ease;
            display: none; /* é»˜è®¤éšè—çº¢è‰²æç¤º */
        }

        .status-indicator.connected { background: rgba(76, 175, 80, 0.8); }
        .status-indicator.recording {
            background: rgba(244, 67, 54, 0.8);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .status-indicator.error { background: rgba(244, 67, 54, 0.8); }
        .status-indicator.connecting { background: rgba(255, 152, 0, 0.8); }

        /* å½•åˆ¶æ¨¡å¼ä¸‹éšè—çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .recording-mode .status-indicator {
            opacity: 0; pointer-events: none;
        }
        /* å½•åˆ¶æ¨¡å¼ä¸‹éšè—æ§åˆ¶æ  */
        .recording-mode .control-bar {
            left: -9999px; transition: left 0.5s ease;
        }
        /* å½•åˆ¶æ¨¡å¼ä¸‹ç¡®ä¿è™šæ‹Ÿäººå®¹å™¨å¯è§ */
        .recording-mode .avatar-container {
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
        }

        /* æ§åˆ¶æ  */
        .control-bar {
            position: fixed;
            left: -9999px;
            top: 50%;
            transform: translateY(-50%);
            width: 270px;
            height: auto;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            z-index: 200;
            border-radius: 0 20px 20px 0;
            padding: 25px 20px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .control-bar:hover { 
            left: -9999px; 
            box-shadow: 0 12px 40px rgba(0,0,0,0.3); 
        }

        .control-bar::before {
            content: 'â–¶ï¸';
            position: absolute;
            top: 50%;
            right: -30px;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 12px 8px;
            border-radius: 0 15px 15px 0;
            font-size: 0.9rem;
            writing-mode: vertical-lr;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #333;
        }

        .btn {
            padding: 14px 22px;
            background: rgba(255, 255, 255, 0.25);
            color: #333;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            text-align: center;
            backdrop-filter: blur(5px);
            text-shadow: 0 1px 2px rgba(255,255,255,0.3);
        }

        .btn:hover {
            background: rgba(255, 255, 255, 0.35);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .btn.primary:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            box-shadow: 0 8px 25px rgba(102,126,234,0.4);
        }

        /* å­—å¹•åŒºåŸŸ - å…¨å®½æ˜¾ç¤ºï¼Œè™šæ‹Ÿäººä¸å½±å“å¸ƒå±€ */
        .subtitle-area {
            position: absolute;
            bottom: 20px;
            left: 50px;
            right: 50px;
            height: 50px;
            background: rgba(0,0,0,0.8);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 60;
            color: white;
            font-size: 0.9rem;
            text-align: center;
            padding: 0 20px;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="blackboard">
        <div id="statusIndicator" class="status-indicator">ç­‰å¾…è¿æ¥</div>

        <!-- è™šæ‹Ÿäººæ˜¾ç¤ºåŒºåŸŸ -->
        <div class="avatar-container">
            <div class="wrapper" id="avatarWrapper"></div>
        </div>

        <div class="content-area">
            <!-- ç¬¬1é¡µï¼šè¯¾æ—¶å¯¼è¯­ -->
            <div class="page active" data-page="1">
                <div style="display: flex; width: 100%; height: 100%; align-items: center; justify-content: center;">
                    <div style="flex: 1; text-align: center; padding: 2rem;">
                        <h1 style="font-size: 2.2rem; font-weight: bold; color: #f1c40f; text-shadow: 0 0 8px rgba(241, 196, 15, 0.5); margin-bottom: 1rem;">
                            æé™çš„å®šä¹‰ã€æ€§è´¨ä¸å­˜åœ¨æ¡ä»¶
                        </h1>
                        <p style="font-size: 1.1rem; color: #9ca3af; margin-bottom: 1.5rem;">
                            ç¬¬2ç«  è§†é¢‘ 2.1
                        </p>
                        <div style="display: inline-block; text-align: left; margin-top: 1.5rem;">
                            <p style="font-size: 0.95rem; color: #e0e0e0; margin: 0.6rem 0;">âœ“ æé™çš„ç›´è§‚ç†è§£ä¸å®šä¹‰</p>
                            <p style="font-size: 0.95rem; color: #e0e0e0; margin: 0.6rem 0;">âœ“ å·¦æé™ä¸å³æé™çš„æ¦‚å¿µ</p>
                            <p style="font-size: 0.95rem; color: #e0e0e0; margin: 0.6rem 0;">âœ“ æé™å­˜åœ¨çš„å……è¦æ¡ä»¶</p>
                            <p style="font-size: 0.95rem; color: #e0e0e0; margin: 0.6rem 0;">âœ“ æ— ç©·æé™çš„åˆ¤æ–­æ–¹æ³•</p>
                        </div>
                    </div>
                    <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
                        <svg style="width: 100%; max-width: 500px; height: 400px;" viewBox="0 0 600 500">
                            <defs>
                                <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#f39c12;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#e74c3c;stop-opacity:1" />
                                </linearGradient>
                            </defs>
                            <text x="300" y="150" font-size="60" fill="url(#grad1)" text-anchor="middle" font-family="serif">
                                lim
                                <animate attributeName="opacity" values="0;1;1;0.7" dur="3s" repeatCount="indefinite"/>
                            </text>
                            <circle cx="200" cy="300" r="40" fill="none" stroke="#3498db" stroke-width="3">
                                <animate attributeName="r" values="40;50;40" dur="2s" repeatCount="indefinite"/>
                            </circle>
                            <circle cx="400" cy="300" r="40" fill="none" stroke="#e74c3c" stroke-width="3">
                                <animate attributeName="r" values="40;50;40" dur="2s" begin="1s" repeatCount="indefinite"/>
                            </circle>
                            <line x1="200" y1="340" x2="400" y2="340" stroke="#f39c12" stroke-width="2" stroke-dasharray="5,5">
                                <animate attributeName="opacity" values="0;1;0" dur="4s" repeatCount="indefinite"/>
                            </line>
                            <text x="300" y="380" font-size="24" fill="#ecf0f1" text-anchor="middle">æé™å­˜åœ¨æ¡ä»¶</text>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- ========== ç¬¬2-6é¡µï¼šæœ‰é™ç‚¹æé™å†…å®¹ï¼ˆæ¥è‡ªåŸæ–‡ä»¶é¡µé¢1-5ï¼‰========== -->

            <!-- ç¬¬2é¡µï¼šå°çƒæ¢é™©æ•…äº‹ä»‹ç» -->
            <div class="page" data-page="2">
                <div class="chalk-text">
                    <div class="page-title">ğŸ¯ å°çƒæ¢é™©ï¼šå‡½æ•°æé™çš„å¥¥ç§˜</div>
                    <div class="text-medium">
                        <p><strong>æ¬¢è¿æ¥åˆ°å‡½æ•°æé™çš„å¥‡å¦™ä¸–ç•Œï¼</strong></p>
                        <p>ä»Šå¤©æˆ‘ä»¬è¦é€šè¿‡ä¸¤ä¸ªå‹‡æ•¢å°çƒçš„æ¢é™©æ•…äº‹ï¼Œæ¥å­¦ä¹ ä¸€ä¸ªé‡è¦çš„æ•°å­¦æ¦‚å¿µï¼š<strong>å·¦æé™ä¸å³æé™</strong></p>
                        <p>è®©æˆ‘ä»¬çœ‹çœ‹å½“ $x$ é€¼è¿‘æŸä¸€ç‚¹ $x_0$ æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆå¥‡å¦™çš„äº‹æƒ…...</p>
                    </div>
                </div>
                <div class="graph-container">
                    <video
                        id="mainDemoVideo"
                        width="100%"
                        height="100%"
                        controls
                        muted
                        autoplay
                        loop
                        style="max-height: 450px;">
                        <source src="./å½©è‰²å°çƒç›¸é‡åŠ¨ç”»ç”Ÿæˆ.mp4" type="video/mp4">
                        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
                    </video>
                </div>
            </div>

            <!-- ç¬¬3é¡µï¼šæ–­æ¡¥ä¸Šçš„å°çƒå†’é™© -->
            <div class="page" data-page="3">
                <div class="chalk-text">
                    <div class="page-title">ğŸ“– æ•…äº‹ä¸€ï¼šæ–­æ¡¥ä¸Šçš„å°çƒå†’é™©</div>
                    <div class="text-medium">
                        <p><strong>ğŸ”´ çº¢è‰²å°çƒçš„ä»»åŠ¡</strong></p>
                        <p>â€¢ ä»å·¦è¾¹å‡ºå‘ï¼Œæƒ³è¦åˆ°è¾¾ç›®æ ‡ç‚¹ $x_0 = 1$<br>
                        â€¢ æ²¿ç€å‡½æ•°æ›²çº¿å‹‡æ•¢å‰è¿›<br>
                        â€¢ ä½†æ˜¯é‡åˆ°äº†ä¸€åº§ç¥ç§˜çš„æ–­æ¡¥ï¼</p>
                        
                        <p><strong>ğŸŸ¢ ç»¿è‰²å°çƒçš„ä»»åŠ¡</strong></p>
                        <p>â€¢ ä»å³è¾¹å‡ºå‘ï¼Œä¹Ÿæƒ³åˆ°è¾¾ç›®æ ‡ç‚¹ $x_0 = 1$<br>
                        â€¢ åŒæ ·æ²¿ç€å‡½æ•°æ›²çº¿å‰è¿›<br>
                        â€¢ ä¹Ÿé‡åˆ°äº†åŒä¸€åº§æ–­æ¡¥ï¼</p>
                        
                        <p class="emphasis">ğŸ¤” é—®é¢˜ï¼šå®ƒä»¬èƒ½åˆ°è¾¾ç›¸åŒçš„é«˜åº¦å—ï¼Ÿ</p>
                    </div>
                </div>
                <div class="graph-container">
                    <div id="graph1" style="width: 100%; height: 450px;"></div>
                </div>
            </div>

            <!-- ç¬¬4é¡µï¼šåŠ¨æ€æ¼”ç¤º -->
            <div class="page" data-page="4">
                <div class="chalk-text">
                    <div class="page-title">ğŸ¬ åŠ¨æ€æ¼”ç¤ºï¼šå°çƒçš„å†’é™©ä¹‹æ—…</div>
                    <div class="text-medium">
                        <p><strong>ğŸ­ è§‚å¯Ÿè¦ç‚¹</strong></p>
                        <p>â€¢ çº¢è‰²å°çƒä»å·¦è¾¹é€¼è¿‘ $x_0 = 1$<br>
                        â€¢ ç»¿è‰²å°çƒä»å³è¾¹é€¼è¿‘ $x_0 = 1$<br>
                        â€¢ è§‚å¯Ÿå®ƒä»¬æœ€ç»ˆèƒ½åˆ°è¾¾çš„é«˜åº¦</p>
                        
                        <p><strong>ğŸ” å…³é”®æ¦‚å¿µï¼š</strong></p>
                        <p>â€¢ <strong>å·¦æé™</strong>ï¼šä»å·¦è¾¹é€¼è¿‘çš„æé™å€¼<br>
                        â€¢ <strong>å³æé™</strong>ï¼šä»å³è¾¹é€¼è¿‘çš„æé™å€¼<br>
                        â€¢ <strong>æé™å­˜åœ¨</strong>ï¼šå·¦æé™ $=$ å³æé™</p>
                    </div>
                </div>
                <div class="graph-container">
                    <div id="graph2" style="width: 100%; height: 450px;"></div>
                </div>
            </div>

            <!-- ç¬¬5é¡µï¼šå½©è™¹æ¡¥çš„å¥‡è¿¹ -->
            <div class="page" data-page="5">
                <div class="chalk-text">
                    <div class="page-title">ğŸŒˆ æ•…äº‹äºŒï¼šå½©è™¹æ¡¥çš„å¥‡è¿¹</div>
                    <div class="text-medium">
                        <p><strong>ğŸ©· ç²‰è‰²å°çƒçš„æ–°ä»»åŠ¡</strong></p>
                        <p>â€¢ ä»å·¦è¾¹å‡ºå‘ï¼Œç›®æ ‡ç‚¹ $x_0 = 0$<br>
                        â€¢ è¿™æ¬¡é‡åˆ°çš„æ˜¯ä¸€åº§å®Œæ•´çš„å½©è™¹æ¡¥<br>
                        â€¢ æ²¡æœ‰æ–­è£‚ï¼Œå¯ä»¥å®‰å…¨é€šè¿‡ï¼</p>
                        
                        <p><strong>ğŸ”µ è“è‰²å°çƒçš„æ–°ä»»åŠ¡</strong></p>
                        <p>â€¢ ä»å³è¾¹å‡ºå‘ï¼ŒåŒæ ·ç›®æ ‡ç‚¹ $x_0 = 0$<br>
                        â€¢ èµ°åœ¨åŒä¸€åº§ç¾ä¸½çš„å½©è™¹æ¡¥ä¸Š<br>
                        â€¢ è¿™æ¬¡ä¼šå‘ç”Ÿä»€ä¹ˆå¥‡è¿¹å‘¢ï¼Ÿ</p>
                        
                        <p class="emphasis">âœ¨ æœŸå¾…ï¼šå®ƒä»¬ä¼šåœ¨åŒä¸€é«˜åº¦ç›¸é‡å—ï¼Ÿ</p>
                    </div>
                </div>
                <div class="graph-container">
                    <div id="graph3" style="width: 100%; height: 450px;"></div>
                </div>
            </div>

            <!-- ç¬¬6é¡µï¼šå¥‡è¿¹ç›¸é‡ -->
            <div class="page" data-page="6">
                <div class="chalk-text">
                    <div class="page-title">ğŸ‰ å¥‡è¿¹ç›¸é‡ï¼šæé™å­˜åœ¨çš„ç¾å¦™æ—¶åˆ»</div>
                    <div class="text-medium">
                        <p><strong>ğŸŠ å¥‡è¿¹å‘ç”Ÿäº†ï¼</strong></p>
                        <p>â€¢ ç²‰è‰²å°çƒä»å·¦è¾¹åˆ°è¾¾é«˜åº¦ 0.5<br>
                        â€¢ è“è‰²å°çƒä»å³è¾¹ä¹Ÿåˆ°è¾¾é«˜åº¦ 0.5<br>
                        â€¢ å®ƒä»¬åœ¨åŒä¸€ä¸ªé«˜åº¦ç›¸é‡äº†ï¼</p>
                        
                        <p><strong>ğŸ“š æ•°å­¦ç»“è®ºï¼š</strong></p>
                        <p>â€¢ å½“å·¦æé™ $=$ å³æé™æ—¶ï¼Œæé™å­˜åœ¨<br>
                        â€¢ å½“å·¦æé™ $\neq$ å³æé™æ—¶ï¼Œæé™ä¸å­˜åœ¨</p>
                        
                        <p class="emphasis">ğŸ’¡ æ•°å­¦çš„ç¾å¦™ï¼šæœ‰æ—¶è·¯å¾„ä¸åŒï¼Œç»ˆç‚¹ç›¸åŒï¼</p>
                    </div>
                </div>
                <div class="graph-container">
                    <div id="graph4" style="width: 100%; height: 450px;"></div>
                </div>
            </div>

            <!-- ========== ç¨åä¼šæ·»åŠ ç¬¬7-9é¡µï¼šæ— ç©·æé™å†…å®¹ ========== -->

            <!-- ========== ç¬¬7-9é¡µï¼šæ— ç©·æé™å†…å®¹ï¼ˆæ¥è‡ªåŸæ–‡ä»¶é¡µé¢1-3ï¼‰========== -->

            <!-- ç¬¬7é¡µï¼šå›¢é˜Ÿåˆä½œçš„å¼€å§‹ -->
            <div class="page" data-page="7">
                <div class="chalk-text">
                    <div class="page-title">ğŸ‘¥ æ— ç©·æé™çš„å›¢é˜Ÿæ•…äº‹</div>
                    <div class="text-medium">
                        <p><strong>å…¬å¸çš„å‘å±•ç›®æ ‡</strong></p>
                        <p>ä¸œéƒ¨å’Œè¥¿éƒ¨ä¸¤ä¸ªå›¢é˜Ÿï¼Œä¸ç®¡å‘å±•å¤šä¹…ï¼Œæœ€ç»ˆéƒ½è¦è¾¾åˆ°åŒä¸€ä¸ªç›®æ ‡ï¼</p>
                        <p style="font-size: 20px; text-align: center; color: #81c784; margin: 1.5rem 0;">
                            $\displaystyle\lim_{x \to \infty} f(x) = A$
                        </p>
                        <p><strong>ğŸ“ˆ è§‚å¯Ÿè¦ç‚¹</strong></p>
                        <p>â€¢ ä¸¤ä¸ªå›¢é˜Ÿéƒ½æœç€ç›®æ ‡å€¼ 0 åŠªåŠ›<br>
                        â€¢ æ—¶é—´è¶Šé•¿ï¼Œè·ç¦»ç›®æ ‡è¶Šè¿‘<br>
                        â€¢ æœ€ç»ˆéƒ½èƒ½åˆ°è¾¾åŒä¸€ä¸ªç›®æ ‡</p>
                    </div>
                </div>
                <div class="graph-container">
                    <div id="graph7" style="width: 100%; height: 450px;"></div>
                </div>
            </div>

            <!-- ç¬¬8é¡µï¼šä¸¤ä¸ªå›¢é˜Ÿçš„åˆ†æ­§ -->
            <div class="page" data-page="8">
                <div class="chalk-text">
                    <div class="page-title">âš ï¸ ä¸¤ä¸ªå›¢é˜Ÿçš„åˆ†æ­§</div>
                    <div class="text-medium">
                        <p><strong>å…¬å¸çš„å›°å¢ƒ</strong></p>
                        <p>â€¢ ä¸œéƒ¨å›¢é˜ŸåŠªåŠ›å‘ä¸Šï¼Œç›®æ ‡æ˜¯å¤©èŠ±æ¿<br>
                        â€¢ è¥¿éƒ¨å›¢é˜ŸåŠªåŠ›å‘ä¸‹ï¼Œç›®æ ‡æ˜¯åœ°ä¸‹å®¤<br>
                        â€¢ è€æ¿å¤´ç–¼äº†ï¼šç›®æ ‡å®Œå…¨ç›¸åï¼</p>
                        <p style="font-size: 18px; text-align: center; color: #FF6B6B; margin: 1.5rem 0;">
                            $\displaystyle\lim_{x \to +\infty} \arctan(x) = \frac{\pi}{2}$
                        </p>
                        <p style="font-size: 18px; text-align: center; color: #4CAF50; margin: 1.5rem 0;">
                            $\displaystyle\lim_{x \to -\infty} \arctan(x) = -\frac{\pi}{2}$
                        </p>
                        <p class="emphasis">æé™ä¸å­˜åœ¨ï¼</p>
                    </div>
                </div>
                <div class="graph-container">
                    <div id="graph8" style="width: 100%; height: 450px;"></div>
                </div>
            </div>

            <!-- ç¬¬9é¡µï¼šæˆåŠŸçš„å›¢é˜Ÿåˆä½œä¸æ€»ç»“ -->
            <div class="page" data-page="9">
                <div class="chalk-text">
                    <div class="page-title">ğŸ† å›¢é˜ŸæˆåŠŸçš„æ³•åˆ™</div>
                    <div class="text-medium">
                        <p><strong>ç†æƒ³çš„å…¬å¸æ¡ˆä¾‹</strong></p>
                        <p>â€¢ ä¸œè¥¿éƒ¨å›¢é˜Ÿç›®æ ‡ä¸€è‡´<br>
                        â€¢ éƒ½æœç€æ€»éƒ¨å¤§å…ï¼ˆ0ï¼‰åŠªåŠ›<br>
                        â€¢ è€æ¿ç¬‘äº†ï¼šå®Œç¾åˆä½œï¼</p>
                        <p style="font-size: 18px; text-align: center; color: #81c784; margin: 1.5rem 0;">
                            $\displaystyle\lim_{x \to \infty} f(x) = A$ å­˜åœ¨
                        </p>
                        <p style="font-size: 16px; text-align: center; color: #f3e5f5; margin: 1rem 0;">
                            å½“ä¸”ä»…å½“ $\displaystyle\lim_{x \to +\infty} f(x) = \displaystyle\lim_{x \to -\infty} f(x) = A$
                        </p>
                    </div>
                </div>
                <div class="graph-container">
                    <div id="graph9" style="width: 100%; height: 450px;"></div>
                </div>
            </div>

            <!-- ========== ç¬¬7-9é¡µæ·»åŠ å®Œæˆ ========== -->

            <!-- ç¬¬10é¡µï¼šè¯¾æ—¶æ€»ç»“ -->
            <div class="page" data-page="10">
                <div class="intro-box">
                    <div class="course-title">ğŸ“ è¯¾æ—¶æ€»ç»“</div>
                    <div class="course-subtitle">æé™çš„å®šä¹‰ä¸å­˜åœ¨æ¡ä»¶</div>

                    <div class="content-list">
                        <div style="font-size: 22px; font-weight: bold; margin-bottom: 20px; text-align: center;">
                            ğŸ“ ä»Šå¤©æˆ‘ä»¬å­¦ä¹ äº†
                        </div>
                        <div class="content-item">æœ‰é™ç‚¹æé™ï¼šå·¦æé™ä¸å³æé™çš„æ¦‚å¿µ</div>
                        <div class="content-item">x â†’ xâ‚€ æ—¶æé™å­˜åœ¨çš„å……è¦æ¡ä»¶ï¼šå·¦æé™ = å³æé™</div>
                        <div class="content-item">æ— ç©·æé™ï¼šx â†’ +âˆ å’Œ x â†’ -âˆ çš„æƒ…å†µ</div>
                        <div class="content-item">x â†’ âˆ æ—¶æé™å­˜åœ¨çš„å……è¦æ¡ä»¶ï¼šlim(xâ†’+âˆ) = lim(xâ†’-âˆ)</div>
                        <div class="content-item">é€šè¿‡å°çƒæ¢é™©å’Œå›¢é˜Ÿåˆä½œæ•…äº‹ç†è§£æŠ½è±¡æ¦‚å¿µ</div>
                    </div>

                    <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 30px; margin: 30px 0;">
                        <div style="font-size: 20px; font-weight: bold; text-align: center; margin-bottom: 20px;">
                            ğŸ”‘ æ ¸å¿ƒè¦ç‚¹
                        </div>
                        <div style="font-size: 18px; margin: 15px 0;">
                            <strong>1. æœ‰é™ç‚¹æé™å­˜åœ¨ â‡” å·¦æé™ = å³æé™</strong>
                        </div>
                        <div style="font-size: 18px; margin: 15px 0;">
                            <strong>2. æ— ç©·æé™å­˜åœ¨ â‡” lim(xâ†’+âˆ) = lim(xâ†’-âˆ)</strong>
                        </div>
                        <div style="font-size: 18px; margin: 15px 0;">
                            <strong>3. åˆ¤æ–­æé™å­˜åœ¨æ€§çš„å…³é”®ï¼šæ£€æŸ¥ä¸¤ä¸ªæ–¹å‘çš„æé™å€¼æ˜¯å¦ç›¸ç­‰</strong>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 40px; font-size: 18px;">
                        ğŸ“– <strong>ä¸‹èŠ‚è¯¾é¢„å‘Š</strong>ï¼šæ— ç©·å°ä¸æ— ç©·å¤§<br>
                        <span style="font-size: 16px; opacity: 0.9;">æˆ‘ä»¬å°†å­¦ä¹ æ— ç©·å°é‡çš„å®šä¹‰ã€æ€§è´¨åŠå…¶è¿ç®—æ³•åˆ™</span>
                    </div>

                    <div style="text-align: center; margin-top: 30px; font-size: 20px;">
                        ğŸ’– æ„Ÿè°¢å¤§å®¶çš„å­¦ä¹ ï¼å†è§ï¼
                    </div>
                </div>
            </div>

        </div>

        <!-- å­—å¹•æ˜¾ç¤ºåŒºåŸŸ -->
        <div class="subtitle-area" id="subtitleArea">
            ğŸ¯ æ¬¢è¿å­¦ä¹ æé™çš„å®šä¹‰ä¸å­˜åœ¨æ¡ä»¶ï¼
        </div>

        <div class="control-bar">
            <div style="color: white; margin-bottom: 1rem; text-align: center; font-size: 12px;">
                ç¬¬ <span id="currentPage">1</span> é¡µ / å…± <span id="totalPages">10</span> é¡µ
            </div>
            <button class="btn" onclick="previousPage()">â¬…ï¸ ä¸Šä¸€é¡µ</button>
            <button class="btn primary" onclick="startTeaching()" id="startBtn">ğŸ€ å¼€å§‹è®²è¯¾</button>
            <button class="btn" onclick="nextPage()">ä¸‹ä¸€é¡µ â¡ï¸</button>
            <button class="btn" onclick="restart()">ğŸ”„ é‡æ–°å¼€å§‹</button>
            <button class="btn" onclick="startAutoPlay()" id="autoPlayBtn" style="background: linear-gradient(135deg, #2196f3, #1976d2);">ğŸ¬ è‡ªåŠ¨æ’­æ”¾</button>
        </div>
    </div>

    <!-- SDKåŠ è½½è„šæœ¬ -->
    <script type="module">
        // æ’­æ”¾å®Œæˆæ ‡è®°ï¼ˆä¾›OBSæ£€æµ‹ï¼‰
        window.playbackFinished = false;

        try {
            const { default: AvatarPlatform, SDKEvents, PlayerEvents, RecorderEvents, UserMedia } = await import('./avatar-sdk-web_3.1.2.1002/index.js');
            window.AvatarPlatform = AvatarPlatform;
            window.SDKEvents = SDKEvents;
            window.PlayerEvents = PlayerEvents;
            window.RecorderEvents = RecorderEvents;
            window.UserMedia = UserMedia;
            console.log('âœ… è®¯é£å®˜æ–¹SDKæ¨¡å—å·²åŠ è½½');
        } catch (error) {
            console.error('âŒ SDKæ¨¡å—åŠ è½½å¤±è´¥:', error);
        }
        window.dispatchEvent(new CustomEvent('sdkReady'));
    </script>

    <!-- MathJaxé…ç½® -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            startup: {
                pageReady: () => {
                    console.log('âœ… MathJax å·²å®Œå…¨åŠ è½½');
                    window.mathJaxReady = true;
                    window.dispatchEvent(new CustomEvent('mathjaxReady'));
                    return MathJax.startup.defaultPageReady();
                }
            }
        };
    </script>
    <script src="./polyfill.min.js"></script>
    <script src="./mathjax-tex-mml-chtml.js"></script>
    <script src="./plotly-2.35.2.min.js"></script>
    <script src="./d3.v7.min.js"></script>

    <script>
        // å…¨å±€å˜é‡
        let avatarPlatform = null;
        let isConnected = false;
        let isTeaching = false;
        let currentPage = 1;
        const totalPages = 10; // 1å¯¼è¯­ + 5æœ‰é™ç‚¹ + 3æ— ç©· + 1æ€»ç»“

        // æ•™å­¦å†…å®¹
        const pageContent = {
            1: "åŒå­¦ä»¬å¥½ï¼æ¬¢è¿æ¥åˆ°ç¬¬äºŒç« ç¬¬ä¸€èŠ‚çš„å­¦ä¹ ã€‚ä»Šå¤©æˆ‘ä»¬è¦å­¦ä¹ æé™çš„å®šä¹‰ã€æ€§è´¨ä¸å­˜åœ¨æ¡ä»¶ã€‚è¿™æ˜¯å¾®ç§¯åˆ†æœ€æ ¸å¿ƒçš„åŸºç¡€æ¦‚å¿µã€‚æˆ‘ä»¬å°†é€šè¿‡ç”ŸåŠ¨çš„å°çƒæ¢é™©æ•…äº‹ï¼Œæ¥ç†è§£å·¦æé™ã€å³æé™ã€ä»¥åŠæé™å­˜åœ¨çš„å……è¦æ¡ä»¶ã€‚è¿˜ä¼šå­¦ä¹ å½“xè¶‹å‘æ— ç©·æ—¶çš„æé™æƒ…å†µã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹è¿™è¶Ÿå¥‡å¦™çš„æ•°å­¦ä¹‹æ—…ï¼",
            2: "åŒå­¦ä»¬å¥½ï¼ä»Šå¤©æˆ‘ä»¬è¦é€šè¿‡ä¸€ä¸ªæœ‰è¶£çš„æ•…äº‹æ¥å­¦ä¹ å‡½æ•°æé™ã€‚æƒ³è±¡æœ‰ä¸¤ä¸ªå‹‡æ•¢çš„å°çƒï¼Œå®ƒä»¬æƒ³è¦åˆ°è¾¾ä¸€ä¸ªç¥ç§˜çš„ç›®æ ‡ç‚¹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆå¥‡å¦™çš„äº‹æƒ…ï¼å³è¾¹çš„å›¾å±•ç¤ºäº†æˆ‘ä»¬æ•…äº‹çš„èˆå°ã€‚",
            3: "ç°åœ¨å¼€å§‹æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ•…äº‹ï¼šæ–­æ¡¥ä¸Šçš„å°çƒå†’é™©ã€‚çœ‹ï¼è¿™é‡Œæœ‰ä¸€åº§ç¥å¥‡çš„æ–­æ¡¥ã€‚çº¢è‰²å°çƒä»å·¦è¾¹å‡ºå‘ï¼Œç»¿è‰²å°çƒä»å³è¾¹å‡ºå‘ï¼Œå®ƒä»¬éƒ½æƒ³åˆ°è¾¾ä¸­é—´çš„ç›®æ ‡ç‚¹ xç­‰äº1ã€‚ä½†æ˜¯æ¡¥æ–­äº†ï¼è®©æˆ‘ä»¬çœ‹çœ‹å³è¾¹çš„å›¾ï¼Œè§‚å¯Ÿè¿™åº§æ–­æ¡¥çš„æ ·å­ã€‚",
            4: "ç°åœ¨è®©æˆ‘ä»¬è§‚å¯ŸåŠ¨æ€æ¼”ç¤ºã€‚çº¢è‰²å°çƒä»å·¦è¾¹æ²¿ç€å‡½æ•°æ›²çº¿å‰è¿›ï¼Œç»¿è‰²å°çƒä»å³è¾¹å‰è¿›ã€‚æ³¨æ„è§‚å¯Ÿï¼šçº¢è‰²å°çƒä»å·¦è¾¹åªèƒ½åˆ°è¾¾é«˜åº¦2ï¼Œè€Œç»¿è‰²å°çƒä»å³è¾¹åªèƒ½åˆ°è¾¾é«˜åº¦2.5ã€‚å®ƒä»¬åˆ°è¾¾äº†ä¸åŒçš„åœ°æ–¹ï¼è¿™å°±æ˜¯æˆ‘ä»¬è¯´çš„å·¦æé™ä¸ç­‰äºå³æé™ï¼Œæ‰€ä»¥æé™ä¸å­˜åœ¨ã€‚",
            5: "ç°åœ¨è®©æˆ‘ä»¬çœ‹ç¬¬äºŒä¸ªæ•…äº‹ï¼šå½©è™¹æ¡¥çš„å¥‡è¿¹ã€‚è¿™æ¬¡æœ‰ä¸€åº§å®Œæ•´çš„å½©è™¹æ¡¥ï¼ç²‰è‰²å°çƒä»å·¦è¾¹å‡ºå‘ï¼Œè“è‰²å°çƒä»å³è¾¹å‡ºå‘ï¼Œç›®æ ‡ç‚¹æ˜¯ xç­‰äº0ã€‚è¿™æ¬¡ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬è§‚å¯Ÿå³è¾¹è¿™åº§ç¾ä¸½çš„å½©è™¹æ¡¥ã€‚",
            6: "å“‡ï¼å¥‡è¿¹å‘ç”Ÿäº†ï¼ä¸¤ä¸ªå°çƒåœ¨åŒä¸€ä¸ªé«˜åº¦0.5ç›¸é‡äº†ï¼ç²‰è‰²å°çƒä»å·¦è¾¹åˆ°è¾¾é«˜åº¦0.5ï¼Œè“è‰²å°çƒä»å³è¾¹ä¹Ÿåˆ°è¾¾é«˜åº¦0.5ã€‚è¿™æ¬¡å·¦æé™ç­‰äºå³æé™ï¼Œæ‰€ä»¥æé™å­˜åœ¨ã€‚è¿™å°±æ˜¯å‡½æ•°æé™çš„å¥¥ç§˜ï¼šæœ‰æ—¶è·¯å¾„ä¸åŒç»ˆç‚¹ç›¸åŒï¼Œæœ‰æ—¶è·¯å¾„ç›¸åŒç»ˆç‚¹ä¸åŒï¼",
            7: "åŒå­¦ä»¬å¥½ï¼ä»Šå¤©æˆ‘ä»¬ç”¨å›¢é˜Ÿåˆä½œçš„æ•…äº‹ï¼Œæ¥ç†è§£æ— ç©·æé™çš„æ¦‚å¿µã€‚è¯·çœ‹å±å¹•ä¸Šçš„åŠ¨ç”»ã€‚æƒ³è±¡ä¸€å®¶å…¬å¸ï¼Œæœ‰ä¸œéƒ¨å’Œè¥¿éƒ¨ä¸¤ä¸ªå›¢é˜Ÿã€‚è€æ¿å¯¹ä»–ä»¬è¯´ï¼šä¸ç®¡å‘å±•å¤šä¹…ï¼Œä¸¤ä¸ªå›¢é˜Ÿæœ€ç»ˆéƒ½è¦è¾¾åˆ°åŒä¸€ä¸ªç›®æ ‡ï¼è¿™å°±æ˜¯æ— ç©·æé™çš„æ ¸å¿ƒæ€æƒ³ã€‚è§‚å¯Ÿå›¾ä¸­çš„è“è‰²å°äººå’Œç»¿è‰²å°äººï¼Œä»–ä»¬æ²¿ç€ä¸åŒçš„è·¯å¾„å‰è¿›ï¼Œä½†æœ€ç»ˆéƒ½è¶‹å‘åŒä¸€ä¸ªç›®æ ‡ç‚¹ã€‚éšç€æ—¶é—´æ¨ç§»ï¼Œå›¢é˜Ÿçš„åŠªåŠ›ä¼šè¶Šæ¥è¶Šæ¥è¿‘æŸä¸ªç›®æ ‡å€¼ã€‚è¿™ä¸ªæœ€ç»ˆç›®æ ‡ï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æé™å€¼ï¼",
            8: "ç°åœ¨æˆ‘ä»¬çœ‹ç¬¬äºŒä¸ªä¾‹å­ï¼Œä¸€ä¸ªæœ‰é—®é¢˜çš„å…¬å¸ã€‚è¯·æ³¨æ„è§‚å¯Ÿä¸¤ä¸ªå°äººçš„ç§»åŠ¨æ–¹å‘ã€‚ä¸œéƒ¨å›¢é˜Ÿçš„è“è‰²å°äººå‘å³ç§»åŠ¨ï¼Œä»–ä»¬çš„ç›®æ ‡æ˜¯å¤©èŠ±æ¿ï¼Œä¹Ÿå°±æ˜¯æ­£çš„äºŒåˆ†ä¹‹æ´¾ã€‚è¥¿éƒ¨å›¢é˜Ÿçš„ç»¿è‰²å°äººå‘å·¦ç§»åŠ¨ï¼Œä»–ä»¬çš„ç›®æ ‡æ˜¯åœ°ä¸‹å®¤ï¼Œä¹Ÿå°±æ˜¯è´Ÿçš„äºŒåˆ†ä¹‹æ´¾ã€‚è€æ¿å¾ˆå¤´ç–¼ï¼šä¸¤ä¸ªå›¢é˜Ÿçš„ç›®æ ‡å®Œå…¨ç›¸åï¼è¿™å°±åƒåæ­£åˆ‡å‡½æ•°çš„æ€§è´¨ã€‚å½“xè¶‹å‘æ­£æ— ç©·æ—¶ï¼Œå‡½æ•°å€¼è¶‹å‘æ­£çš„äºŒåˆ†ä¹‹æ´¾ã€‚å½“xè¶‹å‘è´Ÿæ— ç©·æ—¶ï¼Œå‡½æ•°å€¼è¶‹å‘è´Ÿçš„äºŒåˆ†ä¹‹æ´¾ã€‚å› ä¸ºä¸¤ä¸ªæ–¹å‘çš„æé™å€¼ä¸ç›¸ç­‰ï¼Œæ‰€ä»¥æ— ç©·æé™ä¸å­˜åœ¨ï¼",
            9: "æœ€åæˆ‘ä»¬çœ‹ä¸€ä¸ªæˆåŠŸçš„å…¬å¸æ¡ˆä¾‹ã€‚è§‚å¯ŸåŠ¨ç”»ä¸­çš„ä¸¤ä¸ªå°äººï¼Œä»–ä»¬ä»ä¸­å¿ƒç‚¹å‡ºå‘ï¼Œåˆ†åˆ«å‘å·¦å³ä¸¤ä¸ªæ–¹å‘ç§»åŠ¨ã€‚ä¸œéƒ¨å›¢é˜Ÿè¯´ï¼šæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ€»éƒ¨å¤§å…ï¼è¥¿éƒ¨å›¢é˜Ÿä¹Ÿè¯´ï¼šæˆ‘ä»¬çš„ç›®æ ‡ä¹Ÿæ˜¯æ€»éƒ¨å¤§å…ï¼è€æ¿ç¬‘äº†ï¼šä¸¤ä¸ªå›¢é˜Ÿç›®æ ‡å®Œå…¨ä¸€è‡´ï¼è¿™å°±æ˜¯å›¢é˜Ÿåˆä½œçš„é»„é‡‘æ³•åˆ™ã€‚åœ¨æ•°å­¦ä¸Šï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸€é™¤ä»¥ä¸€åŠ xçš„å¹³æ–¹ã€‚æ— è®ºxè¶‹å‘æ­£æ— ç©·è¿˜æ˜¯è´Ÿæ— ç©·ï¼Œå‡½æ•°å€¼éƒ½è¶‹å‘äºé›¶ã€‚è¿™å°±æ˜¯æ— ç©·æé™å­˜åœ¨çš„æ¡ä»¶ï¼šå½“ä¸”ä»…å½“å·¦æé™ç­‰äºå³æé™ï¼è®°ä½è¿™ä¸ªåˆ¤æ–­æ–¹æ³•ï¼šçœ‹ä¸¤ä¸ªæ–¹å‘çš„æœ€ç»ˆç›®æ ‡ï¼Œç›¸åŒå°±æœ‰ç»Ÿä¸€çš„æé™ï¼Œä¸åŒå°±æé™ä¸å­˜åœ¨ï¼",
            10: "åŒå­¦ä»¬ï¼ä»Šå¤©æˆ‘ä»¬å­¦ä¹ äº†æé™çš„å®šä¹‰ä¸å­˜åœ¨æ¡ä»¶ã€‚æˆ‘ä»¬çŸ¥é“äº†ï¼Œå½“xè¶‹å‘æŸä¸€ç‚¹x0æ—¶ï¼Œå·¦æé™ç­‰äºå³æé™ï¼Œæé™æ‰å­˜åœ¨ã€‚å½“xè¶‹å‘æ— ç©·æ—¶ï¼Œæ­£æ— ç©·æé™ç­‰äºè´Ÿæ— ç©·æé™ï¼Œæé™æ‰å­˜åœ¨ã€‚è¿™äº›æ¦‚å¿µæ˜¯å¾®ç§¯åˆ†çš„åŸºç¡€ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤Ÿæ·±å…¥ç†è§£ã€‚ä¸‹èŠ‚è¯¾æˆ‘ä»¬å°†å­¦ä¹ æ— ç©·å°ä¸æ— ç©·å¤§ã€‚ä»Šå¤©çš„è¯¾å°±åˆ°è¿™é‡Œï¼Œè°¢è°¢å¤§å®¶ï¼"
        };

        // é¡µé¢åˆ‡æ¢å‡½æ•°
        function switchToPage(pageNum) {
            if (pageNum < 1 || pageNum > totalPages) return;
            currentPage = pageNum;
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            const targetPage = document.querySelector(`[data-page="${pageNum}"]`);
            if (targetPage) {
                targetPage.classList.add('active');
                // æ¸²æŸ“MathJaxå…¬å¼ - ç­‰å¾…MathJaxåŠ è½½å®Œæˆ
                renderMathJax(targetPage, pageNum);
                // ç»˜åˆ¶å›¾å½¢
                setTimeout(() => {
                    drawPageGraph(pageNum);
                }, 300);
            }
            updatePageInfo();
        }

        // MathJaxæ¸²æŸ“å‡½æ•°
        function renderMathJax(targetPage, pageNum) {
            const tryRender = () => {
                if (window.MathJax && window.MathJax.typesetPromise) {
                    window.MathJax.typesetPromise([targetPage]).then(() => {
                        console.log(`âœ… ç¬¬${pageNum}é¡µMathJaxæ¸²æŸ“å®Œæˆ`);
                    }).catch((err) => {
                        console.error('MathJaxæ¸²æŸ“é”™è¯¯:', err);
                    });
                } else if (window.MathJax && window.MathJax.typeset) {
                    window.MathJax.typeset([targetPage]);
                    console.log(`âœ… ç¬¬${pageNum}é¡µMathJaxæ¸²æŸ“å®Œæˆ`);
                } else {
                    console.warn('MathJaxæœªåŠ è½½ï¼Œç­‰å¾…ä¸­...');
                }
            };

            if (window.mathJaxReady) {
                setTimeout(tryRender, 100);
            } else {
                window.addEventListener('mathjaxReady', () => {
                    setTimeout(tryRender, 100);
                }, { once: true });
            }
        }

        function previousPage() {
            if (currentPage > 1) switchToPage(currentPage - 1);
        }

        function nextPage() {
            if (currentPage < totalPages) switchToPage(currentPage + 1);
        }

        function restart() {
            switchToPage(1);
        }

        function updatePageInfo() {
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('totalPages').textContent = totalPages;
        }

        function updateStatus(message, type = 'normal') {
            const indicator = document.getElementById('statusIndicator');
            if (indicator) {
                indicator.textContent = message;
                indicator.className = 'status-indicator';
                if (type) indicator.classList.add(type);
            }
        }

        // ç­‰å¾…SDK
        function waitForSDK() {
            return new Promise((resolve, reject) => {
                if (typeof AvatarPlatform !== 'undefined') {
                    resolve();
                    return;
                }
                const timeout = setTimeout(() => {
                    reject(new Error('SDKåŠ è½½è¶…æ—¶'));
                }, 10000);
                window.addEventListener('sdkReady', function handler() {
                    clearTimeout(timeout);
                    window.removeEventListener('sdkReady', handler);
                    resolve();
                });
            });
        }

        // å¼€å§‹æ•™å­¦
        async function startTeaching() {
            const startBtn = document.getElementById('startBtn');
            startBtn.textContent = 'ğŸ”„ å¯åŠ¨ä¸­...';
            startBtn.disabled = true;

            try {
                await waitForSDK();
                console.log('âœ… SDKå·²åŠ è½½');

                if(avatarPlatform) {
                    avatarPlatform.destroy();
                }

                avatarPlatform = new AvatarPlatform({ useInlinePlayer: true });

                avatarPlatform
                    .on('connected', (initResp) => {
                        console.log('ğŸ‰ è™šæ‹Ÿäººè¿æ¥æˆåŠŸï¼');
                        isConnected = true;
                        isTeaching = true;
                        updateStatus('å·²è¿æ¥', 'connected');
                        startBtn.textContent = 'ğŸ’– è™šæ‹Ÿäººå·²å°±ç»ª';
                        setTimeout(() => speakContent(1), 1000);
                    })
                    .on('disconnected', () => {
                        console.log('ğŸ”Œ è™šæ‹Ÿäººè¿æ¥æ–­å¼€');
                        isConnected = false;
                        updateStatus('è¿æ¥æ–­å¼€', 'error');
                    })
                    .on('error', (error) => {
                        console.error('âŒ é”™è¯¯:', error);
                        updateStatus('é”™è¯¯: ' + error.message, 'error');
                        startBtn.textContent = 'âŒ è¿æ¥å¤±è´¥';
                        startBtn.disabled = false;
                    })
                    .on('frame_stop', (data) => {
                        console.log('âœ… è™šæ‹Ÿäººè®²è§£å®Œæˆ frame_stop:', data);
                        // è™šæ‹Ÿäººè®²å®Œä¸€å¸§ï¼ˆä¸€æ®µè¯ï¼‰ï¼Œåœ¨è‡ªåŠ¨æ’­æ”¾æ¨¡å¼ä¸‹è§¦å‘ç¿»é¡µ
                        if (isAutoPlaying && currentPage < totalPages) {
                            console.log(`ğŸ¬ è‡ªåŠ¨æ’­æ”¾: ç¬¬${currentPage}é¡µè®²è§£å®Œæˆï¼Œå‡†å¤‡ç¿»é¡µåˆ°ç¬¬${currentPage + 1}é¡µ`);
                            setTimeout(() => {
                                if (isAutoPlaying && currentPage < totalPages) {
                                    currentPage++;
                                    switchToPageSilent(currentPage);
                                    updateStatus(`ğŸ“– ç¬¬${currentPage}é¡µ/${totalPages}é¡µ - ${getPageTitle(currentPage)}`, 'recording');
                                    // çŸ­æš‚åœé¡¿åå¼€å§‹ä¸‹ä¸€é¡µè®²è§£
                                    setTimeout(() => {
                                        if (isAutoPlaying) {
                                            speakContent(currentPage);
                                        }
                                    }, 800);
                                }
                            }, 1500); // ç¿»é¡µå‰çŸ­æš‚åœé¡¿1.5ç§’
                        }
                    });

                avatarPlatform.setApiInfo({
                    appId: 'f34b6995',
                    apiKey: '11bce7d2c44157a6875476f368ceb2a0',
                    apiSecret: 'NjIzNjk2ZWQ0ZGNjMGE0ODkzYjhmNzQy',
                    sceneId: '233767656807862272',
                    serverUrl: 'wss://avatar.cn-huadong-1.xf-yun.com/v1/interact'
                });

                avatarPlatform.setGlobalParams({
                    stream: { protocol: 'xrtc', alpha: 1, bitrate: 1000000, fps: 25 },
                    avatar: { avatar_id: '110332017', width: 1920, height: 1080, scale: 1 },
                    tts: { vcn: 'x4_yiting', speed: 50, pitch: 50, volume: 100 },
                    avatar_dispatch: { interactive_mode: 1, content_analysis: 0 }
                });

                await avatarPlatform.start({wrapper: document.getElementById('avatarWrapper')});
                console.log('âœ… è™šæ‹Ÿäººå¯åŠ¨æˆåŠŸ');

            } catch (error) {
                console.error('âŒ å¯åŠ¨å¤±è´¥:', error);
                updateStatus('å¯åŠ¨å¤±è´¥', 'error');
                startBtn.textContent = 'âŒ å¯åŠ¨å¤±è´¥';
                startBtn.disabled = false;
            }
        }

        // è®²è§£å†…å®¹
        async function speakContent(pageNum) {
            if (!isConnected || !avatarPlatform) {
                console.log('æœªè¿æ¥è™šæ‹Ÿäºº');
                return;
            }

            const content = pageContent[pageNum];
            if (!content) {
                console.log(`ç¬¬${pageNum}é¡µæ— è®²ç¨¿`);
                return;
            }

            try {
                console.log(`ğŸ¤ è®²è§£ç¬¬${pageNum}é¡µ`);
                updateStatus(`è®²è§£ç¬¬${pageNum}é¡µ`, 'recording');
                await avatarPlatform.writeText(content, { nlp: false });
                console.log(`âœ… ç¬¬${pageNum}é¡µè®²è§£å®Œæˆ`);
            } catch (error) {
                console.error(`è®²è§£å¤±è´¥:`, error);
            }
        }

        // è‡ªåŠ¨æ’­æ”¾ç›¸å…³å‡½æ•°
        function switchToPageSilent(pageNum) {
            if (pageNum < 1 || pageNum > totalPages) {
                console.log(`âŒ é¡µé¢åˆ‡æ¢å¤±è´¥ï¼šé¡µç ${pageNum}è¶…å‡ºèŒƒå›´(1-${totalPages})`);
                return;
            }

            console.log(`ğŸ”„ å¼€å§‹åˆ‡æ¢åˆ°ç¬¬${pageNum}é¡µ...`);

            // ç§»é™¤æ‰€æœ‰é¡µé¢çš„activeç±»
            const allPages = document.querySelectorAll('.page');
            console.log(`ğŸ“„ æ‰¾åˆ°${allPages.length}ä¸ªé¡µé¢å…ƒç´ `);

            allPages.forEach((p, index) => {
                p.classList.remove('active');
            });

            // æ·»åŠ activeç±»åˆ°ç›®æ ‡é¡µé¢
            const targetPage = document.querySelector(`[data-page="${pageNum}"]`);
            if (targetPage) {
                targetPage.classList.add('active');
                console.log(`âœ… ç¬¬${pageNum}é¡µå·²æ¿€æ´»`);

                // æ¸²æŸ“MathJaxå…¬å¼
                renderMathJax(targetPage, pageNum);

                // å»¶è¿Ÿç»˜åˆ¶å›¾å½¢
                setTimeout(() => {
                    drawPageGraph(pageNum);
                }, 300);
            } else {
                console.error(`âŒ æœªæ‰¾åˆ°é¡µé¢${pageNum}`);
            }

            currentPage = pageNum;
            updatePageInfo();
        }

        function getPageTitle(pageNum) {
            const titles = {
                1: "æé™çš„å®šä¹‰ä¸å­˜åœ¨æ¡ä»¶",
                2: "æ–­æ¡¥è¿·æ€",
                3: "æ–­æ¡¥è§†é¢‘æ¼”ç¤º",
                4: "æ–­æ¡¥çš„åŠ¨ç”»æ¼”ç¤º",
                5: "å½©è™¹æ¡¥çš„æ•…äº‹",
                6: "å¥‡è¿¹å‘ç”Ÿäº†",
                7: "å›¢é˜Ÿåä½œç›®æ ‡",
                8: "ç›®æ ‡ä¸åŒçš„å›°å¢ƒ",
                9: "ç›®æ ‡ç»Ÿä¸€çš„å¥‡è¿¹",
                10: "æé™å­˜åœ¨çš„æ ¸å¿ƒæ¡ä»¶"
            };
            return titles[pageNum] || `ç¬¬${pageNum}é¡µ`;
        }

        function getPageDuration(pageNum) {
            const durations = {
                1: 25000, 2: 18000, 3: 20000, 4: 18000, 5: 20000,
                6: 17000, 7: 19000, 8: 21000, 9: 20000, 10: 18000
            };
            return durations[pageNum] || 15000;
        }

        let isAutoPlaying = false;
        async function startAutoPlay() {
            if (isAutoPlaying) {
                stopAutoPlay();
                return;
            }

            try {
                console.log('ğŸ¬ å¼€å§‹è‡ªåŠ¨æ’­æ”¾å®Œæ•´è¯¾ç¨‹...');
                isAutoPlaying = true;

                const autoPlayBtn = document.getElementById('autoPlayBtn');
                autoPlayBtn.textContent = 'â¹ï¸ åœæ­¢æ’­æ”¾';
                autoPlayBtn.style.background = 'linear-gradient(135deg, #f44336, #d32f2f)';

                updateStatus(`ğŸ¬ è‡ªåŠ¨æ’­æ”¾å°†åœ¨ 2 ç§’åå¼€å§‹ï¼Œè¯·å‡†å¤‡å½•å±ï¼`, 'recording');
                await new Promise(resolve => setTimeout(resolve, 2000));

                updateStatus('ğŸ¬ è‡ªåŠ¨æ’­æ”¾å¼€å§‹ï¼', 'recording');
                document.body.classList.add('recording-mode');
                console.log('ğŸ“¹ è¿›å…¥å½•åˆ¶æ¨¡å¼ï¼Œéšè—UIå…ƒç´ ');

                // ç¡®ä¿è™šæ‹Ÿäººå·²è¿æ¥
                if (!avatarPlatform || !isConnected) {
                    console.log('ğŸ¬ å¯åŠ¨è™šæ‹Ÿäºº...');
                    await startTeaching();
                    // ç­‰å¾…è¿æ¥å®Œæˆ
                    await new Promise(resolve => setTimeout(resolve, 2000));
                }

                // ä»ç¬¬ä¸€é¡µå¼€å§‹
                currentPage = 1;
                switchToPageSilent(1);
                updateStatus(`ğŸ“– ç¬¬1é¡µ/${totalPages}é¡µ - ${getPageTitle(1)}`, 'recording');

                // ç­‰å¾…é¡µé¢æ¸²æŸ“åå¼€å§‹ç¬¬ä¸€é¡µè®²è§£,åç»­ç¿»é¡µç”±frame_stopäº‹ä»¶é©±åŠ¨
                await new Promise(resolve => setTimeout(resolve, 800));
                if (isConnected && isTeaching) {
                    speakContent(1);
                    console.log('ğŸ¬ è‡ªåŠ¨æ’­æ”¾å·²å¯åŠ¨ï¼Œç¿»é¡µç”±è™šæ‹Ÿäººè¯­éŸ³å®Œæˆäº‹ä»¶(frame_stop)é©±åŠ¨');
                } else {
                    console.error('âŒ è™šæ‹Ÿäººæœªè¿æ¥ï¼Œè‡ªåŠ¨æ’­æ”¾å¤±è´¥');
                    stopAutoPlay();
                }

            } catch (error) {
                console.error('âŒ è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', error);
                updateStatus('è‡ªåŠ¨æ’­æ”¾å¤±è´¥: ' + error.message, 'error');
                stopAutoPlay();
            }
        }

        function stopAutoPlay() {
            if (isAutoPlaying) {
                isAutoPlaying = false;
                window.playbackFinished = true;
                document.title = "PLAYBACK_FINISHED";
                console.log('ğŸ‰ æ’­æ”¾å®Œæˆï¼å·²ä¿®æ”¹æ ‡é¢˜ä¸º PLAYBACK_FINISHED');

                document.body.classList.remove('recording-mode');
                console.log('ğŸ“¹ é€€å‡ºå½•åˆ¶æ¨¡å¼ï¼Œæ¢å¤UIå…ƒç´ ');

                const autoPlayBtn = document.getElementById('autoPlayBtn');
                autoPlayBtn.textContent = 'ğŸ¬ è‡ªåŠ¨æ’­æ”¾';
                autoPlayBtn.style.background = 'linear-gradient(135deg, #2196f3, #1976d2)';

                console.log('â¹ï¸ è‡ªåŠ¨æ’­æ”¾å·²åœæ­¢');
                updateStatus('è‡ªåŠ¨æ’­æ”¾å·²åœæ­¢', 'normal');
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updatePageInfo();
            console.log('âœ¨ ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');

            // æ¸²æŸ“ç¬¬1é¡µçš„MathJaxå…¬å¼ - ä½¿ç”¨æ”¹è¿›çš„æ¸²æŸ“å‡½æ•°
            const firstPage = document.querySelector('[data-page="1"]');
            if (firstPage) {
                renderMathJax(firstPage, 1);
            }

            // å»¶è¿Ÿç»˜åˆ¶å›¾å½¢ï¼Œç¡®ä¿Plotlyå·²åŠ è½½
            setTimeout(() => {
                drawPageGraph(1);
            }, 1000);

            // ğŸš€ è‡ªåŠ¨å¯åŠ¨æ’­æ”¾ - å»¶è¿Ÿ3ç§’åè‡ªåŠ¨å¼€å§‹
            setTimeout(() => {
                console.log('ğŸš€ è‡ªåŠ¨å¯åŠ¨æ’­æ”¾...');
                startAutoPlay();
            }, 3000);
        });

        // ç»˜å›¾å‡½æ•° - ä½¿ç”¨Plotly.js
        function drawPageGraph(pageNum) {
            console.log(`ğŸ¨ ç»˜åˆ¶ç¬¬${pageNum}é¡µå›¾å½¢`);

            if (typeof Plotly === 'undefined') {
                console.error('âŒ PlotlyæœªåŠ è½½');
                return;
            }

            switch(pageNum) {
                case 1: break; // å¯¼è¯­é¡µæ— å›¾
                case 2: break; // ç¬¬2é¡µæœ‰è§†é¢‘ï¼Œæ— éœ€ç»˜åˆ¶
                case 3: drawBrokenBridgeGraphPlotly(); break;
                case 4: drawAnimatedBrokenBridgePlotly(); break;
                case 5: drawRainbowBridgeGraphPlotly(); break;
                case 6: drawMiracleGraphPlotly(); break;
                case 7: drawTeamGoalD3(); break;  // D3.js: å›¢é˜Ÿç›®æ ‡
                case 8: drawDifferentGoalsD3(); break;  // D3.js: ä¸åŒç›®æ ‡
                case 9: drawUnifiedGoalD3(); break;  // D3.js: ç»Ÿä¸€ç›®æ ‡
                case 10: break; // æ€»ç»“é¡µæ— å›¾
                default: break;
            }
        }

        // ========== D3.jsè¾…åŠ©å‡½æ•°ï¼ˆç”¨äºç¬¬7-9é¡µï¼‰==========

        // åˆ›å»ºSVGå›¾æ ‡çš„è¾…åŠ©å‡½æ•° - ä½¿ç”¨å†…åµŒSVG
        function createPersonIcon(g, x, y, color, direction = 'right') {
            const iconGroup = g.append('g')
                .attr('transform', `translate(${x}, ${y})`)
                .style('opacity', 0);

            // äººç‰©SVG - å¯ä»¥æ°´å¹³ç¿»è½¬
            const personSvg = iconGroup.append('svg')
                .attr('width', 20)
                .attr('height', 20)
                .attr('x', -10)
                .attr('y', -10)
                .attr('viewBox', '0 0 16 16')
                .attr('fill', color)
                .style('transform', direction === 'left' ? 'scaleX(-1)' : 'scaleX(1)');

            // è¡Œèµ°çš„äººçš„è·¯å¾„
            personSvg.append('path')
                .attr('d', 'M9.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM6.44 3.752A.75.75 0 0 1 7 3.5h1.445c.742 0 1.32.643 1.243 1.38l-.43 4.083a1.8 1.8 0 0 1-.088.395l-.318.906.213.242a.8.8 0 0 1 .114.175l2 4.25a.75.75 0 1 1-1.357.638l-1.956-4.154-1.68-1.921A.75.75 0 0 1 6 8.96l.138-2.613-.435.489-.464 2.786a.75.75 0 1 1-1.48-.246l.5-3a.75.75 0 0 1 .18-.375l2-2.25Z');

            // æ–¹å‘ç®­å¤´
            const arrowSvg = iconGroup.append('svg')
                .attr('width', 16)
                .attr('height', 16)
                .attr('x', direction === 'right' ? 15 : -25)
                .attr('y', -8)
                .attr('viewBox', '0 0 16 16')
                .attr('fill', '#FF9800');

            if (direction === 'right') {
                arrowSvg.append('path')
                    .attr('d', 'M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z');
            } else {
                arrowSvg.append('path')
                    .attr('d', 'M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z');
            }

            return iconGroup;
        }

        // åˆ›å»ºå¥–æ¯å›¾æ ‡
        function createTrophyIcon(g, x, y, color) {
            const iconGroup = g.append('g')
                .attr('transform', `translate(${x}, ${y})`)
                .style('opacity', 0);

            const trophySvg = iconGroup.append('svg')
                .attr('width', 24)
                .attr('height', 24)
                .attr('x', -12)
                .attr('y', -12)
                .attr('viewBox', '0 0 16 16')
                .attr('fill', color);

            trophySvg.append('path')
                .attr('d', 'M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5c0 .538-.012 1.05-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33.076 33.076 0 0 1 2.5.5zm.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935zm10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935z');

            return iconGroup;
        }

        // ========== Plotly.jsç»˜å›¾å‡½æ•°ï¼ˆç¬¬3-6é¡µï¼‰==========

        // ç¬¬3é¡µï¼šæ–­æ¡¥å‡½æ•° - ä½¿ç”¨Plotly.js
        function drawBrokenBridgeGraphPlotly() {
            const x1 = [], y1 = [];
            for (let i = -0.5; i < 1; i += 0.05) {
                x1.push(i);
                y1.push(0.3 * i + 1.7);
            }

            const x2 = [], y2 = [];
            for (let i = 1; i <= 2.8; i += 0.05) {
                x2.push(i);
                y2.push(0.3 * i + 2.2);
            }

            const trace1 = {
                x: x1, y: y1,
                type: 'scatter', mode: 'lines',
                name: 'å·¦æ®µï¼šy = 0.3x + 1.7',
                line: { color: '#FF6B6B', width: 6 }
            };

            const trace2 = {
                x: x2, y: y2,
                type: 'scatter', mode: 'lines',
                name: 'å³æ®µï¼šy = 0.3x + 2.2',
                line: { color: '#4CAF50', width: 6 }
            };

            const trace3 = {
                x: [1, 1], y: [2, 2.5],
                type: 'scatter', mode: 'markers',
                name: 'æ–­ç‚¹',
                marker: { color: ['#FF6B6B', '#4CAF50'], size: 12 }
            };

            const trace4 = {
                x: [1, 1], y: [0, 3],
                type: 'scatter', mode: 'lines',
                name: 'xâ‚€ = 1',
                line: { color: '#FFC107', width: 3, dash: 'dash' }
            };

            const layout = {
                title: { text: 'æ–­æ¡¥å‡½æ•°ï¼šæé™ä¸å­˜åœ¨', font: { size: 16, color: '#333' }},
                xaxis: { title: 'x', range: [-1, 3], zeroline: true },
                yaxis: { title: 'y', range: [0, 3], zeroline: true },
                showlegend: true,
                legend: { x: 1, y: 0, xanchor: 'right', yanchor: 'bottom' },
                margin: { l: 50, r: 50, t: 50, b: 50 },
                annotations: [
                    {
                        x: 0.3, y: 2.1, text: 'å·¦æé™ = 2',
                        showarrow: true, arrowhead: 2, arrowcolor: '#FF6B6B',
                        ax: -30, ay: -20,
                        font: { color: '#FF6B6B', size: 15, family: 'Arial Black' },
                        bgcolor: 'rgba(255, 245, 245, 0.95)',
                        bordercolor: '#FF6B6B', borderwidth: 2, borderpad: 3
                    },
                    {
                        x: 1.7, y: 2.6, text: 'å³æé™ = 2.5',
                        showarrow: true, arrowhead: 2, arrowcolor: '#4CAF50',
                        ax: 30, ay: -20,
                        font: { color: '#4CAF50', size: 15, family: 'Arial Black' },
                        bgcolor: 'rgba(245, 255, 245, 0.95)',
                        bordercolor: '#4CAF50', borderwidth: 2, borderpad: 3
                    },
                    {
                        x: 1, y: 0.5, text: 'æé™ä¸å­˜åœ¨',
                        showarrow: false,
                        font: { color: '#FF5722', size: 15, family: 'Arial Black' },
                        bgcolor: 'rgba(255, 248, 248, 0.95)',
                        bordercolor: '#FF5722', borderwidth: 2, borderpad: 4
                    }
                ]
            };

            const config = { displayModeBar: false, responsive: true };
            Plotly.newPlot('graph1', [trace1, trace2, trace3, trace4], layout, config);
        }

        // ç¬¬4é¡µï¼šåŠ¨æ€æ–­æ¡¥æ¼”ç¤º
        function drawAnimatedBrokenBridgePlotly() {
            // å…ˆç»˜åˆ¶åŸºç¡€æ–­æ¡¥
            drawBrokenBridgeForPage4();
            // æ·»åŠ åŠ¨ç”»
            setTimeout(() => startBrokenBridgeAnimation(), 1000);
        }

        function drawBrokenBridgeForPage4() {
            const x1 = [], y1 = [];
            for (let i = -0.5; i < 1; i += 0.05) {
                x1.push(i);
                y1.push(0.3 * i + 1.7);
            }

            const x2 = [], y2 = [];
            for (let i = 1; i <= 2.8; i += 0.05) {
                x2.push(i);
                y2.push(0.3 * i + 2.2);
            }

            const trace1 = {
                x: x1, y: y1,
                type: 'scatter', mode: 'lines',
                name: 'å·¦æ®µ',
                line: { color: '#FF6B6B', width: 6 }
            };

            const trace2 = {
                x: x2, y: y2,
                type: 'scatter', mode: 'lines',
                name: 'å³æ®µ',
                line: { color: '#4CAF50', width: 6 }
            };

            const trace3 = {
                x: [1, 1], y: [2, 2.5],
                type: 'scatter', mode: 'markers',
                name: 'æ–­ç‚¹',
                marker: { color: ['#FF6B6B', '#4CAF50'], size: 12 }
            };

            const trace4 = {
                x: [1, 1], y: [0, 3],
                type: 'scatter', mode: 'lines',
                name: 'xâ‚€ = 1',
                line: { color: '#FFC107', width: 3, dash: 'dash' }
            };

            const layout = {
                title: { text: 'ğŸ¬ åŠ¨æ€æ¼”ç¤ºï¼šæ–­æ¡¥å‡½æ•°', font: { size: 16, color: '#333' }},
                xaxis: { title: 'x', range: [-1, 3], zeroline: true },
                yaxis: { title: 'y', range: [0, 3], zeroline: true },
                showlegend: true,
                margin: { l: 50, r: 50, t: 50, b: 50 }
            };

            const config = { displayModeBar: false, responsive: true };
            Plotly.newPlot('graph2', [trace1, trace2, trace3, trace4], layout, config);
        }

        function startBrokenBridgeAnimation() {
            let frame = 0;
            const totalFrames = 80;

            function animate() {
                if (currentPage !== 4) return;

                const progress = frame / totalFrames;

                if (progress < 0.5) {
                    // å·¦çƒç§»åŠ¨
                    const leftProgress = progress / 0.5;
                    const leftX = -0.5 + leftProgress * 1.4;
                    const leftY = 0.3 * leftX + 1.7;

                    if (frame === 0) {
                        const ballTrace = {
                            x: [leftX], y: [leftY],
                            type: 'scatter', mode: 'markers+text',
                            text: ['ğŸ˜Š'], textfont: { size: 24 },
                            marker: { color: '#FF6B6B', size: 35 },
                            name: 'çº¢çƒ', showlegend: false
                        };
                        Plotly.addTraces('graph2', [ballTrace]);
                    } else {
                        Plotly.restyle('graph2', { x: [[leftX]], y: [[leftY]] }, [4]);
                    }
                } else {
                    // å³çƒç§»åŠ¨
                    const rightProgress = (progress - 0.5) / 0.5;
                    const rightX = 2.8 - rightProgress * 1.7;
                    const rightY = 0.3 * rightX + 2.2;

                    if (progress < 0.51) {
                        const ballTrace = {
                            x: [rightX], y: [rightY],
                            type: 'scatter', mode: 'markers+text',
                            text: ['ğŸ˜„'], textfont: { size: 24 },
                            marker: { color: '#4CAF50', size: 35 },
                            name: 'ç»¿çƒ', showlegend: false
                        };
                        Plotly.addTraces('graph2', [ballTrace]);
                    } else {
                        Plotly.restyle('graph2', { x: [[rightX]], y: [[rightY]] }, [5]);
                    }
                }

                frame++;
                if (frame < totalFrames && currentPage === 4) {
                    setTimeout(animate, 250);
                }
            }

            animate();
        }

        // ç¬¬5é¡µï¼šå½©è™¹æ¡¥å‡½æ•°
        function drawRainbowBridgeGraphPlotly() {
            const x = [], y = [];
            for (let i = -2.2; i <= 2.2; i += 0.05) {
                x.push(i);
                y.push(i * i / 3 + 0.5);
            }

            const rainbowColors = [];
            for (let i = 0; i < x.length; i++) {
                const hue = (i / x.length) * 360;
                rainbowColors.push(`hsl(${hue}, 80%, 60%)`);
            }

            const trace1 = {
                x: x, y: y,
                type: 'scatter', mode: 'lines+markers',
                name: 'ğŸŒˆ å½©è™¹æ¡¥',
                line: { color: '#FF6B6B', width: 8 },
                marker: { color: rainbowColors, size: 6 }
            };

            const trace2 = {
                x: [0], y: [0.5],
                type: 'scatter', mode: 'markers',
                name: 'ä¼šåˆç‚¹ (0, 0.5)',
                marker: { color: '#FFD700', size: 15, symbol: 'star' }
            };

            const trace3 = {
                x: [0, 0], y: [-0.5, 2.5],
                type: 'scatter', mode: 'lines',
                name: 'xâ‚€ = 0',
                line: { color: '#FFC107', width: 3, dash: 'dash' }
            };

            const layout = {
                title: { text: 'å½©è™¹æ¡¥å‡½æ•°ï¼šæé™å­˜åœ¨', font: { size: 16, color: '#333' }},
                xaxis: { title: 'x', range: [-2.5, 2.5], zeroline: true },
                yaxis: { title: 'y', range: [-0.5, 2.5], zeroline: true },
                showlegend: true,
                margin: { l: 50, r: 50, t: 50, b: 50 },
                annotations: [
                    {
                        x: 0, y: 2.2, text: 'å·¦æé™ = å³æé™ = 0.5',
                        showarrow: true, arrowhead: 2, arrowcolor: '#4CAF50',
                        ax: 0, ay: -30,
                        font: { color: '#4CAF50', size: 15, family: 'Arial Black' },
                        bgcolor: 'rgba(245, 255, 245, 0.95)',
                        bordercolor: '#4CAF50', borderwidth: 2, borderpad: 4
                    }
                ]
            };

            const config = { displayModeBar: false, responsive: true };
            Plotly.newPlot('graph3', [trace1, trace2, trace3], layout, config);
        }

        // ç¬¬6é¡µï¼šå¥‡è¿¹æ¼”ç¤º
        function drawMiracleGraphPlotly() {
            // å…ˆç»˜åˆ¶å½©è™¹æ¡¥
            drawRainbowBridgeForPage6();
            // æ·»åŠ åŠ¨ç”»
            setTimeout(() => startRainbowBridgeAnimation(), 1000);
        }

        function drawRainbowBridgeForPage6() {
            const x = [], y = [];
            for (let i = -2.2; i <= 2.2; i += 0.05) {
                x.push(i);
                y.push(i * i / 3 + 0.5);
            }

            const rainbowColors = [];
            for (let i = 0; i < x.length; i++) {
                const hue = (i / x.length) * 360;
                rainbowColors.push(`hsl(${hue}, 80%, 60%)`);
            }

            const trace1 = {
                x: x, y: y,
                type: 'scatter', mode: 'lines+markers',
                name: 'ğŸŒˆ å½©è™¹æ¡¥',
                line: { color: '#FF6B6B', width: 8 },
                marker: { color: rainbowColors, size: 6 }
            };

            const trace2 = {
                x: [0], y: [0.5],
                type: 'scatter', mode: 'markers',
                name: 'ä¼šåˆç‚¹',
                marker: { color: '#FFD700', size: 15, symbol: 'star' }
            };

            const trace3 = {
                x: [0, 0], y: [-0.5, 2.5],
                type: 'scatter', mode: 'lines',
                name: 'xâ‚€ = 0',
                line: { color: '#FFC107', width: 3, dash: 'dash' }
            };

            const layout = {
                title: { text: 'ğŸ‰ å¥‡è¿¹æ¼”ç¤ºï¼šå½©è™¹æ¡¥å‡½æ•°', font: { size: 16, color: '#333' }},
                xaxis: { title: 'x', range: [-2.5, 2.5], zeroline: true },
                yaxis: { title: 'y', range: [-0.5, 2.5], zeroline: true },
                showlegend: true,
                margin: { l: 50, r: 50, t: 50, b: 50 }
            };

            const config = { displayModeBar: false, responsive: true };
            Plotly.newPlot('graph4', [trace1, trace2, trace3], layout, config);
        }

        function startRainbowBridgeAnimation() {
            let frame = 0;
            const totalFrames = 75;

            function animate() {
                if (currentPage !== 6) return;

                const progress = frame / totalFrames;
                const leftX = -2.0 + progress * 1.95;
                const rightX = 2.0 - progress * 1.95;
                const leftY = leftX * leftX / 3 + 0.5;
                const rightY = rightX * rightX / 3 + 0.5;

                if (frame === 0) {
                    const ball1 = {
                        x: [leftX], y: [leftY],
                        type: 'scatter', mode: 'markers+text',
                        text: ['ğŸ˜'], textfont: { size: 22 },
                        marker: { color: '#E91E63', size: 32 },
                        name: 'ç²‰çƒ', showlegend: false
                    };
                    const ball2 = {
                        x: [rightX], y: [rightY],
                        type: 'scatter', mode: 'markers+text',
                        text: ['ğŸ¤©'], textfont: { size: 22 },
                        marker: { color: '#2196F3', size: 32 },
                        name: 'è“çƒ', showlegend: false
                    };
                    Plotly.addTraces('graph4', [ball1, ball2]);
                } else {
                    Plotly.restyle('graph4', {
                        x: [[leftX], [rightX]],
                        y: [[leftY], [rightY]]
                    }, [3, 4]);
                }

                frame++;
                if (frame < totalFrames && currentPage === 6) {
                    setTimeout(animate, 333);
                }
            }

            animate();
        }

        // ========== D3.jsç»˜å›¾å‡½æ•°ï¼ˆç¬¬7-9é¡µï¼šæ— ç©·æé™ï¼‰==========

        // ç¬¬7é¡µï¼šå›¢é˜Ÿç›®æ ‡ - D3.jsç‰ˆæœ¬
        function drawTeamGoalD3() {
            const container = d3.select('#graph7');
            container.selectAll('*').remove();

            const margin = {top: 20, right: 20, bottom: 40, left: 50};
            const width = container.node().getBoundingClientRect().width - margin.left - margin.right;
            const height = container.node().getBoundingClientRect().height - margin.top - margin.bottom;

            const svg = container.append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .style('background', 'transparent');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // åˆ›å»ºæ¯”ä¾‹å°º
            const xScale = d3.scaleLinear().domain([0.1, 10]).range([0, width]);
            const yScale = d3.scaleLinear().domain([0, 2]).range([height, 0]);

            // åˆ›å»ºçº¿æ¡ç”Ÿæˆå™¨
            const line = d3.line()
                .x(d => xScale(d.x))
                .y(d => yScale(d.y))
                .curve(d3.curveMonotoneX);

            // ç”Ÿæˆæ•°æ®
            const data1 = [], data2 = [];
            for (let x = 0.1; x <= 10; x += 0.1) {
                data1.push({x: x, y: 1/x});
                data2.push({x: x, y: 2/(x+1)});
            }

            // æ·»åŠ åæ ‡è½´ - ç¾åŒ–æ ·å¼
            const xAxis = g.append('g')
                .attr('transform', `translate(0,${height})`)
                .call(d3.axisBottom(xScale).ticks(8))
                .style('color', '#333');

            xAxis.append('text')
                .attr('x', width/2)
                .attr('y', 35)
                .attr('fill', '#1e3c72')
                .style('text-anchor', 'middle')
                .style('font-size', '12px')
                .style('font-weight', '500')
                .text('æ—¶é—´è¶Šæ¥è¶Šé•¿ â†’');

            const yAxis = g.append('g')
                .call(d3.axisLeft(yScale).ticks(6))
                .style('color', '#333');

            yAxis.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', -35)
                .attr('x', -height/2)
                .attr('fill', '#1e3c72')
                .style('text-anchor', 'middle')
                .style('font-size', '12px')
                .style('font-weight', '500')
                .text('è·ç¦»ç›®æ ‡è¿˜æœ‰å¤šè¿œ');

            // æ·»åŠ ç½‘æ ¼çº¿
            g.selectAll('.grid-x')
                .data(xScale.ticks(8))
                .enter().append('line')
                .attr('class', 'grid-x')
                .attr('x1', d => xScale(d))
                .attr('x2', d => xScale(d))
                .attr('y1', 0)
                .attr('y2', height)
                .attr('stroke', '#e0e0e0')
                .attr('stroke-width', 0.5);

            g.selectAll('.grid-y')
                .data(yScale.ticks(6))
                .enter().append('line')
                .attr('class', 'grid-y')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', d => yScale(d))
                .attr('y2', d => yScale(d))
                .attr('stroke', '#e0e0e0')
                .attr('stroke-width', 0.5);

            // æ·»åŠ ç›®æ ‡çº¿ï¼ˆy=0ï¼‰
            g.append('line')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', yScale(0))
                .attr('y2', yScale(0))
                .attr('stroke', '#FF9800')
                .attr('stroke-width', 3)
                .attr('stroke-dasharray', '5,5')
                .style('opacity', 0)
                .transition()
                .duration(1000)
                .style('opacity', 1);

            // æ·»åŠ å‡½æ•°æ›²çº¿ - å¸¦åŠ¨ç”»
            const path1 = g.append('path')
                .datum(data1)
                .attr('fill', 'none')
                .attr('stroke', '#2196F3')
                .attr('stroke-width', 4)
                .attr('d', line);

            const path2 = g.append('path')
                .datum(data2)
                .attr('fill', 'none')
                .attr('stroke', '#4CAF50')
                .attr('stroke-width', 4)
                .attr('d', line);

            // è·¯å¾„åŠ¨ç”»
            const totalLength1 = path1.node().getTotalLength();
            const totalLength2 = path2.node().getTotalLength();

            path1
                .attr('stroke-dasharray', totalLength1 + ' ' + totalLength1)
                .attr('stroke-dashoffset', totalLength1)
                .transition()
                .duration(2000)
                .attr('stroke-dashoffset', 0);

            path2
                .attr('stroke-dasharray', totalLength2 + ' ' + totalLength2)
                .attr('stroke-dashoffset', totalLength2)
                .transition()
                .duration(2000)
                .delay(500)
                .attr('stroke-dashoffset', 0);

            // æ·»åŠ å›¾ä¾‹ - å³ä¸‹è§’ä½ç½®
            const legend = g.append('g')
                .attr('transform', `translate(${width - 120}, ${height - 60})`)
                .style('opacity', 0);

            // é€æ˜èƒŒæ™¯
            legend.append('rect')
                .attr('x', -5)
                .attr('y', -5)
                .attr('width', 115)
                .attr('height', 55)
                .attr('fill', 'rgba(255,255,255,0.9)')
                .attr('stroke', 'none')
                .attr('rx', 3);

            legend.append('line')
                .attr('x1', 0).attr('x2', 15)
                .attr('y1', 10).attr('y2', 10)
                .attr('stroke', '#2196F3')
                .attr('stroke-width', 3);

            legend.append('text')
                .attr('x', 20).attr('y', 14)
                .text('ä¸œéƒ¨å›¢é˜Ÿä¸šç»©')
                .style('font-size', '10px')
                .style('font-weight', '500')
                .attr('fill', '#333');

            legend.append('line')
                .attr('x1', 0).attr('x2', 15)
                .attr('y1', 30).attr('y2', 30)
                .attr('stroke', '#4CAF50')
                .attr('stroke-width', 3);

            legend.append('text')
                .attr('x', 20).attr('y', 34)
                .text('è¥¿éƒ¨å›¢é˜Ÿä¸šç»©')
                .style('font-size', '10px')
                .style('font-weight', '500')
                .attr('fill', '#333');

            // å›¾ä¾‹æ·¡å…¥åŠ¨ç”»
            legend.transition()
                .duration(500)
                .delay(2500)
                .style('opacity', 1);

            // æ·»åŠ å¥–æ¯å›¾æ ‡è¡¨ç¤ºç›®æ ‡
            const trophy = createTrophyIcon(g, width - 30, yScale(0) - 10, '#FFD700');
            trophy.transition()
                .duration(1000)
                .delay(1000)
                .style('opacity', 1);

            // æ·»åŠ åŠ¨æ€ç‚¹è¡¨ç¤ºè¶‹å‘ç›®æ ‡ - ä¿®æ­£è½¨è¿¹ï¼Œç¡®ä¿åœ¨çº¿ä¸Š
            const movingDot1 = g.append('circle')
                .attr('r', 5)
                .attr('fill', '#2196F3')
                .attr('cx', xScale(1))
                .attr('cy', yScale(1/1))  // ç¡®ä¿åœ¨1/xçº¿ä¸Š
                .style('opacity', 0);

            const movingDot2 = g.append('circle')
                .attr('r', 5)
                .attr('fill', '#4CAF50')
                .attr('cx', xScale(1))
                .attr('cy', yScale(2/(1+1)))  // ç¡®ä¿åœ¨2/(x+1)çº¿ä¸Š
                .style('opacity', 0);

            // æ·»åŠ äººç‰©å›¾æ ‡ - éƒ½å‘å³ç§»åŠ¨
            const newTeamIcon1 = createPersonIcon(g, xScale(0.5), yScale(1/0.5), '#2196F3', 'right');
            const newTeamIcon2 = createPersonIcon(g, xScale(0.5), yScale(2/1.5), '#4CAF50', 'right');

            // åŠ¨ç”»æ˜¾ç¤ºè¶‹å‘è¿‡ç¨‹ - ä¿®æ­£è½¨è¿¹
            setTimeout(() => {
                // ç¬¬ä¸€ä¸ªç‚¹æ²¿ç€1/xæ›²çº¿ç§»åŠ¨
                movingDot1.style('opacity', 1);
                newTeamIcon1.style('opacity', 1);

                // åˆ›å»ºæ²¿æ›²çº¿ç§»åŠ¨çš„åŠ¨ç”»
                let t = 0;
                const animate1 = () => {
                    t += 0.02;
                    const x = 1 + t * 7;  // ä»1åˆ°8
                    if (x <= 8) {
                        movingDot1
                            .attr('cx', xScale(x))
                            .attr('cy', yScale(1/x));
                        newTeamIcon1
                            .attr('transform', `translate(${xScale(x)}, ${yScale(1/x) - 25})`);
                        requestAnimationFrame(animate1);
                    }
                };
                animate1();

                // ç¬¬äºŒä¸ªç‚¹æ²¿ç€2/(x+1)æ›²çº¿ç§»åŠ¨
                movingDot2.style('opacity', 1);
                newTeamIcon2.style('opacity', 1);

                let t2 = 0;
                const animate2 = () => {
                    t2 += 0.02;
                    const x = 1 + t2 * 7;  // ä»1åˆ°8
                    if (x <= 8) {
                        movingDot2
                            .attr('cx', xScale(x))
                            .attr('cy', yScale(2/(x+1)));
                        newTeamIcon2
                            .attr('transform', `translate(${xScale(x)}, ${yScale(2/(x+1)) - 25})`);
                        requestAnimationFrame(animate2);
                    }
                };
                setTimeout(animate2, 500);
            }, 3000);
        }

        // ç¬¬8é¡µï¼šä¸åŒç›®æ ‡ - D3.jsç‰ˆæœ¬
        function drawDifferentGoalsD3() {
            const container = d3.select('#graph8');
            container.selectAll('*').remove();

            const margin = {top: 20, right: 20, bottom: 40, left: 60};
            const width = container.node().getBoundingClientRect().width - margin.left - margin.right;
            const height = container.node().getBoundingClientRect().height - margin.top - margin.bottom;

            const svg = container.append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .style('background', 'transparent');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // åˆ›å»ºæ¯”ä¾‹å°º - ä¿®æ­£èŒƒå›´ï¼Œç¡®ä¿yè½´æ­£ç¡®æ˜¾ç¤º
            const xScale = d3.scaleLinear().domain([-5, 5]).range([0, width]);
            const yScale = d3.scaleLinear().domain([-2, 2]).range([height, 0]);

            // åˆ›å»ºçº¿æ¡ç”Ÿæˆå™¨
            const line = d3.line()
                .x(d => xScale(d.x))
                .y(d => yScale(d.y))
                .curve(d3.curveMonotoneX);

            // ç”Ÿæˆarctanæ•°æ®
            const data = [];
            for (let x = -5; x <= 5; x += 0.1) {
                data.push({x: x, y: Math.atan(x)});
            }

            // æ·»åŠ ç½‘æ ¼çº¿
            g.selectAll('.grid-x')
                .data(xScale.ticks(8))
                .enter().append('line')
                .attr('class', 'grid-x')
                .attr('x1', d => xScale(d))
                .attr('x2', d => xScale(d))
                .attr('y1', 0)
                .attr('y2', height)
                .attr('stroke', '#e0e0e0')
                .attr('stroke-width', 0.5);

            g.selectAll('.grid-y')
                .data(yScale.ticks(6))
                .enter().append('line')
                .attr('class', 'grid-y')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', d => yScale(d))
                .attr('y2', d => yScale(d))
                .attr('stroke', '#e0e0e0')
                .attr('stroke-width', 0.5);

            // æ·»åŠ åæ ‡è½´ - ä¿®æ­£xè½´ä½ç½®ï¼Œåº”è¯¥åœ¨y=0å¤„
            const xAxis = g.append('g')
                .attr('transform', `translate(0,${yScale(0)})`)
                .call(d3.axisBottom(xScale).ticks(8))
                .style('color', '#333');

            // xè½´æ ‡ç­¾ - è°ƒæ•´ä½ç½®ï¼Œé¿å…ä¸åæ ‡è½´é‡å 
            xAxis.append('text')
                .attr('x', width - 50)  // ç§»åˆ°å³ä¾§
                .attr('y', -10)         // åœ¨xè½´ä¸Šæ–¹
                .attr('fill', '#1e3c72')
                .style('text-anchor', 'middle')
                .style('font-size', '12px')
                .style('font-weight', '500')
                .text('å›¢é˜ŸåŠªåŠ›æ–¹å‘ â†’');

            const yAxis = g.append('g')
                .attr('transform', `translate(${xScale(0)},0)`)  // yè½´åº”è¯¥åœ¨x=0å¤„
                .call(d3.axisLeft(yScale).ticks(6))
                .style('color', '#333');

            // yè½´æ ‡ç­¾ - è°ƒæ•´ä½ç½®ï¼Œæ”¾åœ¨yè½´å³ä¾§
            yAxis.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', 20)          // åœ¨yè½´å³ä¾§
                .attr('x', -30)         // é è¿‘é¡¶éƒ¨
                .attr('fill', '#1e3c72')
                .style('text-anchor', 'middle')
                .style('font-size', '12px')
                .style('font-weight', '500')
                .text('â†‘ å›¢é˜Ÿç›®æ ‡é«˜åº¦');

            // æ·»åŠ ç›®æ ‡çº¿
            const piHalf = Math.PI/2;

            // æ­£Ï€/2çº¿
            g.append('line')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', yScale(piHalf))
                .attr('y2', yScale(piHalf))
                .attr('stroke', '#F44336')
                .attr('stroke-width', 3)
                .attr('stroke-dasharray', '5,5')
                .style('opacity', 0)
                .transition()
                .duration(1000)
                .delay(1500)
                .style('opacity', 1);

            // è´ŸÏ€/2çº¿
            g.append('line')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', yScale(-piHalf))
                .attr('y2', yScale(-piHalf))
                .attr('stroke', '#2196F3')
                .attr('stroke-width', 3)
                .attr('stroke-dasharray', '5,5')
                .style('opacity', 0)
                .transition()
                .duration(1000)
                .delay(2000)
                .style('opacity', 1);

            // æ·»åŠ arctanæ›²çº¿
            const path = g.append('path')
                .datum(data)
                .attr('fill', 'none')
                .attr('stroke', '#9C27B0')
                .attr('stroke-width', 4)
                .attr('d', line);

            // è·¯å¾„åŠ¨ç”»
            const totalLength = path.node().getTotalLength();
            path
                .attr('stroke-dasharray', totalLength + ' ' + totalLength)
                .attr('stroke-dashoffset', totalLength)
                .transition()
                .duration(2500)
                .attr('stroke-dashoffset', 0);

            // å›¾ä¾‹åœ¨å³ä¸‹è§’
            const legend = g.append('g')
                .attr('transform', `translate(${width - 140}, ${height - 80})`)
                .style('opacity', 0);

            legend.append('rect')
                .attr('x', -5)
                .attr('y', -5)
                .attr('width', 135)
                .attr('height', 75)
                .attr('fill', 'rgba(255,255,255,0.9)')
                .attr('stroke', 'none')
                .attr('rx', 3);

            legend.append('line')
                .attr('x1', 0).attr('x2', 15)
                .attr('y1', 10).attr('y2', 10)
                .attr('stroke', '#F44336')
                .attr('stroke-width', 3)
                .attr('stroke-dasharray', '3,3');

            legend.append('text')
                .attr('x', 20).attr('y', 14)
                .text('ä¸œéƒ¨å›¢é˜Ÿç›®æ ‡')
                .style('font-size', '10px')
                .style('font-weight', '500')
                .attr('fill', '#F44336');

            legend.append('line')
                .attr('x1', 0).attr('x2', 15)
                .attr('y1', 30).attr('y2', 30)
                .attr('stroke', '#2196F3')
                .attr('stroke-width', 3)
                .attr('stroke-dasharray', '3,3');

            legend.append('text')
                .attr('x', 20).attr('y', 34)
                .text('è¥¿éƒ¨å›¢é˜Ÿç›®æ ‡')
                .style('font-size', '10px')
                .style('font-weight', '500')
                .attr('fill', '#2196F3');

            legend.append('line')
                .attr('x1', 0).attr('x2', 15)
                .attr('y1', 50).attr('y2', 50)
                .attr('stroke', '#9C27B0')
                .attr('stroke-width', 3);

            legend.append('text')
                .attr('x', 20).attr('y', 54)
                .text('å›¢é˜Ÿå‘å±•è½¨è¿¹')
                .style('font-size', '10px')
                .style('font-weight', '500')
                .attr('fill', '#9C27B0');

            // å›¾ä¾‹æ·¡å…¥åŠ¨ç”»
            legend.transition()
                .duration(500)
                .delay(3000)
                .style('opacity', 1);

            // æ·»åŠ åˆ†æ­§æ ‡å¿—
            const conflictIcon = g.append('text')
                .attr('x', width/2)
                .attr('y', 30)
                .text('âš¡')
                .style('font-size', '24px')
                .style('text-anchor', 'middle')
                .style('opacity', 0)
                .transition()
                .duration(1000)
                .delay(2500)
                .style('opacity', 1);

            // æ·»åŠ äººç‰©å›¾æ ‡ - æ³¨æ„æ–¹å‘
            const newEastTeam = createPersonIcon(g, xScale(3), yScale(Math.atan(3)), '#2196F3', 'right');
            const newWestTeam = createPersonIcon(g, xScale(-3), yScale(Math.atan(-3)), '#4CAF50', 'left');

            // æ·»åŠ åŠ¨æ€ç‚¹è¡¨ç¤ºè¶‹å‘ - ç¡®ä¿åœ¨arctanæ›²çº¿ä¸Š
            const movingDot1 = g.append('circle')
                .attr('r', 4)
                .attr('fill', '#FF6B6B')
                .attr('cx', xScale(0.5))
                .attr('cy', yScale(Math.atan(0.5)))  // ç¡®ä¿åœ¨arctanæ›²çº¿ä¸Š
                .style('opacity', 0);

            const movingDot2 = g.append('circle')
                .attr('r', 4)
                .attr('fill', '#4ECDC4')
                .attr('cx', xScale(-0.5))
                .attr('cy', yScale(Math.atan(-0.5)))  // ç¡®ä¿åœ¨arctanæ›²çº¿ä¸Š
                .style('opacity', 0);

            // åŠ¨ç”»æ˜¾ç¤ºåŠ¨æ€ç‚¹ - æ²¿ç€arctanæ›²çº¿ç§»åŠ¨
            setTimeout(() => {
                // ä¸œéƒ¨å›¢é˜ŸåŠ¨ç”»
                movingDot1.style('opacity', 1);
                newEastTeam.style('opacity', 1);

                let t1 = 0;
                const animateEast = () => {
                    t1 += 0.03;
                    const x = 0.5 + t1 * 3.5;  // ä»0.5åˆ°4
                    if (x <= 4) {
                        const y = Math.atan(x);
                        movingDot1
                            .attr('cx', xScale(x))
                            .attr('cy', yScale(y));
                        newEastTeam
                            .attr('transform', `translate(${xScale(x)}, ${yScale(y) - 25})`);
                        requestAnimationFrame(animateEast);
                    }
                };
                animateEast();

                // è¥¿éƒ¨å›¢é˜ŸåŠ¨ç”»
                movingDot2.style('opacity', 1);
                newWestTeam.style('opacity', 1);

                let t2 = 0;
                const animateWest = () => {
                    t2 += 0.03;
                    const x = -0.5 - t2 * 3.5;  // ä»-0.5åˆ°-4
                    if (x >= -4) {
                        const y = Math.atan(x);
                        movingDot2
                            .attr('cx', xScale(x))
                            .attr('cy', yScale(y));
                        newWestTeam
                            .attr('transform', `translate(${xScale(x)}, ${yScale(y) + 5})`);
                        requestAnimationFrame(animateWest);
                    }
                };
                setTimeout(animateWest, 300);
            }, 3500);
        }

        // ç¬¬9é¡µï¼šç»Ÿä¸€ç›®æ ‡ - D3.jsç‰ˆæœ¬ï¼Œå¢åŠ åŠ¨ç”»å…ƒç´ 
        function drawUnifiedGoalD3() {
            const container = d3.select('#graph9');
            container.selectAll('*').remove();

            const margin = {top: 20, right: 20, bottom: 40, left: 50};
            const width = container.node().getBoundingClientRect().width - margin.left - margin.right;
            const height = container.node().getBoundingClientRect().height - margin.top - margin.bottom;

            const svg = container.append('svg')
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom)
                .style('background', 'transparent');

            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);

            // åˆ›å»ºæ¯”ä¾‹å°º
            const xScale = d3.scaleLinear().domain([-6, 6]).range([0, width]);
            const yScale = d3.scaleLinear().domain([-0.1, 1.1]).range([height, 0]);

            // åˆ›å»ºçº¿æ¡ç”Ÿæˆå™¨
            const line = d3.line()
                .x(d => xScale(d.x))
                .y(d => yScale(d.y))
                .curve(d3.curveMonotoneX);

            // ç”Ÿæˆæ•°æ®
            const data = [];
            for (let x = -6; x <= 6; x += 0.1) {
                data.push({x: x, y: 1/(1 + x*x)});
            }

            // æ·»åŠ ç½‘æ ¼çº¿
            g.selectAll('.grid-x')
                .data(xScale.ticks(8))
                .enter().append('line')
                .attr('class', 'grid-x')
                .attr('x1', d => xScale(d))
                .attr('x2', d => xScale(d))
                .attr('y1', 0)
                .attr('y2', height)
                .attr('stroke', '#e0e0e0')
                .attr('stroke-width', 0.5);

            g.selectAll('.grid-y')
                .data(yScale.ticks(6))
                .enter().append('line')
                .attr('class', 'grid-y')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', d => yScale(d))
                .attr('y2', d => yScale(d))
                .attr('stroke', '#e0e0e0')
                .attr('stroke-width', 0.5);

            // æ·»åŠ åæ ‡è½´ - ä¿®æ­£ä½ç½®
            const xAxis = g.append('g')
                .attr('transform', `translate(0,${yScale(0)})`)  // xè½´åº”è¯¥åœ¨y=0å¤„
                .call(d3.axisBottom(xScale).ticks(8))
                .style('color', '#333');

            // xè½´æ ‡ç­¾
            xAxis.append('text')
                .attr('x', width - 50)
                .attr('y', -10)
                .attr('fill', '#1e3c72')
                .style('text-anchor', 'middle')
                .style('font-size', '12px')
                .style('font-weight', '500')
                .text('å›¢é˜ŸåŠªåŠ›æ–¹å‘ â†’');

            const yAxis = g.append('g')
                .attr('transform', `translate(${xScale(0)},0)`)  // yè½´åº”è¯¥åœ¨x=0å¤„
                .call(d3.axisLeft(yScale).ticks(6))
                .style('color', '#333');

            // yè½´æ ‡ç­¾
            yAxis.append('text')
                .attr('transform', 'rotate(-90)')
                .attr('y', 20)
                .attr('x', -30)
                .attr('fill', '#1e3c72')
                .style('text-anchor', 'middle')
                .style('font-size', '12px')
                .style('font-weight', '500')
                .text('â†‘ å›¢é˜Ÿä¸šç»©æ°´å¹³');

            // æ·»åŠ ç›®æ ‡çº¿ï¼ˆy=0ï¼‰
            g.append('line')
                .attr('x1', 0)
                .attr('x2', width)
                .attr('y1', yScale(0))
                .attr('y2', yScale(0))
                .attr('stroke', '#FF9800')
                .attr('stroke-width', 3)
                .attr('stroke-dasharray', '5,5')
                .style('opacity', 0)
                .transition()
                .duration(1000)
                .style('opacity', 1);

            // æ·»åŠ æ€»éƒ¨å¤§å…å›¾æ ‡
            const headquarters = g.append('text')
                .attr('x', width/2)
                .attr('y', yScale(0) - 15)
                .text('ğŸ¢')
                .style('font-size', '24px')
                .style('text-anchor', 'middle')
                .style('opacity', 0)
                .transition()
                .duration(1000)
                .delay(1500)
                .style('opacity', 1);

            // æ·»åŠ å‡½æ•°æ›²çº¿
            const path = g.append('path')
                .datum(data)
                .attr('fill', 'none')
                .attr('stroke', '#4CAF50')
                .attr('stroke-width', 4)
                .attr('d', line);

            // è·¯å¾„åŠ¨ç”»
            const totalLength = path.node().getTotalLength();
            path
                .attr('stroke-dasharray', totalLength + ' ' + totalLength)
                .attr('stroke-dashoffset', totalLength)
                .transition()
                .duration(2000)
                .attr('stroke-dashoffset', 0);

            // æ·»åŠ äººç‰©å›¾æ ‡ - ä»ä¸­å¿ƒå¼€å§‹ï¼Œè·‘å‘æ— ç©·è¿œå¤„
            const newEastTeam = createPersonIcon(g, xScale(0), yScale(1), '#2196F3', 'right');
            const newWestTeam = createPersonIcon(g, xScale(0), yScale(1), '#4CAF50', 'left');

            const movingDot1 = g.append('circle')
                .attr('r', 5)
                .attr('fill', '#FF6B6B')
                .attr('cx', xScale(0))  // ä»x=0å¼€å§‹ï¼ˆä¸­å¿ƒï¼‰
                .attr('cy', yScale(1))  // ä»æœ€é«˜ç‚¹å¼€å§‹
                .style('opacity', 0);

            const movingDot2 = g.append('circle')
                .attr('r', 5)
                .attr('fill', '#4ECDC4')
                .attr('cx', xScale(0))   // ä»x=0å¼€å§‹ï¼ˆä¸­å¿ƒï¼‰
                .attr('cy', yScale(1))   // ä»æœ€é«˜ç‚¹å¼€å§‹
                .style('opacity', 0);

            // å‘æ•£åŠ¨ç”» - ä»ä¸­å¿ƒå‘æ— ç©·è¿œå¤„è·‘
            setTimeout(() => {
                newEastTeam.style('opacity', 1);
                newWestTeam.style('opacity', 1);
                movingDot1.style('opacity', 1);
                movingDot2.style('opacity', 1);

                // æ²¿æ›²çº¿ä»ä¸­å¿ƒå‘æ— ç©·è¿œå¤„å‘æ•£
                let t = 0;
                const divergeAnimation = () => {
                    t += 0.015;  // ç¨å¾®æ…¢ä¸€ç‚¹ï¼Œæ›´å¥½è§‚å¯Ÿ

                    // è¥¿éƒ¨å›¢é˜Ÿä»ä¸­å¿ƒå‘-âˆç§»åŠ¨ï¼ˆxä»0åˆ°-6ï¼‰
                    const x1 = 0 - t * 6;
                    if (x1 >= -6) {
                        const y1 = 1/(1 + x1*x1);
                        movingDot1
                            .attr('cx', xScale(x1))
                            .attr('cy', yScale(y1));
                        newWestTeam
                            .attr('transform', `translate(${xScale(x1)}, ${yScale(y1) - 25})`);
                    }

                    // ä¸œéƒ¨å›¢é˜Ÿä»ä¸­å¿ƒå‘+âˆç§»åŠ¨ï¼ˆxä»0åˆ°6ï¼‰
                    const x2 = 0 + t * 6;
                    if (x2 <= 6) {
                        const y2 = 1/(1 + x2*x2);
                        movingDot2
                            .attr('cx', xScale(x2))
                            .attr('cy', yScale(y2));
                        newEastTeam
                            .attr('transform', `translate(${xScale(x2)}, ${yScale(y2) - 25})`);
                    }

                    if (t < 1) {
                        requestAnimationFrame(divergeAnimation);
                    } else {
                        // æ·»åŠ å‘æ•£è¯´æ˜çš„æ–‡å­—æç¤º
                        g.append('text')
                            .attr('x', width/2)
                            .attr('y', yScale(0) - 50)
                            .text('ä¸¤ä¸ªå›¢é˜Ÿéƒ½è¶‹å‘åŒä¸€ä¸ªæé™å€¼ï¼š0')
                            .style('font-size', '12px')
                            .style('text-anchor', 'middle')
                            .style('fill', '#4CAF50')
                            .style('font-weight', 'bold')
                            .style('opacity', 0)
                            .transition()
                            .duration(500)
                            .delay(500)
                            .style('opacity', 1);
                    }
                };
                divergeAnimation();
            }, 2500);
        }
    </script>
</body>
</html>
