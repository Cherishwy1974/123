<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1920, initial-scale=1.0">
    <title>03_3.2_åŸºæœ¬æ±‚å¯¼å…¬å¼ä¸å››åˆ™è¿ç®—</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">

    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            svg: { fontCache: 'global' },
            startup: {
                pageReady: () => {
                    return MathJax.startup.defaultPageReady().then(() => {
                        console.log('âœ… MathJaxå·²åŠ è½½');
                    });
                }
            }
        };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; margin: 0; padding: 0; }
        body { font-family: 'Noto Serif SC', serif; background: #1a1a2e; overflow: hidden; height: 100vh; width: 100vw; }
        .blackboard { width: 100vw; height: 100vh; background: #1a1a2e; position: relative; border: 10px solid #795548; margin: 0; }

        .avatar-container {
            position: fixed;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 975px;
            height: 1105px;
            overflow: hidden;
            z-index: 50;
            pointer-events: none;
            background: transparent;
        }

        .wrapper { width: 100%; height: 100%; background: transparent; pointer-events: auto; }

        .slide-container { width: 100%; height: 100%; position: relative; }
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.6s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            background-color: transparent;
        }
        .slide.active { opacity: 1; visibility: visible; }

        .slide-content { display: flex; flex-direction: row; gap: 2rem; width: 100%; height: 95%; }

        .chalkboard {
            flex: 0 0 45%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow-y: auto;
        }

        .chalkboard h2 {
            color: #f1c40f;
            border-bottom: 2px solid #f39c12;
            font-size: 28px;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .chalkboard h3 {
            color: #1abc9c;
            font-size: 22px;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .chalkboard p, .chalkboard li {
            color: #e0e0e0;
            font-size: 18px;
            line-height: 1.8;
            margin: 8px 0;
        }

        .chalkboard strong { color: #e74c3c; }

        .math-formula {
            background-color: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #f39c12;
            font-size: 20px;
            color: #1abc9c;
            text-align: center;
            margin: 15px 0;
        }

        .visualization {
            flex: 1;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .control-bar {
            position: fixed;
            left: -9999px;
            top: 50%;
            transform: translateY(-50%);
            width: 270px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 200;
            border-radius: 0 20px 20px 0;
            padding: 25px 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn {
            padding: 14px 22px;
            background: rgba(255, 255, 255, 0.25);
            color: #333;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            width: 100%;
            text-align: center;
        }

        .btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
        }

        .subtitle-area {
            position: absolute;
            bottom: 20px;
            left: 50px;
            right: 50px;
            min-height: 50px;
            background: rgba(0,0,0,0.8);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 60;
            color: white;
            font-size: 23px;
            text-align: center;
            padding: 15px 20px;
            line-height: 1.4;
        }

        .status-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            background: rgba(0,0,0,0.5);
            color: white;
            border-radius: 5px;
            font-size: 16px;
            z-index: 100;
            display: none;
        }

        .status-indicator.connected { background: rgba(76, 175, 80, 0.8); display: block; }
        .status-indicator.error { background: rgba(244, 67, 54, 0.8); display: block; }
        .status-indicator.connecting { background: rgba(255, 152, 0, 0.8); display: block; }
    </style>
</head>
<body class="blackboard">
    <div class="status-indicator" id="statusIndicator">ç­‰å¾…è¿æ¥</div>

    <div class="avatar-container">
        <div class="wrapper" id="avatarWrapper"></div>
    </div>

    <div class="slide-container">
        <!-- ç¬¬1é¡µï¼šå¼•å…¥ - ä¸ºä»€ä¹ˆéœ€è¦æ±‚å¯¼å…¬å¼ -->
        <div class="slide active">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>ä¸ºä»€ä¹ˆéœ€è¦æ±‚å¯¼å…¬å¼?</h2>
                    <p>ä¸ŠèŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†å¯¼æ•°çš„<strong>å®šä¹‰</strong>:</p>
                    <div class="math-formula">
                        $$f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}$$
                    </div>
                    <p>ä½†æ˜¯,å¦‚æœæ¯æ¬¡éƒ½ç”¨å®šä¹‰æ¥æ±‚å¯¼...</p>
                    <h3>é—®é¢˜æ¥äº†!</h3>
                    <p>å¯¹äº $f(x) = x^{100}$,ç”¨å®šä¹‰æ±‚å¯¼éœ€è¦å±•å¼€:</p>
                    <div class="math-formula">
                        $(x+h)^{100} = x^{100} + 100x^{99}h + \cdots$
                    </div>
                    <p><strong>å¤ªæ…¢äº†!</strong> æˆ‘ä»¬éœ€è¦æ›´é«˜æ•ˆçš„æ–¹æ³• â€” æ±‚å¯¼å…¬å¼!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <defs>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" style="stop-color:#e74c3c;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#f39c12;stop-opacity:1" />
                            </linearGradient>
                        </defs>

                        <!-- å¤æ‚è®¡ç®—ç¤ºæ„ -->
                        <text fill="#f39c12" font-size="32" text-anchor="middle" x="300" y="80">ç”¨å®šä¹‰å¤ªæ…¢...</text>

                        <circle cx="150" cy="200" r="40" fill="none" stroke="#e74c3c" stroke-width="3">
                            <animate attributeName="r" dur="2s" values="40;50;40" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="150" y="210">(x+h)^100</text>

                        <text fill="#f39c12" font-size="60" text-anchor="middle" x="300" y="220">â†’</text>

                        <circle cx="450" cy="200" r="40" fill="none" stroke="#2ecc71" stroke-width="3">
                            <animate attributeName="r" dur="2s" values="40;50;40" repeatCount="indefinite" begin="0.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="450" y="210">å…¬å¼</text>

                        <text fill="#3498db" font-size="24" text-anchor="middle" x="300" y="350">éœ€è¦æ›´é«˜æ•ˆçš„å·¥å…·!</text>

                        <path d="M 100 400 Q 200 350 500 400" fill="none" stroke="url(#grad1)" stroke-width="4">
                            <animate attributeName="d" dur="3s"
                                values="M 100 400 Q 200 350 500 400;
                                        M 100 400 Q 200 420 500 400;
                                        M 100 400 Q 200 350 500 400"
                                repeatCount="indefinite"/>
                        </path>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬2é¡µ:å¹‚å‡½æ•°æ±‚å¯¼å…¬å¼ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>åŸºç¡€å…¬å¼ä¸€:å¹‚å‡½æ•°</h2>
                    <h3>æ ¸å¿ƒå…¬å¼</h3>
                    <div class="math-formula">
                        $$(x^n)' = nx^{n-1}$$
                    </div>
                    <p><strong>è®°å¿†æ–¹æ³•:</strong> æŒ‡æ•°å˜æˆç³»æ•°,æŒ‡æ•°å‡1</p>

                    <h3>ç‰¹æ®Šæƒ…å†µ</h3>
                    <ul style="margin-left: 30px;">
                        <li>å¸¸æ•°: $(C)' = 0$ (ä¸å˜çš„ä¸œè¥¿å¯¼æ•°ä¸º0)</li>
                        <li>$x$: $(x)' = 1$</li>
                        <li>$x^2$: $(x^2)' = 2x$</li>
                        <li>$x^3$: $(x^3)' = 3x^2$</li>
                        <li>$\frac{1}{x} = x^{-1}$: $(\frac{1}{x})' = -\frac{1}{x^2}$</li>
                    </ul>

                    <p style="margin-top: 20px;"><strong>æ¨å¹¿:</strong> å¯¹æ‰€æœ‰å®æ•° $n$ éƒ½æˆç«‹!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="28" text-anchor="middle" x="300" y="60">å¹‚å‡½æ•°æ±‚å¯¼è§„å¾‹</text>

                        <!-- åŠ¨ç”»æ¼”ç¤º x^3 çš„å¯¼æ•° -->
                        <g opacity="0">
                            <rect x="100" y="100" width="400" height="80" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="10"/>
                            <text fill="#ecf0f1" font-size="24" x="150" y="145">xÂ³ â†’ 3xÂ²</text>
                            <animate attributeName="opacity" dur="8s" values="0;1;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <g opacity="0">
                            <circle cx="200" cy="140" r="15" fill="#e74c3c"/>
                            <text fill="#fff" font-size="14" text-anchor="middle" x="200" y="145">3</text>
                            <text fill="#f39c12" font-size="16" x="220" y="145">æŒ‡æ•°ä¸‹æ¥</text>
                            <animate attributeName="opacity" dur="8s" values="0;0;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <g opacity="0">
                            <rect x="100" y="220" width="400" height="80" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="10"/>
                            <text fill="#ecf0f1" font-size="24" x="150" y="265">xâ´ â†’ 4xÂ³</text>
                            <animate attributeName="opacity" dur="8s" values="0;0;0;1;1" repeatCount="indefinite"/>
                        </g>

                        <g opacity="0">
                            <rect x="100" y="340" width="400" height="80" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="2" rx="10"/>
                            <text fill="#ecf0f1" font-size="24" x="150" y="385">1/x â†’ -1/xÂ²</text>
                            <animate attributeName="opacity" dur="8s" values="0;0;0;0;1" repeatCount="indefinite"/>
                        </g>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬3é¡µ:æŒ‡æ•°ä¸å¯¹æ•°å‡½æ•° -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>åŸºç¡€å…¬å¼äºŒ:æŒ‡æ•°ä¸å¯¹æ•°</h2>
                    <h3>æŒ‡æ•°å‡½æ•°</h3>
                    <div class="math-formula">
                        $$(e^x)' = e^x$$
                    </div>
                    <p><strong>æƒŠäººçš„æ€§è´¨:</strong> $e^x$ çš„å¯¼æ•°è¿˜æ˜¯è‡ªå·±!</p>
                    <div class="math-formula">
                        $$(a^x)' = a^x \ln a$$
                    </div>

                    <h3>å¯¹æ•°å‡½æ•°</h3>
                    <div class="math-formula">
                        $$(\ln x)' = \frac{1}{x}$$
                    </div>
                    <p><strong>å‡ ä½•æ„ä¹‰:</strong> $\ln x$ çš„åˆ‡çº¿æ–œç‡ = $\frac{1}{x}$</p>
                    <div class="math-formula">
                        $$(\log_a x)' = \frac{1}{x \ln a}$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <defs>
                            <linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#3498db;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#2ecc71;stop-opacity:1" />
                            </linearGradient>
                        </defs>

                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">e^x çš„ç¥å¥‡æ€§è´¨</text>

                        <!-- åæ ‡ç³» -->
                        <line x1="100" y1="350" x2="500" y2="350" stroke="#ecf0f1" stroke-width="2"/>
                        <line x1="150" y1="100" x2="150" y2="400" stroke="#ecf0f1" stroke-width="2"/>

                        <!-- e^x æ›²çº¿ -->
                        <path d="M 150 350 Q 250 250 350 150 Q 400 100 450 80"
                              fill="none" stroke="url(#grad2)" stroke-width="3">
                            <animate attributeName="opacity" dur="2s" values="0;1;1" repeatCount="indefinite"/>
                        </path>

                        <!-- æ ‡æ³¨ -->
                        <text fill="#3498db" font-size="18" x="380" y="120">y = e^x</text>
                        <text fill="#2ecc71" font-size="18" x="380" y="150">y' = e^x</text>

                        <circle cx="300" cy="200" r="8" fill="#e74c3c">
                            <animate attributeName="r" dur="2s" values="8;12;8" repeatCount="indefinite"/>
                        </circle>

                        <text fill="#f39c12" font-size="20" text-anchor="middle" x="300" y="450">å¯¼æ•° = åŸå‡½æ•°!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬4é¡µ:ä¸‰è§’å‡½æ•°æ±‚å¯¼ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>åŸºç¡€å…¬å¼ä¸‰:ä¸‰è§’å‡½æ•°</h2>
                    <h3>æ ¸å¿ƒå…¬å¼</h3>
                    <div class="math-formula">
                        $$(\sin x)' = \cos x$$
                    </div>
                    <div class="math-formula">
                        $$(\cos x)' = -\sin x$$
                    </div>
                    <p><strong>è®°å¿†æŠ€å·§:</strong> sin â†’ cos (æ­£å˜ä½™)</p>
                    <p style="margin-left: 30px;">cos â†’ -sin (ä½™å˜è´Ÿæ­£)</p>

                    <h3>å…¶ä»–ä¸‰è§’å‡½æ•°</h3>
                    <div class="math-formula">
                        $$(\tan x)' = \sec^2 x = \frac{1}{\cos^2 x}$$
                    </div>
                    <p style="color: #95a5a6; font-size: 16px;">æç¤º: tan = sin/cos,ç”¨é™¤æ³•æ³•åˆ™å¯æ¨å¯¼</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="50">ä¸‰è§’å‡½æ•°å¯¼æ•°å…³ç³»</text>

                        <!-- sin x å’Œ cos x çš„å…³ç³» -->
                        <circle cx="200" cy="200" r="70" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="200" y="205">sin x</text>

                        <line x1="270" y1="200" x2="330" y2="200" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow)"/>
                        <text fill="#f39c12" font-size="18" text-anchor="middle" x="300" y="180">æ±‚å¯¼</text>

                        <circle cx="400" cy="200" r="70" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="400" y="205">cos x</text>

                        <!-- cos x åˆ° -sin x -->
                        <line x1="400" y1="270" x2="400" y2="330" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow)"/>
                        <text fill="#f39c12" font-size="18" x="410" y="305">æ±‚å¯¼</text>

                        <circle cx="400" cy="400" r="70" fill="rgba(155,89,182,0.2)" stroke="#9b59b6" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="400" y="405">-sin x</text>

                        <!-- -sin x åˆ° -cos x -->
                        <line x1="330" y1="400" x2="270" y2="400" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow)"/>
                        <text fill="#f39c12" font-size="18" text-anchor="middle" x="300" y="420">æ±‚å¯¼</text>

                        <circle cx="200" cy="400" r="70" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="200" y="405">-cos x</text>

                        <!-- -cos x å›åˆ° sin x -->
                        <line x1="200" y1="330" x2="200" y2="270" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow)"/>
                        <text fill="#f39c12" font-size="18" x="210" y="305">æ±‚å¯¼</text>

                        <defs>
                            <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#f39c12"/>
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬5é¡µ:å››åˆ™è¿ç®—æ³•åˆ™ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>æ±‚å¯¼çš„å››åˆ™è¿ç®—æ³•åˆ™</h2>
                    <h3>1. çº¿æ€§æ€§è´¨(å’Œå·®æ³•åˆ™)</h3>
                    <div class="math-formula">
                        $$(af(x) \pm bg(x))' = af'(x) \pm bg'(x)$$
                    </div>
                    <p>å¸¸æ•°å¯ä»¥æå–,å’Œå·®åˆ†åˆ«æ±‚å¯¼</p>

                    <h3>2. ä¹˜æ³•æ³•åˆ™</h3>
                    <div class="math-formula">
                        $$(f \cdot g)' = f' \cdot g + f \cdot g'$$
                    </div>
                    <p><strong>å£è¯€:</strong> "å‰å¯¼åä¸å¯¼ + å‰ä¸å¯¼åå¯¼"</p>

                    <h3>3. é™¤æ³•æ³•åˆ™</h3>
                    <div class="math-formula">
                        $$\left(\frac{f}{g}\right)' = \frac{f' \cdot g - f \cdot g'}{g^2}$$
                    </div>
                    <p><strong>æ³¨æ„:</strong> åˆ†æ¯è¦å¹³æ–¹! åˆ†å­æ˜¯"ä¸Šå¯¼ä¸‹ - ä¸Šä¸‹å¯¼"</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="50">ä¹˜æ³•æ³•åˆ™å›¾è§£</text>

                        <!-- f å’Œ g -->
                        <rect x="100" y="100" width="150" height="60" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="24" text-anchor="middle" x="175" y="135">f</text>

                        <rect x="350" y="100" width="150" height="60" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="24" text-anchor="middle" x="425" y="135">g</text>

                        <text fill="#f39c12" font-size="30" text-anchor="middle" x="300" y="140">Ã—</text>

                        <!-- æ±‚å¯¼ç®­å¤´ -->
                        <line x1="175" y1="160" x2="175" y2="220" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow2)"/>
                        <line x1="425" y1="160" x2="425" y2="220" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow2)"/>

                        <!-- ç»“æœ -->
                        <rect x="75" y="240" width="200" height="70" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="175" y="280">f' Â· g</text>

                        <text fill="#f39c12" font-size="30" text-anchor="middle" x="300" y="280">+</text>

                        <rect x="325" y="240" width="200" height="70" fill="rgba(155,89,182,0.2)" stroke="#9b59b6" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="425" y="280">f Â· g'</text>

                        <!-- æœ€ç»ˆç»“æœ -->
                        <rect x="150" y="350" width="300" height="80" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="22" text-anchor="middle" x="300" y="395">(f Â· g)' = f'g + fg'</text>

                        <defs>
                            <marker id="arrow2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#f39c12"/>
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬6é¡µ:ç»¼åˆç»ƒä¹ 1 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>ç»¼åˆç»ƒä¹  1</h2>
                    <h3>ä¾‹é¢˜1: ä¹˜æ³•æ³•åˆ™</h3>
                    <p>æ±‚ $y = x^2 \cdot e^x$ çš„å¯¼æ•°</p>

                    <p style="margin-top: 15px;"><strong>è§£:</strong> ä½¿ç”¨ä¹˜æ³•æ³•åˆ™ $(fg)' = f'g + fg'$</p>
                    <p style="margin-left: 30px;">ä»¤ $f = x^2$, $g = e^x$</p>
                    <p style="margin-left: 30px;">åˆ™ $f' = 2x$, $g' = e^x$</p>

                    <div class="math-formula">
                        $$y' = 2x \cdot e^x + x^2 \cdot e^x = (2x + x^2)e^x$$
                    </div>

                    <h3 style="margin-top: 25px;">ä¾‹é¢˜2: é™¤æ³•æ³•åˆ™</h3>
                    <p>æ±‚ $y = \frac{\sin x}{x}$ çš„å¯¼æ•°</p>

                    <p style="margin-top: 15px;"><strong>è§£:</strong> ä½¿ç”¨é™¤æ³•æ³•åˆ™</p>
                    <div class="math-formula">
                        $$y' = \frac{\cos x \cdot x - \sin x \cdot 1}{x^2} = \frac{x\cos x - \sin x}{x^2}$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="50">ä¾‹é¢˜1 æ¼”ç®—è¿‡ç¨‹</text>

                        <!-- æ­¥éª¤å±•ç¤º -->
                        <g opacity="0">
                            <rect x="80" y="100" width="440" height="60" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="20" x="100" y="135">y = xÂ² Â· e^x</text>
                            <animate attributeName="opacity" dur="10s" values="0;1;1;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <g opacity="0">
                            <rect x="80" y="180" width="440" height="60" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="20" x="100" y="215">f' Â· g = 2x Â· e^x</text>
                            <animate attributeName="opacity" dur="10s" values="0;0;1;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <text fill="#f39c12" font-size="30" text-anchor="middle" x="300" y="275" opacity="0">
                            +
                            <animate attributeName="opacity" dur="10s" values="0;0;0;1;1;1" repeatCount="indefinite"/>
                        </text>

                        <g opacity="0">
                            <rect x="80" y="290" width="440" height="60" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="20" x="100" y="325">f Â· g' = xÂ² Â· e^x</text>
                            <animate attributeName="opacity" dur="10s" values="0;0;0;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <line x1="100" y1="370" x2="500" y2="370" stroke="#f39c12" stroke-width="2" opacity="0">
                            <animate attributeName="opacity" dur="10s" values="0;0;0;0;1;1" repeatCount="indefinite"/>
                        </line>

                        <g opacity="0">
                            <rect x="80" y="390" width="440" height="70" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="3" rx="8"/>
                            <text fill="#ecf0f1" font-size="22" text-anchor="middle" x="300" y="435">y' = (2x + xÂ²)e^x</text>
                            <animate attributeName="opacity" dur="10s" values="0;0;0;0;0;1" repeatCount="indefinite"/>
                        </g>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬7é¡µ:ç»¼åˆç»ƒä¹ 2 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>ç»¼åˆç»ƒä¹  2</h2>
                    <h3>ä¾‹é¢˜3: ç»¼åˆåº”ç”¨</h3>
                    <p>æ±‚ $y = \frac{\ln x}{x^2}$ çš„å¯¼æ•°</p>

                    <p style="margin-top: 15px;"><strong>è§£:</strong> ä½¿ç”¨é™¤æ³•æ³•åˆ™</p>
                    <p style="margin-left: 30px;">$f = \ln x$, $f' = \frac{1}{x}$</p>
                    <p style="margin-left: 30px;">$g = x^2$, $g' = 2x$</p>

                    <div class="math-formula">
                        $$y' = \frac{\frac{1}{x} \cdot x^2 - \ln x \cdot 2x}{(x^2)^2} = \frac{x - 2x\ln x}{x^4}$$
                    </div>

                    <div class="math-formula">
                        $$= \frac{1 - 2\ln x}{x^3}$$
                    </div>

                    <p style="margin-top: 20px; color: #95a5a6;"><strong>æŠ€å·§:</strong> åŒ–ç®€æ—¶çº¦æ‰å…¬å› å­ $x$</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="50">é™¤æ³•æ³•åˆ™è®°å¿†</text>

                        <rect x="150" y="100" width="300" height="80" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="24" text-anchor="middle" x="300" y="150">
                            <tspan x="300">f</tspan>
                            <tspan dy="-10" font-size="18">â”€</tspan>
                        </text>
                        <text fill="#ecf0f1" font-size="24" text-anchor="middle" x="300" y="170">g</text>

                        <line x1="300" y1="180" x2="300" y2="240" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow3)"/>
                        <text fill="#f39c12" font-size="18" x="310" y="215">æ±‚å¯¼</text>

                        <rect x="100" y="260" width="400" height="150" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="300">
                            <tspan x="300">f'g - fg'</tspan>
                            <tspan dy="-8" font-size="18">â”€â”€â”€â”€â”€</tspan>
                        </text>
                        <text fill="#ecf0f1" font-size="24" text-anchor="middle" x="300" y="330">gÂ²</text>

                        <text fill="#e74c3c" font-size="18" x="120" y="370">â†‘</text>
                        <text fill="#e74c3c" font-size="16" x="135" y="370">ä¸Šå¯¼ä¸‹</text>

                        <text fill="#e74c3c" font-size="18" x="220" y="370">-</text>

                        <text fill="#e74c3c" font-size="18" x="250" y="370">â†‘</text>
                        <text fill="#e74c3c" font-size="16" x="265" y="370">ä¸Šä¸‹å¯¼</text>

                        <text fill="#f39c12" font-size="18" text-anchor="middle" x="300" y="395">åˆ†æ¯å¹³æ–¹!</text>

                        <defs>
                            <marker id="arrow3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#f39c12"/>
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬8é¡µ:æ€»ç»“ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>æœ¬èŠ‚æ€»ç»“</h2>
                    <h3>åŸºæœ¬å…¬å¼(å¿…é¡»è®°ä½!)</h3>
                    <ul style="margin-left: 30px;">
                        <li>$(x^n)' = nx^{n-1}$</li>
                        <li>$(e^x)' = e^x$, $(a^x)' = a^x \ln a$</li>
                        <li>$(\ln x)' = \frac{1}{x}$</li>
                        <li>$(\sin x)' = \cos x$, $(\cos x)' = -\sin x$</li>
                    </ul>

                    <h3 style="margin-top: 20px;">å››åˆ™è¿ç®—æ³•åˆ™</h3>
                    <ul style="margin-left: 30px;">
                        <li>$(af \pm bg)' = af' \pm bg'$ (çº¿æ€§)</li>
                        <li>$(fg)' = f'g + fg'$ (ä¹˜æ³•)</li>
                        <li>$(\frac{f}{g})' = \frac{f'g - fg'}{g^2}$ (é™¤æ³•)</li>
                    </ul>

                    <p style="margin-top: 25px; color: #f39c12;"><strong>ä¸‹èŠ‚é¢„å‘Š:</strong></p>
                    <p>é“¾å¼æ³•åˆ™ â€” å¤åˆå‡½æ•°æ±‚å¯¼çš„åˆ©å™¨!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="32" text-anchor="middle" x="300" y="80">å…¬å¼å…¨å®¶ç¦</text>

                        <circle cx="150" cy="200" r="60" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="150" y="205">å¹‚å‡½æ•°</text>

                        <circle cx="450" cy="200" r="60" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="0.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="450" y="205">æŒ‡å¯¹æ•°</text>

                        <circle cx="150" cy="380" r="60" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="1s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="150" y="385">ä¸‰è§’</text>

                        <circle cx="450" cy="380" r="60" fill="rgba(155,89,182,0.2)" stroke="#9b59b6" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="1.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="450" y="385">å››åˆ™</text>

                        <circle cx="300" cy="290" r="80" fill="rgba(241,196,15,0.3)" stroke="#f39c12" stroke-width="4">
                            <animate attributeName="r" dur="3s" values="80;90;80" repeatCount="indefinite" begin="2s"/>
                        </circle>
                        <text fill="#f1c40f" font-size="22" text-anchor="middle" x="300" y="295">å¯¼æ•°</text>
                        <text fill="#f1c40f" font-size="22" text-anchor="middle" x="300" y="320">å·¥å…·ç®±</text>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <div class="subtitle-area" id="subtitleArea">
        æ¬¢è¿å­¦ä¹ åŸºæœ¬æ±‚å¯¼å…¬å¼ä¸å››åˆ™è¿ç®—!ç‚¹å‡»å¼€å§‹è®²è¯¾å¯åŠ¨è™šæ‹Ÿäººè®²å¸ˆã€‚
    </div>

    <div class="control-bar">
        <div style="color: #f1c40f; font-weight: bold; margin-bottom: 15px; text-align: center;">
            ç¬¬ <span id="currentSlide">1</span> / <span id="totalSlides">8</span> é¡µ
        </div>
        <button class="btn" id="prevBtn" onclick="previousSlide()">â¬…ï¸ ä¸Šä¸€é¡µ</button>
        <button class="btn primary" id="startBtn" onclick="startTeaching()">ğŸ€ å¼€å§‹è®²è¯¾</button>
        <button class="btn" id="nextBtn" onclick="nextSlide()">ä¸‹ä¸€é¡µ â¡ï¸</button>
        <button class="btn" onclick="restart()">ğŸ”„ é‡æ–°å¼€å§‹</button>
        <button class="btn" id="autoPlayBtn" onclick="startAutoPlay()">ğŸ¬ è‡ªåŠ¨æ’­æ”¾</button>
    </div>

    <script type="module">
        window.playbackFinished = false;

        try {
            const { default: AvatarPlatform, SDKEvents, PlayerEvents, RecorderEvents, UserMedia } = await import('./avatar-sdk-web_3.1.2.1002/index.js');
            window.AvatarPlatform = AvatarPlatform;
            window.SDKEvents = SDKEvents;
            window.PlayerEvents = PlayerEvents;
            window.RecorderEvents = RecorderEvents;
            window.UserMedia = UserMedia;
            console.log('âœ… è®¯é£SDKæ¨¡å—å·²åŠ è½½');
        } catch (error) {
            console.error('âŒ SDKåŠ è½½å¤±è´¥:', error);
        }
        window.dispatchEvent(new CustomEvent('sdkReady'));
    </script>

    <script>
        const lessonTitle = "åŸºæœ¬æ±‚å¯¼å…¬å¼ä¸å››åˆ™è¿ç®—";

        const subtitleScript = {
            "1": "ä¸ŠèŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ äº†å¯¼æ•°çš„å®šä¹‰,ä½†æ¯æ¬¡ç”¨å®šä¹‰æ±‚å¯¼å¤ªå¤æ‚äº†ã€‚ä»Šå¤©æˆ‘ä»¬å­¦ä¹ é«˜æ•ˆçš„æ±‚å¯¼å…¬å¼,å°±åƒæ‹¥æœ‰äº†ä¸€ä¸ªå¯¼æ•°è®¡ç®—å™¨!",
            "2": "å¹‚å‡½æ•°æ±‚å¯¼æœ‰ä¸€ä¸ªç®€å•çš„è§„å¾‹:æŒ‡æ•°å˜æˆç³»æ•°,æŒ‡æ•°å‡ä¸€ã€‚æ¯”å¦‚xçš„ä¸‰æ¬¡æ–¹,å¯¼æ•°å°±æ˜¯3xçš„å¹³æ–¹ã€‚è¿™ä¸ªå…¬å¼å¯¹æ‰€æœ‰å®æ•°æŒ‡æ•°éƒ½æˆç«‹,åŒ…æ‹¬è´Ÿæ•°å’Œåˆ†æ•°!",
            "3": "æŒ‡æ•°å‡½æ•°ä¸­,eçš„xæ¬¡æ–¹éå¸¸ç‰¹æ®Š,å®ƒçš„å¯¼æ•°è¿˜æ˜¯å®ƒè‡ªå·±!è¿™å°±æ˜¯ä¸ºä»€ä¹ˆeåœ¨æ•°å­¦ä¸­å¦‚æ­¤é‡è¦ã€‚å¯¹æ•°å‡½æ•°ln xçš„å¯¼æ•°æ˜¯1/x,ä»å›¾åƒä¸Šçœ‹,å°±æ˜¯åˆ‡çº¿æ–œç‡ç­‰äº1é™¤ä»¥xã€‚",
            "4": "ä¸‰è§’å‡½æ•°çš„å¯¼æ•°æœ‰ä¸€å®šè§„å¾‹ã€‚sin xæ±‚å¯¼å˜æˆcos x,cos xæ±‚å¯¼å˜æˆè´Ÿçš„sin xã€‚è®°ä½è¿™ä¸ªè§„å¾‹:æ­£å¼¦å˜ä½™å¼¦,ä½™å¼¦å˜è´Ÿçš„æ­£å¼¦ã€‚å¦‚æœå†æ±‚ä¸€æ¬¡å¯¼,åˆå›åˆ°åŸæ¥çš„å‡½æ•°äº†!",
            "5": "å››åˆ™è¿ç®—æ³•åˆ™å¸®åŠ©æˆ‘ä»¬å¤„ç†å¤æ‚å‡½æ•°ã€‚ä¹˜æ³•æ³•åˆ™çš„å£è¯€æ˜¯:å‰å¯¼åä¸å¯¼,åŠ ä¸Šå‰ä¸å¯¼åå¯¼ã€‚é™¤æ³•æ³•åˆ™è¦è®°ä½:åˆ†å­æ˜¯ä¸Šå¯¼ä¸‹å‡ä¸Šä¸‹å¯¼,åˆ†æ¯æ˜¯gçš„å¹³æ–¹ã€‚åˆ†æ¯ä¸€å®šè¦å¹³æ–¹!",
            "6": "è®©æˆ‘ä»¬çœ‹ä¸¤é“ç»¼åˆç»ƒä¹ ã€‚ç¬¬ä¸€é¢˜ç”¨ä¹˜æ³•æ³•åˆ™,xå¹³æ–¹ä¹˜ä»¥eçš„xæ¬¡æ–¹,ç»“æœæ˜¯2xåŠ xå¹³æ–¹,ç„¶åä¹˜ä»¥eçš„xæ¬¡æ–¹ã€‚ç¬¬äºŒé¢˜ç”¨é™¤æ³•æ³•åˆ™,æ³¨æ„åˆ†æ¯è¦å¹³æ–¹,æœ€åè¦åŒ–ç®€ã€‚",
            "7": "å†çœ‹ä¸€é“é™¤æ³•æ³•åˆ™çš„ä¾‹é¢˜ã€‚ln xé™¤ä»¥xå¹³æ–¹,ç”¨é™¤æ³•æ³•åˆ™è®¡ç®—ã€‚æ³¨æ„åŒ–ç®€æŠ€å·§:çº¦æ‰å…¬å› å­x,æœ€ç»ˆç­”æ¡ˆæ˜¯1å‡2å€ln x,å…¨éƒ¨é™¤ä»¥xçš„ä¸‰æ¬¡æ–¹ã€‚åšé¢˜æ—¶ä¸€å®šè¦ç»†å¿ƒ,æ£€æŸ¥ç¬¦å·å’Œåˆ†æ¯!",
            "8": "ä»Šå¤©æˆ‘ä»¬å­¦ä¹ äº†åŸºæœ¬æ±‚å¯¼å…¬å¼å’Œå››åˆ™è¿ç®—æ³•åˆ™ã€‚å¹‚å‡½æ•°ã€æŒ‡å¯¹æ•°ã€ä¸‰è§’å‡½æ•°çš„å…¬å¼ä¸€å®šè¦è®°ç‰¢!å››åˆ™æ³•åˆ™æ˜¯å·¥å…·,ç†Ÿç»ƒæŒæ¡å,æ±‚å¯¼å°±åƒåšç®—æœ¯ä¸€æ ·ç®€å•ã€‚ä¸‹èŠ‚è¯¾æˆ‘ä»¬å­¦ä¹ é“¾å¼æ³•åˆ™,é‚£æ˜¯å¤„ç†å¤åˆå‡½æ•°çš„åˆ©å™¨!"
        };

        const actionMap = {
            "1": "A_RLH_welcome_O",
            "2": "A_RH_point_O",
            "3": "A_LH_introduced_O",
            "4": "A_RH_point_O",
            "5": "A_LH_introduced_O",
            "6": "A_RH_point_O",
            "7": "A_RH_point_O",
            "8": "A_RLH_welcome_O"
        };

        let currentSlide = 0;
        const totalSlides = 8;
        let avatarPlatform = null;
        let isConnected = false;
        let isTeaching = false;
        let isAutoPlaying = false;

        const slides = document.querySelectorAll('.slide');

        function showSlide(index) {
            slides.forEach((slide, i) => slide.classList.toggle('active', i === index));
            currentSlide = index;
            document.getElementById('currentSlide').textContent = index + 1;

            if (window.MathJax && window.MathJax.typesetPromise) {
                window.MathJax.typesetPromise([slides[index]]).catch(err => console.error(err));
            }

            document.getElementById('prevBtn').disabled = index === 0;
            document.getElementById('nextBtn').disabled = index === totalSlides - 1;
            updateSubtitle(index + 1);
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                showSlide(currentSlide + 1);
                if (!isAutoPlaying) speakContent(currentSlide + 1);
            }
        }

        function previousSlide() {
            if (currentSlide > 0) {
                showSlide(currentSlide - 1);
                if (!isAutoPlaying) speakContent(currentSlide + 1);
            }
        }

        function restart() {
            showSlide(0);
            if (avatarPlatform) {
                avatarPlatform.stop();
            }
            isConnected = false;
            isTeaching = false;
            isAutoPlaying = false;
        }

        function updateSubtitle(slideNum) {
            const subtitleArea = document.getElementById('subtitleArea');
            subtitleArea.textContent = subtitleScript[slideNum] || '';
        }

        async function speakContent(slideNum) {
            if (!isTeaching || !isConnected || !avatarPlatform) {
                console.log('âš ï¸ è™šæ‹Ÿäººæœªè¿æ¥');
                return;
            }

            const content = subtitleScript[slideNum];
            if (!content) return;

            try {
                const action = actionMap[slideNum];
                if (action) {
                    await avatarPlatform.writeCmd("action", action);
                }

                await avatarPlatform.writeText(content, { nlp: false });
                updateSubtitle(slideNum);
            } catch (error) {
                console.error('âŒ è®²è§£å¤±è´¥:', error);
            }
        }

        function updateStatus(message, type = 'normal') {
            const indicator = document.getElementById('statusIndicator');
            if (indicator) {
                indicator.textContent = message;
                indicator.className = 'status-indicator';
                if (type === 'connected') indicator.classList.add('connected');
                else if (type === 'error') indicator.classList.add('error');
                else if (type === 'connecting') indicator.classList.add('connecting');
            }
        }

        function waitForSDK() {
            return new Promise((resolve, reject) => {
                if (typeof AvatarPlatform !== 'undefined') {
                    resolve();
                    return;
                }

                const timeout = setTimeout(() => {
                    reject(new Error('SDKåŠ è½½è¶…æ—¶'));
                }, 10000);

                window.addEventListener('sdkReady', function handler() {
                    clearTimeout(timeout);
                    window.removeEventListener('sdkReady', handler);
                    resolve();
                });
            });
        }

        async function startTeaching() {
            const startBtn = document.getElementById('startBtn');
            startBtn.textContent = 'ğŸ”„ å¯åŠ¨ä¸­...';
            startBtn.disabled = true;

            try {
                updateStatus('ç­‰å¾…SDK...', 'connecting');
                await waitForSDK();

                if(avatarPlatform) {
                    avatarPlatform.destroy();
                }

                avatarPlatform = new AvatarPlatform({ useInlinePlayer: true });

                avatarPlatform
                    .on('connected', (initResp) => {
                        console.log('ğŸ‰ è¿æ¥æˆåŠŸ');
                        isConnected = true;
                        isTeaching = true;
                        updateStatus('å·²è¿æ¥', 'connected');
                        startBtn.textContent = 'ğŸ’– è™šæ‹Ÿäººå·²å°±ç»ª';

                        setTimeout(() => {
                            speakContent(currentSlide + 1);
                        }, 1000);
                    })
                    .on('disconnected', (err) => {
                        isConnected = false;
                        updateStatus('è¿æ¥æ–­å¼€', 'error');
                    })
                    .on('error', (error) => {
                        console.error('âŒ é”™è¯¯:', error);
                        updateStatus('é”™è¯¯', 'error');
                        startBtn.textContent = 'âŒ è¿æ¥å¤±è´¥';
                        startBtn.disabled = false;
                        isTeaching = false;
                    });

                avatarPlatform.setApiInfo({
                    appId: 'e8c180ed',
                    apiKey: 'e0c44f0e2ef0f47582ffa7e864da0d9b',
                    apiSecret: 'MDZkNDNiZWU4NDkzNWM5MDQzMTY4N2Nh',
                    sceneId: '237415046114840576',
                    serverUrl: 'wss://avatar.cn-huadong-1.xf-yun.com/v1/interact'
                });

                avatarPlatform.setGlobalParams({
                    stream: { protocol: 'xrtc', alpha: 1, bitrate: 1000000, fps: 25 },
                    avatar: { avatar_id: '110332017', width: 1920, height: 1080, scale: 1, move_h: 0, move_v: 0, audio_format: 1 },
                    tts: { vcn: 'x4_yiting', speed: 50, pitch: 50, volume: 100 },
                    avatar_dispatch: { interactive_mode: 1, content_analysis: 0 }
                });

                await avatarPlatform.start({ wrapper: document.getElementById('avatarWrapper') });
            } catch (error) {
                console.error('âŒ å¯åŠ¨å¤±è´¥:', error);
                updateStatus('å¯åŠ¨å¤±è´¥', 'error');
                startBtn.textContent = 'ğŸ€ å¼€å§‹è®²è¯¾';
                startBtn.disabled = false;
            }
        }

        async function startAutoPlay() {
            if (!avatarPlatform || !isConnected) {
                await startTeaching();
                await new Promise(resolve => setTimeout(resolve, 2000));
            }

            isAutoPlaying = true;
            document.getElementById('autoPlayBtn').disabled = true;

            for (let i = currentSlide; i < totalSlides; i++) {
                showSlide(i);
                await speakContent(i + 1);

                const duration = (subtitleScript[i + 1].length / 4) * 1000 + 3000;
                await new Promise(resolve => setTimeout(resolve, duration));
            }

            isAutoPlaying = false;
            document.getElementById('autoPlayBtn').disabled = false;
            window.playbackFinished = true;
            document.title = "PLAYBACK_FINISHED";
            console.log('ğŸ‰ æ’­æ”¾å®Œæˆ');
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextSlide();
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                previousSlide();
            } else if (e.key === 'Enter') {
                e.preventDefault();
                speakContent(currentSlide + 1);
            }
        });

        document.getElementById('totalSlides').textContent = totalSlides;
        showSlide(0);

        setTimeout(() => {
            console.log('ğŸš€ è‡ªåŠ¨å¯åŠ¨æ’­æ”¾...');
            startAutoPlay();
        }, 3000);
    </script>
</body>
</html>
