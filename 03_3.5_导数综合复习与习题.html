<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1920, initial-scale=1.0">
    <title>03_3.5_导数综合复习与习题</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']], processEscapes: true, processEnvironments: true },
            svg: { fontCache: 'global' },
            startup: { pageReady: () => { return MathJax.startup.defaultPageReady().then(() => { console.log('✅ MathJax已加载'); }); } }
        };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; margin: 0; padding: 0; }
        body { font-family: 'Noto Serif SC', serif; background: #1a1a2e; overflow: hidden; height: 100vh; width: 100vw; }
        .blackboard { width: 100vw; height: 100vh; background: #1a1a2e; position: relative; border: 10px solid #795548; margin: 0; }
        .avatar-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(1.5);
            width: 600px;
            height: 1400px;
            overflow: hidden;
            z-index: 10;
            pointer-events: none;
            background: transparent;
        }        .wrapper { width: 100%; height: 100%; background: transparent; pointer-events: auto; }
        .slide-container { width: 100%; height: 100%; position: relative; }
        .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; visibility: hidden; transition: opacity 0.6s ease-in-out; display: flex; justify-content: center; align-items: center; padding: 2rem; background-color: transparent; }
        .slide.active { opacity: 1; visibility: visible; }
        .slide-content { display: flex; flex-direction: row; gap: 2rem; width: 100%; height: 95%; }
        .chalkboard { flex: 0 0 45%; padding: 20px; display: flex; flex-direction: column; justify-content: center; overflow-y: auto; }
        .chalkboard h2 { color: #f1c40f; border-bottom: 2px solid #f39c12; font-size: 28px; padding-bottom: 10px; margin-bottom: 20px; }
        .chalkboard h3 { color: #1abc9c; font-size: 22px; margin-top: 20px; margin-bottom: 10px; }
        .chalkboard p, .chalkboard li { color: #e0e0e0; font-size: 18px; line-height: 1.8; margin: 8px 0; }
        .chalkboard strong { color: #e74c3c; }
        .math-formula { background-color: rgba(0,0,0,0.2); padding: 15px; border-radius: 5px; border-left: 4px solid #f39c12; font-size: 20px; color: #1abc9c; text-align: center; margin: 15px 0; }
        .visualization { flex: 1; padding: 20px; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .control-bar { position: fixed; left: -9999px; top: 50%; transform: translateY(-50%); width: 270px; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(15px); display: flex; flex-direction: column; gap: 12px; z-index: 200; border-radius: 0 20px 20px 0; padding: 25px 20px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2); border: 1px solid rgba(255, 255, 255, 0.2); }
        .btn { padding: 14px 22px; background: rgba(255, 255, 255, 0.25); color: #333; border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 12px; cursor: pointer; font-size: 14px; font-weight: 600; width: 100%; text-align: center; }
        .btn.primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; }
        .subtitle-area { position: absolute; bottom: 20px; left: 50px; right: 50px; min-height: 50px; background: rgba(0,0,0,0.8); border-radius: 8px; display: flex; align-items: center; justify-content: center; z-index: 60; color: white; font-size: 23px; text-align: center; padding: 15px 20px; line-height: 1.4; }
        .status-indicator { position: absolute; top: 10px; right: 10px; padding: 5px 10px; background: rgba(0,0,0,0.5); color: white; border-radius: 5px; font-size: 16px; z-index: 100; display: none; }
        .status-indicator.connected { background: rgba(76, 175, 80, 0.8); display: block; }
        .status-indicator.error { background: rgba(244, 67, 54, 0.8); display: block; }
        .status-indicator.connecting { background: rgba(255, 152, 0, 0.8); display: block; }
    </style>
</head>
<body class="blackboard">
    <div class="status-indicator" id="statusIndicator">等待连接</div>
    <div class="avatar-container"><div class="wrapper" id="avatarWrapper"></div></div>
    <div class="slide-container">
        <!-- 第1页:课程引入 -->
        <div class="slide active">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>导数综合复习</h2>
                    <p>同学们好!</p>
                    <p>前面几节课我们系统学习了</p>
                    <p><strong>第3章导数</strong>的全部内容</p>

                    <h3>今天的任务</h3>
                    <ul style="margin-left: 30px;">
                        <li>系统复习知识点</li>
                        <li>梳理知识结构</li>
                        <li>综合练习提升</li>
                    </ul>

                    <p style="margin-top: 20px;">让我们把零散的知识点</p>
                    <p>串联成<strong>完整的知识体系</strong>!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="32" text-anchor="middle" x="300" y="80">第3章 导数</text>
                        
                        <circle cx="300" cy="250" r="100" fill="rgba(241,196,15,0.3)" stroke="#f39c12" stroke-width="4">
                            <animate attributeName="r" dur="3s" values="100;110;100" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#f1c40f" font-size="28" text-anchor="middle" x="300" y="260">综合复习</text>

                        <text fill="#2ecc71" font-size="22" text-anchor="middle" x="300" y="420">系统梳理 · 融会贯通</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第2页:知识结构总览 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>第3章知识结构</h2>
                    
                    <h3>四大核心模块</h3>
                    <ul style="margin-left: 30px;">
                        <li><strong>3.1</strong> 导数的概念与几何意义</li>
                        <li><strong>3.2</strong> 基本求导公式与四则运算</li>
                        <li><strong>3.3</strong> 复合函数求导与链式法则</li>
                        <li><strong>3.4</strong> 微分的概念与应用</li>
                    </ul>

                    <p style="margin-top: 25px;"><strong>核心思想:</strong></p>
                    <p>导数 = <strong>瞬时变化率</strong></p>
                    <p>几何意义 = <strong>切线斜率</strong></p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="28" text-anchor="middle" x="300" y="60">知识体系</text>

                        <circle cx="300" cy="250" r="80" fill="rgba(241,196,15,0.3)" stroke="#f39c12" stroke-width="4">
                            <animate attributeName="r" dur="3s" values="80;90;80" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#f1c40f" font-size="24" text-anchor="middle" x="300" y="255">导数</text>

                        <circle cx="150" cy="150" r="60" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="0.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="150" y="155">概念 3.1</text>
                        <line x1="210" y1="190" x2="260" y2="220" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="450" cy="150" r="60" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="1s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="450" y="155">公式 3.2</text>
                        <line x1="390" y1="190" x2="340" y2="220" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="150" cy="380" r="60" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="1.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="150" y="385">链式 3.3</text>
                        <line x1="210" y1="340" x2="260" y2="300" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="450" cy="380" r="60" fill="rgba(155,89,182,0.2)" stroke="#9b59b6" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="2s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="450" y="385">微分 3.4</text>
                        <line x1="390" y1="340" x2="340" y2="300" stroke="#f39c12" stroke-width="2"/>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第3页:幂函数与常数求导 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>基本公式(一):幂函数</h2>
                    
                    <h3>幂函数求导公式</h3>
                    <div class="math-formula">
                        $$(x^n)' = nx^{n-1}$$
                    </div>
                    <p>指数降一次,系数变成原指数</p>

                    <h3>常数求导</h3>
                    <div class="math-formula">
                        $$(C)' = 0$$
                    </div>
                    <p>常数的导数永远是0</p>

                    <h3>典型例子</h3>
                    <p>$(x^3)' = 3x^2$</p>
                    <p>$(x^{-2})' = -2x^{-3}$</p>
                    <p>$(\sqrt{x})' = (x^{1/2})' = \frac{1}{2}x^{-1/2}$</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">幂函数求导</text>

                        <rect x="100" y="120" width="400" height="80" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="22" text-anchor="middle" x="300" y="170">(x^n)' = nx^(n-1)</text>

                        <g opacity="0">
                            <rect x="100" y="230" width="400" height="60" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="268">(x³)' = 3x²</text>
                            <animate attributeName="opacity" dur="6s" values="0;1;1" repeatCount="indefinite"/>
                        </g>

                        <g opacity="0">
                            <rect x="100" y="310" width="400" height="60" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="348">(√x)' = 1/(2√x)</text>
                            <animate attributeName="opacity" dur="6s" values="0;0;1" repeatCount="indefinite"/>
                        </g>

                        <text fill="#f39c12" font-size="20" text-anchor="middle" x="300" y="430">必须熟记!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第4页:指数函数求导 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>基本公式(二):指数函数</h2>
                    
                    <h3>自然指数函数</h3>
                    <div class="math-formula">
                        $$(e^x)' = e^x$$
                    </div>
                    <p>e的x次方求导还是它自己!</p>
                    <p>这是e的<strong>特殊性质</strong></p>

                    <h3>一般指数函数</h3>
                    <div class="math-formula">
                        $$(a^x)' = a^x \\ln a$$
                    </div>
                    <p>要乘以ln a</p>

                    <h3>例子</h3>
                    <p>$(2^x)' = 2^x \\ln 2$</p>
                    <p>$(10^x)' = 10^x \\ln 10$</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">指数函数求导</text>

                        <rect x="100" y="130" width="400" height="90" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="165">(e^x)' = e^x</text>
                        <text fill="#3498db" font-size="16" text-anchor="middle" x="300" y="200">自然指数的特殊性</text>

                        <rect x="100" y="250" width="400" height="90" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="285">(a^x)' = a^x · ln a</text>
                        <text fill="#2ecc71" font-size="16" text-anchor="middle" x="300" y="320">一般指数函数</text>

                        <circle cx="300" cy="400" r="50" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="3">
                            <animate attributeName="r" dur="2s" values="50;60;50" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#f1c40f" font-size="18" text-anchor="middle" x="300" y="408">记住!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第5页:对数函数求导 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>基本公式(三):对数函数</h2>
                    
                    <h3>自然对数</h3>
                    <div class="math-formula">
                        $$(\\ln x)' = \\frac{1}{x}$$
                    </div>
                    <p>ln x的导数是1/x</p>

                    <h3>一般对数</h3>
                    <div class="math-formula">
                        $$(\\log_a x)' = \\frac{1}{x \\ln a}$$
                    </div>
                    <p>要除以ln a</p>

                    <h3>注意</h3>
                    <p><strong>易错点:</strong></p>
                    <p>$(\\log_2 x)' = \\frac{1}{x \\ln 2}$ ✓</p>
                    <p>不是 $\\frac{1}{x}$ ❌</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">对数函数求导</text>

                        <rect x="100" y="130" width="400" height="90" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="165">(ln x)' = 1/x</text>
                        <text fill="#2ecc71" font-size="16" text-anchor="middle" x="300" y="200">自然对数</text>

                        <rect x="100" y="250" width="400" height="90" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="285">(log_a x)' = 1/(x·ln a)</text>
                        <text fill="#9b59b6" font-size="16" text-anchor="middle" x="300" y="320">一般对数</text>

                        <rect x="100" y="370" width="400" height="60" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                        <text fill="#e74c3c" font-size="16" text-anchor="middle" x="300" y="408">非e底要除以ln a!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第6页:三角函数求导 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>基本公式(四):三角函数</h2>
                    
                    <h3>正弦与余弦</h3>
                    <div class="math-formula">
                        $$(\\sin x)' = \\cos x$$
                    </div>
                    <div class="math-formula">
                        $$(\\cos x)' = -\\sin x$$
                    </div>
                    <p>注意余弦求导有<strong>负号</strong>!</p>

                    <h3>正切函数</h3>
                    <div class="math-formula">
                        $$(\\tan x)' = \\sec^2 x = \\frac{1}{\\cos^2 x}$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">三角函数求导</text>

                        <rect x="100" y="120" width="400" height="70" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="163">(sin x)' = cos x</text>

                        <rect x="100" y="210" width="400" height="70" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="253">(cos x)' = -sin x</text>

                        <rect x="100" y="300" width="400" height="70" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="343">(tan x)' = sec²x</text>

                        <text fill="#e74c3c" font-size="20" text-anchor="middle" x="300" y="420">余弦求导有负号!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第7页:线性法则 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>运算法则(一):线性法则</h2>
                    
                    <h3>和差法则</h3>
                    <div class="math-formula">
                        $$(af \\pm bg)' = af' \\pm bg'$$
                    </div>

                    <h3>两个要点</h3>
                    <p>1. <strong>常数可以提出</strong></p>
                    <p>2. <strong>和差分别求导</strong></p>

                    <h3>例子</h3>
                    <p>$(3x^2 + 5x)' = 3(x^2)' + 5(x)'$</p>
                    <p>$= 3 \\cdot 2x + 5 \\cdot 1 = 6x + 5$</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">线性法则</text>

                        <rect x="100" y="140" width="400" height="100" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="22" text-anchor="middle" x="300" y="180">(af ± bg)'</text>
                        <text fill="#e74c3c" font-size="20" text-anchor="middle" x="300" y="220">= af' ± bg'</text>

                        <circle cx="200" cy="330" r="60" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="200" y="335">常数提出</text>

                        <circle cx="400" cy="330" r="60" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="400" y="335">和差分开</text>

                        <text fill="#f39c12" font-size="18" text-anchor="middle" x="300" y="440">最简单的法则!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第8页:乘法法则 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>运算法则(二):乘法法则</h2>
                    
                    <h3>乘法求导公式</h3>
                    <div class="math-formula">
                        $$(fg)' = f'g + fg'$$
                    </div>

                    <h3>记忆口诀</h3>
                    <p><strong>前导后不导</strong></p>
                    <p>+</p>
                    <p><strong>前不导后导</strong></p>

                    <h3>注意</h3>
                    <p>是<strong>两项相加</strong>,不要漏项!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">乘法法则</text>

                        <rect x="100" y="130" width="400" height="90" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="22" text-anchor="middle" x="300" y="165">(fg)' = f'g + fg'</text>
                        <text fill="#3498db" font-size="16" text-anchor="middle" x="300" y="200">两项相加</text>

                        <rect x="100" y="250" width="180" height="120" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="190" y="290">第一项</text>
                        <text fill="#e74c3c" font-size="16" text-anchor="middle" x="190" y="320">f'g</text>
                        <text fill="#95a5a6" font-size="14" text-anchor="middle" x="190" y="350">前导后不导</text>

                        <rect x="320" y="250" width="180" height="120" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="410" y="290">第二项</text>
                        <text fill="#2ecc71" font-size="16" text-anchor="middle" x="410" y="320">fg'</text>
                        <text fill="#95a5a6" font-size="14" text-anchor="middle" x="410" y="350">前不导后导</text>

                        <text fill="#f39c12" font-size="20" text-anchor="middle" x="300" y="430">记住口诀!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第9页:除法法则 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>运算法则(三):除法法则</h2>
                    
                    <h3>除法求导公式</h3>
                    <div class="math-formula">
                        $$\\left(\\frac{f}{g}\\right)' = \\frac{f'g - fg'}{g^2}$$
                    </div>

                    <h3>记忆口诀</h3>
                    <p><strong>上导下 - 上下导</strong></p>
                    <p><strong>除以下平方</strong></p>

                    <h3>两个易错点</h3>
                    <p>1. 是<strong>减号</strong>,不是加号!</p>
                    <p>2. 分母要<strong>平方</strong>!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">除法法则</text>

                        <rect x="100" y="130" width="400" height="100" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="165">(f/g)' =</text>
                        <text fill="#2ecc71" font-size="18" text-anchor="middle" x="300" y="200">(f'g - fg') / g²</text>

                        <rect x="100" y="260" width="180" height="80" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                        <text fill="#e74c3c" font-size="18" text-anchor="middle" x="190" y="295">易错点1</text>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="190" y="320">是减号!</text>

                        <rect x="320" y="260" width="180" height="80" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                        <text fill="#e74c3c" font-size="18" text-anchor="middle" x="410" y="295">易错点2</text>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="410" y="320">分母平方!</text>

                        <circle cx="300" cy="400" r="40" fill="none" stroke="#e74c3c" stroke-width="4">
                            <animate attributeName="r" dur="2s" values="40;50;40" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#e74c3c" font-size="30" text-anchor="middle" x="300" y="415">!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第10页:链式法则 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>运算法则(四):链式法则</h2>
                    
                    <h3>复合函数求导</h3>
                    <div class="math-formula">
                        $$(f(g(x)))' = f'(g(x)) \\cdot g'(x)$$
                    </div>

                    <h3>核心思想</h3>
                    <p><strong>从外到内,逐层求导</strong></p>

                    <h3>最易错的法则!</h3>
                    <p>常见错误:</p>
                    <p>$(\\sin(2x))' = \\cos(2x)$ ❌</p>
                    <p>正确答案:</p>
                    <p>$(\\sin(2x))' = \\cos(2x) \\cdot 2$ ✓</p>
                    <p style="color: #e74c3c;">不要忘记内层导数!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">链式法则</text>

                        <rect x="100" y="120" width="400" height="90" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="155">(f(g(x)))'</text>
                        <text fill="#9b59b6" font-size="18" text-anchor="middle" x="300" y="185">= f'(g(x)) · g'(x)</text>

                        <circle cx="200" cy="280" r="50" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="3">
                            <animate attributeName="r" dur="2s" values="50;60;50" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="200" y="288">外层导数</text>

                        <line x1="250" y1="280" x2="350" y2="280" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow10)"/>

                        <circle cx="400" cy="280" r="50" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3">
                            <animate attributeName="r" dur="2s" values="50;60;50" repeatCount="indefinite" begin="0.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="400" y="288">内层导数</text>

                        <rect x="100" y="370" width="400" height="60" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                        <text fill="#e74c3c" font-size="16" text-anchor="middle" x="300" y="408">别忘了内层导数!</text>

                        <defs>
                            <marker id="arrow10" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#f39c12"/>
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第11页:综合题1-识别结构 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>综合练习1:链式法则应用</h2>
                    
                    <h3>例题</h3>
                    <p>求 $y = \\ln(\\sin(x^2 + 1))$ 的导数</p>

                    <h3>第一步:识别复合层次</h3>
                    <p>这是一个<strong>三层复合函数</strong></p>
                    <ul style="margin-left: 30px;">
                        <li>外层: $\\ln u$</li>
                        <li>中层: $\\sin v$</li>
                        <li>内层: $v = x^2+1$</li>
                    </ul>

                    <p style="margin-top: 20px;">理清层次是关键!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">复合函数分解</text>

                        <circle cx="300" cy="140" r="70" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="145">外层: ln</text>

                        <line x1="300" y1="210" x2="300" y2="250" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow11)"/>

                        <circle cx="300" cy="300" r="60" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="305">中层: sin</text>

                        <line x1="300" y1="360" x2="300" y2="390" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow11)"/>

                        <circle cx="300" cy="430" r="50" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="435">内层: x²+1</text>

                        <defs>
                            <marker id="arrow11" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#f39c12"/>
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第12页:综合题1-逐层求导 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>综合练习1:逐层求导</h2>
                    
                    <h3>第二步:从外到内求导</h3>
                    
                    <p>外层 $\\ln$ 的导数:</p>
                    <div class="math-formula">
                        $$\\frac{1}{\\sin(x^2+1)}$$
                    </div>

                    <p>中层 $\\sin$ 的导数:</p>
                    <div class="math-formula">
                        $$\\cos(x^2+1)$$
                    </div>

                    <p>内层 $x^2+1$ 的导数:</p>
                    <div class="math-formula">
                        $$2x$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">逐层求导</text>

                        <rect x="80" y="100" width="440" height="70" fill="rgba(241,196,15,0.1)" stroke="#f39c12" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" x="100" y="130">外层 ln → 1/u</text>
                        <text fill="#f39c12" font-size="14" x="100" y="155">1/sin(x²+1)</text>

                        <rect x="80" y="190" width="440" height="70" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" x="100" y="220">中层 sin → cos</text>
                        <text fill="#3498db" font-size="14" x="100" y="245">cos(x²+1)</text>

                        <rect x="80" y="280" width="440" height="70" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" x="100" y="310">内层 x²+1 → 2x</text>
                        <text fill="#e74c3c" font-size="14" x="100" y="335">2x</text>

                        <text fill="#2ecc71" font-size="18" text-anchor="middle" x="300" y="400">三层导数都求出来了!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第13页:综合题1-最终答案 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>综合练习1:最终答案</h2>
                    
                    <h3>第三步:相乘并化简</h3>
                    
                    <p>根据链式法则,三层导数相乘:</p>
                    <div class="math-formula">
                        $$y' = \\frac{1}{\\sin(x^2+1)} \\cdot \\cos(x^2+1) \\cdot 2x$$
                    </div>

                    <p>化简:</p>
                    <div class="math-formula">
                        $$y' = 2x \\cdot \\frac{\\cos(x^2+1)}{\\sin(x^2+1)}$$
                    </div>

                    <p>最终答案:</p>
                    <div class="math-formula">
                        $$y' = 2x \\cot(x^2+1)$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">最终答案</text>

                        <rect x="80" y="120" width="440" height="80" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="155">y' = (1/sin)·cos·2x</text>
                        <text fill="#2ecc71" font-size="16" text-anchor="middle" x="300" y="185">三层相乘</text>

                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="260">↓ 化简</text>

                        <rect x="80" y="300" width="440" height="80" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="4" rx="10">
                            <animate attributeName="stroke-width" dur="2s" values="4;6;4" repeatCount="indefinite"/>
                        </rect>
                        <text fill="#f1c40f" font-size="22" text-anchor="middle" x="300" y="350">y' = 2x cot(x²+1)</text>

                        <text fill="#2ecc71" font-size="18" text-anchor="middle" x="300" y="430">完成!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第14页:综合题2-题目分析 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>综合练习2:乘除混合</h2>
                    
                    <h3>例题</h3>
                    <p>求 $y = \\frac{x^2 e^x}{\\ln x}$ 的导数</p>

                    <h3>分析结构</h3>
                    <p>这是一个<strong>除法</strong></p>
                    <p>分子: $x^2 e^x$ (乘法)</p>
                    <p>分母: $\\ln x$</p>

                    <h3>解题策略</h3>
                    <p>1. 先用<strong>除法法则</strong></p>
                    <p>2. 分子再用<strong>乘法法则</strong></p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">结构分析</text>

                        <rect x="150" y="140" width="300" height="80" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="170">分子: x²e^x</text>
                        <text fill="#3498db" font-size="14" text-anchor="middle" x="300" y="200">(乘法)</text>

                        <line x1="200" y1="220" x2="400" y2="220" stroke="#f39c12" stroke-width="4"/>
                        <text fill="#f39c12" font-size="20" text-anchor="middle" x="450" y="230">除法</text>

                        <rect x="150" y="240" width="300" height="80" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="270">分母: ln x</text>
                        <text fill="#2ecc71" font-size="14" text-anchor="middle" x="300" y="300">(简单)</text>

                        <rect x="100" y="360" width="400" height="80" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="395">先除法,后乘法</text>
                        <text fill="#9b59b6" font-size="14" text-anchor="middle" x="300" y="420">分步处理</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第15页:综合题2-分子求导 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>综合练习2:分子求导</h2>
                    
                    <h3>第一步:求分子的导数</h3>
                    <p>令 $u = x^2 e^x$</p>
                    
                    <p>用<strong>乘法法则</strong>:</p>
                    <div class="math-formula">
                        $$u' = (x^2)' e^x + x^2 (e^x)'$$
                    </div>

                    <p>计算:</p>
                    <div class="math-formula">
                        $$u' = 2x e^x + x^2 e^x$$
                    </div>

                    <p>提取公因子:</p>
                    <div class="math-formula">
                        $$u' = (2x + x^2)e^x$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">分子求导(乘法)</text>

                        <rect x="100" y="120" width="400" height="70" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="160">(x²e^x)' = (x²)'e^x + x²(e^x)'</text>

                        <text fill="#f39c12" font-size="22" text-anchor="middle" x="300" y="230">↓</text>

                        <rect x="100" y="260" width="400" height="70" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="300">= 2xe^x + x²e^x</text>

                        <text fill="#f39c12" font-size="22" text-anchor="middle" x="300" y="360">↓ 提取公因子</text>

                        <rect x="100" y="390" width="400" height="70" fill="rgba(241,196,15,0.1)" stroke="#f39c12" stroke-width="3" rx="8"/>
                        <text fill="#f1c40f" font-size="18" text-anchor="middle" x="300" y="430">= (2x + x²)e^x</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第16页:综合题2-除法法则 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>综合练习2:应用除法法则</h2>
                    
                    <h3>第二步:求分母的导数</h3>
                    <p>令 $v = \\ln x$</p>
                    <div class="math-formula">
                        $$v' = \\frac{1}{x}$$
                    </div>

                    <h3>第三步:用除法法则</h3>
                    <div class="math-formula">
                        $$y' = \\frac{u'v - uv'}{v^2}$$
                    </div>

                    <p>代入:</p>
                    <div class="math-formula">
                        $$y' = \\frac{(2x+x^2)e^x \\ln x - x^2 e^x \\cdot \\frac{1}{x}}{(\\ln x)^2}$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">除法法则</text>

                        <rect x="100" y="120" width="400" height="80" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="150">分子导数: u' = (2x+x²)e^x</text>
                        <text fill="#2ecc71" font-size="14" text-anchor="middle" x="300" y="180">已求出</text>

                        <rect x="100" y="220" width="400" height="80" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="250">分母导数: v' = 1/x</text>
                        <text fill="#9b59b6" font-size="14" text-anchor="middle" x="300" y="280">简单</text>

                        <rect x="80" y="330" width="440" height="100" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="3" rx="10"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="365">除法法则:</text>
                        <text fill="#e74c3c" font-size="14" text-anchor="middle" x="300" y="395">y' = (u'v - uv') / v²</text>
                        <text fill="#95a5a6" font-size="12" text-anchor="middle" x="300" y="415">代入计算</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第17页:微分概念 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>微分的概念</h2>
                    
                    <h3>微分定义</h3>
                    <div class="math-formula">
                        $$dy = f'(x)dx$$
                    </div>

                    <h3>几何意义</h3>
                    <p>微分 = 切线上的增量</p>
                    <p>导数 = 切线的斜率</p>

                    <h3>近似公式</h3>
                    <div class="math-formula">
                        $$f(x + \\Delta x) \\approx f(x) + f'(x)\\Delta x$$
                    </div>
                    <p>当$\\Delta x$很小时</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">微分的几何意义</text>

                        <!-- 坐标系 -->
                        <line x1="100" y1="350" x2="550" y2="350" stroke="#ecf0f1" stroke-width="2"/>
                        <line x1="200" y1="100" x2="200" y2="400" stroke="#ecf0f1" stroke-width="2"/>

                        <!-- 曲线 -->
                        <path d="M 200 350 Q 300 200 450 150"
                              fill="none" stroke="#3498db" stroke-width="3"/>
                        <text fill="#3498db" font-size="14" x="460" y="150">y=f(x)</text>

                        <!-- 点和切线 -->
                        <circle cx="300" cy="260" r="5" fill="#e74c3c"/>
                        <line x1="250" y1="285" x2="400" y2="210" stroke="#2ecc71" stroke-width="2" stroke-dasharray="5,5"/>
                        <text fill="#2ecc71" font-size="14" x="380" y="200">切线</text>

                        <!-- dy标注 -->
                        <line x1="330" y1="260" x2="330" y2="240" stroke="#f39c12" stroke-width="3"/>
                        <text fill="#f39c12" font-size="14" x="340" y="250">dy</text>

                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="450">切线增量 ≈ 函数增量</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第18页:微分应用-近似计算 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>微分应用:近似计算</h2>
                    
                    <h3>例题</h3>
                    <p>用微分估算 $\\sqrt{1.05}$ 的近似值</p>

                    <h3>解题步骤</h3>
                    <p>设 $f(x) = \\sqrt{x}$</p>
                    <p>在 $x = 1$ 附近计算</p>

                    <p>1. 求导数:</p>
                    <div class="math-formula">
                        $$f'(x) = \\frac{1}{2\\sqrt{x}}$$
                    </div>

                    <p>2. 在$x=1$处:</p>
                    <div class="math-formula">
                        $$f'(1) = \\frac{1}{2}$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">近似计算步骤</text>

                        <rect x="100" y="120" width="400" height="80" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="150">函数: f(x) = √x</text>
                        <text fill="#3498db" font-size="14" text-anchor="middle" x="300" y="180">在x=1附近</text>

                        <rect x="100" y="220" width="400" height="80" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="250">导数: f'(x) = 1/(2√x)</text>
                        <text fill="#2ecc71" font-size="14" text-anchor="middle" x="300" y="280">f'(1) = 1/2</text>

                        <rect x="100" y="320" width="400" height="80" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="350">增量: Δx = 0.05</text>
                        <text fill="#9b59b6" font-size="14" text-anchor="middle" x="300" y="380">很小的增量</text>

                        <text fill="#f39c12" font-size="16" text-anchor="middle" x="300" y="440">准备应用近似公式</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第19页:微分应用-计算结果 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>微分应用:计算结果</h2>
                    
                    <h3>应用近似公式</h3>
                    <p>取 $x_0 = 1$, $\\Delta x = 0.05$</p>

                    <div class="math-formula">
                        $$f(1.05) \\approx f(1) + f'(1) \\cdot 0.05$$
                    </div>

                    <p>代入数值:</p>
                    <div class="math-formula">
                        $$\\sqrt{1.05} \\approx 1 + \\frac{1}{2} \\times 0.05$$
                    </div>

                    <div class="math-formula">
                        $$= 1 + 0.025 = 1.025$$
                    </div>

                    <p style="margin-top: 20px; color: #2ecc71;">近似值: <strong>1.025</strong></p>
                    <p style="color: #95a5a6;">实际值: 1.024695...</p>
                    <p style="color: #95a5a6;">误差非常小!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">计算过程</text>

                        <!-- 坐标系 -->
                        <line x1="100" y1="350" x2="550" y2="350" stroke="#ecf0f1" stroke-width="2"/>
                        <line x1="200" y1="150" x2="200" y2="400" stroke="#ecf0f1" stroke-width="2"/>

                        <!-- 曲线 -->
                        <path d="M 200 350 Q 300 200 450 140"
                              fill="none" stroke="#3498db" stroke-width="3"/>
                        <text fill="#3498db" font-size="14" x="460" y="140">y=√x</text>

                        <!-- 点(1,1) -->
                        <circle cx="300" cy="250" r="6" fill="#e74c3c"/>
                        <text fill="#e74c3c" font-size="14" x="260" y="235">(1, 1)</text>

                        <!-- 切线 -->
                        <line x1="250" y1="275" x2="400" y2="200" stroke="#2ecc71" stroke-width="2" stroke-dasharray="5,5"/>

                        <!-- Δx -->
                        <line x1="300" y1="355" x2="330" y2="355" stroke="#f39c12" stroke-width="3"/>
                        <text fill="#f39c12" font-size="14" text-anchor="middle" x="315" y="375">0.05</text>

                        <!-- 近似点 -->
                        <circle cx="330" cy="235" r="6" fill="#2ecc71"/>
                        <text fill="#2ecc71" font-size="14" x="340" y="235">≈1.025</text>

                        <text fill="#2ecc71" font-size="16" text-anchor="middle" x="300" y="440">切线近似效果很好!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第20页:易错点1 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>易错点1:链式法则遗漏</h2>
                    
                    <h3>常见错误</h3>
                    <p><strong>错误:</strong></p>
                    <div class="math-formula">
                        $$(\\sin(2x))' = \\cos(2x)$$
                    </div>
                    <p style="color: #e74c3c;">❌ 忘记了内层导数!</p>

                    <h3>正确做法</h3>
                    <p><strong>正确:</strong></p>
                    <div class="math-formula">
                        $$(\\sin(2x))' = \\cos(2x) \\cdot 2$$
                    </div>
                    <p style="color: #2ecc71;">✓ 不要忘记内层的2!</p>

                    <p style="margin-top: 20px;"><strong>记住:</strong></p>
                    <p>复合函数求导,<strong>内层导数不能忘</strong>!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">易错点1</text>

                        <rect x="100" y="130" width="400" height="100" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="4" rx="10"/>
                        <text fill="#e74c3c" font-size="28" text-anchor="middle" x="300" y="170">❌</text>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="200">(sin 2x)' = cos 2x</text>
                        <text fill="#e74c3c" font-size="14" text-anchor="middle" x="300" y="220">忘记内层导数</text>

                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="270">↓</text>

                        <rect x="100" y="300" width="400" height="100" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="4" rx="10"/>
                        <text fill="#2ecc71" font-size="28" text-anchor="middle" x="300" y="340">✓</text>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="370">(sin 2x)' = cos 2x · 2</text>
                        <text fill="#2ecc71" font-size="14" text-anchor="middle" x="300" y="390">别忘了2!</text>

                        <circle cx="550" cy="250" r="35" fill="none" stroke="#e74c3c" stroke-width="4">
                            <animate attributeName="r" dur="2s" values="35;45;35" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#e74c3c" font-size="36" text-anchor="middle" x="550" y="265">!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第21页:易错点2 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>易错点2:除法法则符号</h2>
                    
                    <h3>常见错误</h3>
                    <p><strong>错误:</strong></p>
                    <div class="math-formula">
                        $$\\left(\\frac{f}{g}\\right)' = \\frac{f'g + fg'}{g^2}$$
                    </div>
                    <p style="color: #e74c3c;">❌ 用了加号!</p>

                    <h3>正确做法</h3>
                    <p><strong>正确:</strong></p>
                    <div class="math-formula">
                        $$\\left(\\frac{f}{g}\\right)' = \\frac{f'g - fg'}{g^2}$$
                    </div>
                    <p style="color: #2ecc71;">✓ 是减号!</p>

                    <p style="margin-top: 20px;"><strong>记住:</strong></p>
                    <p>除法法则是<strong>减号</strong>,不是加号!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">易错点2</text>

                        <rect x="100" y="130" width="400" height="100" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="4" rx="10"/>
                        <text fill="#e74c3c" font-size="28" text-anchor="middle" x="300" y="170">❌</text>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="200">(f/g)' = (f'g + fg')/g²</text>
                        <text fill="#e74c3c" font-size="14" text-anchor="middle" x="300" y="220">用了加号</text>

                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="270">↓</text>

                        <rect x="100" y="300" width="400" height="100" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="4" rx="10"/>
                        <text fill="#2ecc71" font-size="28" text-anchor="middle" x="300" y="340">✓</text>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="370">(f/g)' = (f'g - fg')/g²</text>
                        <text fill="#2ecc71" font-size="14" text-anchor="middle" x="300" y="390">是减号!</text>

                        <text fill="#e74c3c" font-size="32" text-anchor="middle" x="550" y="250">-</text>
                        <circle cx="550" cy="235" r="40" fill="none" stroke="#e74c3c" stroke-width="4">
                            <animate attributeName="r" dur="2s" values="40;50;40" repeatCount="indefinite"/>
                        </circle>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第22页:易错点3 -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>易错点3:对数底数</h2>
                    
                    <h3>常见错误</h3>
                    <p><strong>错误:</strong></p>
                    <div class="math-formula">
                        $$(\\log_2 x)' = \\frac{1}{x}$$
                    </div>
                    <p style="color: #e74c3c;">❌ 忘记了底数!</p>

                    <h3>正确做法</h3>
                    <p><strong>正确:</strong></p>
                    <div class="math-formula">
                        $$(\\log_2 x)' = \\frac{1}{x \\ln 2}$$
                    </div>
                    <p style="color: #2ecc71;">✓ 要除以ln 2!</p>

                    <p style="margin-top: 20px;"><strong>记住:</strong></p>
                    <p>不是自然对数时,要<strong>除以ln a</strong>!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="60">易错点3</text>

                        <rect x="100" y="130" width="400" height="100" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="4" rx="10"/>
                        <text fill="#e74c3c" font-size="28" text-anchor="middle" x="300" y="170">❌</text>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="200">(log₂ x)' = 1/x</text>
                        <text fill="#e74c3c" font-size="14" text-anchor="middle" x="300" y="220">忘记底数</text>

                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="270">↓</text>

                        <rect x="100" y="300" width="400" height="100" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="4" rx="10"/>
                        <text fill="#2ecc71" font-size="28" text-anchor="middle" x="300" y="340">✓</text>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="370">(log₂ x)' = 1/(x·ln 2)</text>
                        <text fill="#2ecc71" font-size="14" text-anchor="middle" x="300" y="390">除以ln 2!</text>

                        <text fill="#e74c3c" font-size="20" text-anchor="middle" x="550" y="250">ln a</text>
                        <circle cx="550" cy="235" r="40" fill="none" stroke="#e74c3c" stroke-width="4">
                            <animate attributeName="r" dur="2s" values="40;50;40" repeatCount="indefinite"/>
                        </circle>
                    </svg>
                </div>
            </div>
        </div>

        <!-- 第23页:知识总结 -->
        <div class="slide">
            <div class="slide-content">
                    <h2>第3章总结</h2>
                    <h3>核心知识点</h3>
                    <ul style="margin-left: 30px;">
                        <li><strong>导数定义:</strong> 瞬时变化率</li>
                        <li><strong>几何意义:</strong> 切线斜率</li>
                        <li><strong>基本公式:</strong> 幂、指、对、三角</li>
                        <li><strong>四大法则:</strong> 线性、乘、除、链式</li>
                        <li><strong>微分应用:</strong> 近似计算与误差估计</li>
                    </ul>

                    <h3 style="margin-top: 25px;">学习建议</h3>
                    <ul style="margin-left: 30px;">
                        <li>熟记基本公式</li>
                        <li>掌握运算法则</li>
                        <li>多做综合练习</li>
                        <li>注意易错点</li>
                    </ul>

                    <p style="margin-top: 25px; color: #f39c12;"><strong>记住:</strong></p>
                    <p>导数是研究函数变化的<strong>基础工具</strong>,</p>
                    <p>熟练掌握后,才能学好后续的导数应用!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="32" text-anchor="middle" x="300" y="60">第3章知识地图</text>

                        <!-- 中心 -->
                        <circle cx="300" cy="250" r="90" fill="rgba(241,196,15,0.3)" stroke="#f39c12" stroke-width="4">
                            <animate attributeName="r" dur="3s" values="90;100;90" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#f1c40f" font-size="26" text-anchor="middle" x="300" y="245">导数</text>
                        <text fill="#f1c40f" font-size="20" text-anchor="middle" x="300" y="275">第3章</text>

                        <!-- 4个分支 -->
                        <circle cx="140" cy="140" r="50" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="0.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="140" y="135">概念</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="140" y="153">定义&几何</text>
                        <line x1="210" y1="180" x2="260" y2="210" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="460" cy="140" r="50" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="1s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="460" y="135">公式</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="460" y="153">基本公式</text>
                        <line x1="390" y1="180" x2="340" y2="210" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="140" cy="380" r="50" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="1.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="140" y="375">法则</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="140" y="393">四大法则</text>
                        <line x1="210" y1="340" x2="260" y2="300" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="460" cy="380" r="50" fill="rgba(155,89,182,0.2)" stroke="#9b59b6" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="2s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="460" y="375">微分</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="460" y="393">应用</text>
                        <line x1="390" y1="340" x2="340" y2="300" stroke="#f39c12" stroke-width="2"/>

                        <!-- 底部总结 -->
                        <text fill="#2ecc71" font-size="20" text-anchor="middle" x="300" y="470">熟练掌握,为后续学习打好基础!</text>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    <div class="subtitle-area" id="subtitleArea">欢迎学习导数综合复习与习题!</div>
    <div class="control-bar">
        <div style="color: #f1c40f; font-weight: bold; margin-bottom: 15px; text-align: center;">第 <span id="currentSlide">1</span> / <span id="totalSlides">8</span> 页</div>
        <button class="btn" id="prevBtn" onclick="previousSlide()">⬅️ 上一页</button>
        <button class="btn primary" id="startBtn" onclick="startTeaching()">🎀 开始讲课</button>
        <button class="btn" id="nextBtn" onclick="nextSlide()">下一页 ➡️</button>
        <button class="btn" onclick="restart()">🔄 重新开始</button>
        <button class="btn" id="autoPlayBtn" onclick="startAutoPlay()">🎬 自动播放</button>
    </div>
    <script type="module">
        window.playbackFinished = false;
        try { const { default: AvatarPlatform, SDKEvents, PlayerEvents, RecorderEvents, UserMedia } = await import('./avatar-sdk-web_3.1.2.1002/index.js'); window.AvatarPlatform = AvatarPlatform; window.SDKEvents = SDKEvents; window.PlayerEvents = PlayerEvents; window.RecorderEvents = RecorderEvents; window.UserMedia = UserMedia; console.log('✅ 讯飞SDK模块已加载'); } catch (error) { console.error('❌ SDK加载失败:', error); } window.dispatchEvent(new CustomEvent('sdkReady'));
    </script>
    <script>
        const subtitleScript = { "1": "同学们好!前面几节课我们系统学习了第3章导数的全部内容,从导数的概念到基本求导公式,从四则运算法则到链式法则,从微分的概念到微分的应用。今天这节课,我们要进行系统的复习和综合练习,把零散的知识点串联起来,形成完整的知识体系。导数的核心思想是什么?就是瞬时变化率。几何意义呢?就是切线的斜率。这两点是理解导数的关键。让我们一起来回顾这一章的知识结构,确保每个知识点都掌握扎实!", "2": "首先来回顾基本求导公式,这是求导数的基础,必须熟记于心!第一类是幂函数:x的n次方求导等于nx的n减1次方,常数C的导数是0。第二类是指数函数和对数函数:e的x次方求导还是e的x次方,这是e的特殊性质;一般的a的x次方求导是a的x次方乘以ln a。对数方面,ln x的导数是1除以x,一般对数log以a为底x的导数是1除以x乘以ln a。第三类是三角函数:sin x求导得cos x,cos x求导得负sin x,tan x求导得sec平方x,也就是1除以cos平方x。这些公式是工具,就像九九乘法表一样,必须背得滚瓜烂熟,才能在做题时信手拈来!", "3": "接下来复习四大运算法则。第一是线性性质,也叫和差法则:a倍的f加减b倍的g,求导等于a倍的f撇加减b倍的g撇。常数可以提取出来,和差可以分别求导,这个最简单。第二是乘法法则:f乘以g的导数等于f撇乘以g加f乘以g撇。记住口诀:前导后不导,加上前不导后导。注意是两项相加!第三是除法法则:f除以g的导数,分子是f撇乘以g减去f乘以g撇,分母是g的平方。口诀是:上导下减上下导,除以下平方。注意两点:一是减号不是加号,二是分母要平方!第四是链式法则,这是最重要也是最容易出错的:复合函数f括号g括号x的导数,等于f撇括号g括号x乘以g撇括号x。从外到内,逐层求导,千万不要遗漏内层函数的导数!", "4": "现在通过一道综合题来练习链式法则的应用。例题:求y等于ln括号sin括号x平方加1的导数。首先要识别复合层次。这是一个三层复合函数:最外层是ln,中间层是sin,最内层是x平方加1。设u等于sin括号x平方加1,v等于x平方加1,那么y等于ln u,u等于sin v,v等于x平方加1。按照链式法则,从外到内逐层求导:ln的导数是1除以u,sin的导数是cos,x平方加1的导数是2x。所以y撇等于1除以sin括号x平方加1,乘以cos括号x平方加1,再乘以2x。最后化简:1除以sin乘以cos就是cot,所以答案是2x乘以cot括号x平方加1。做复合函数求导时,关键是理清层次关系,然后从外到内一层一层求导,最后化简。", "5": "再看一道乘除混合运算的综合题。例题:求y等于x平方乘以e的x次方除以ln x的导数。这道题同时涉及乘法法则和除法法则,要分步骤处理。首先分析结构:这是一个除法,分子是x平方乘以e的x次方,分母是ln x。令u等于x平方乘以e的x次方,v等于ln x,那么y等于u除以v。第一步,用乘法法则求分子u的导数:u撇等于x平方撇乘以e的x次方加x平方乘以e的x次方撇,等于2x乘以e的x次方加x平方乘以e的x次方,可以提取公因子得到括号2x加x平方乘以e的x次方。第二步,求分母v的导数:v撇等于1除以x。第三步,用除法法则:y撇等于u撇乘以v减u乘以v撇,全部除以v平方。代入并化简,最终得到答案。做这类混合题,关键是理清运算顺序,先处理内层的乘法或除法,再处理外层的运算。", "6": "微分的一个重要应用是近似计算。我们来看一道例题:用微分估算根号1点05的近似值。根据微分的近似公式,f括号x加delta x约等于f括号x加f撇括号x乘以delta x,当delta x很小时。我们设f括号x等于根号x,要在x等于1附近计算根号1点05。首先求导数:f撇括号x等于1除以2倍根号x,所以f撇括号1等于1除以2倍根号1等于二分之一。取x零等于1,delta x等于0点05,代入近似公式:f括号1点05约等于f括号1加f撇括号1乘以0点05,等于1加二分之一乘以0点05,等于1加0点025,等于1点025。用计算器验证,根号1点05的实际值是1点024695点点点,可以看到误差非常小,只有百分之零点零几!微分近似计算的原理是用切线代替曲线,当delta x很小时,切线和曲线几乎重合,所以近似效果非常好。", "7": "最后总结几个常见的易错点,这些都是同学们经常犯的错误,一定要引起重视!第一个易错点是链式法则遗漏内层导数。比如求sin括号2x的导数,很多同学写cos括号2x就完了,忘了2x的导数是2,正确答案应该是2cos括号2x。记住:复合函数求导,内层导数不能忘!第二个易错点是除法法则的符号错误。除法法则的分子是f撇g减fg撇,很多同学误记成加号,这是错的!一定要记住是减号。第三个易错点是对数函数的底数问题。ln x的导数是1除以x,但如果是log以2为底x,导数就不是1除以x了,要除以ln 2,变成1除以x乘以ln 2。不是自然对数时,一定要除以ln a!还有一个常见错误是链式法则和乘法法则混淆,要仔细判断是复合还是相乘。", "8": "好,今天的复习课就到这里。让我们系统回顾一下第3章的核心内容。第一,导数的定义是函数的瞬时变化率,几何意义是切线斜率,这是理解导数的基础。第二,基本求导公式包括幂函数、指数对数函数、三角函数三大类,这些公式必须熟记。第三,四大运算法则是线性法则、乘法法则、除法法则和链式法则,其中链式法则最重要也最容易出错。第四,微分的概念dy等于f撇x乘以dx,微分有两大应用:近似计算和误差估计。记住:导数是研究函数变化的基础工具,是微积分的核心内容之一!只有把导数学好学透,熟练掌握各种求导方法,才能为后续学习导数的应用、积分等内容打下坚实基础。同学们课后一定要多做练习,把公式和法则烂熟于心!今天的复习课就到这里,同学们再见!" };
        const actionMap = { "1": "A_RLH_welcome_O", "2": "A_RH_point_O", "3": "A_LH_introduced_O", "4": "A_RH_point_O", "5": "A_LH_introduced_O", "6": "A_RH_point_O", "7": "A_RH_point_O", "8": "A_RLH_welcome_O" };
        let currentSlide = 0; const totalSlides = 8; let avatarPlatform = null; let isConnected = false; let isTeaching = false; let isAutoPlaying = false; let speechFinishedResolve = null; const slides = document.querySelectorAll('.slide');
        function showSlide(index) { slides.forEach((slide, i) => slide.classList.toggle('active', i === index)); currentSlide = index; document.getElementById('currentSlide').textContent = index + 1; if (window.MathJax && window.MathJax.typesetPromise) { window.MathJax.typesetPromise([slides[index]]).catch(err => console.error(err)); } document.getElementById('prevBtn').disabled = index === 0; document.getElementById('nextBtn').disabled = index === totalSlides - 1; updateSubtitle(index + 1); }
        function nextSlide() { if (currentSlide < totalSlides - 1) { showSlide(currentSlide + 1); if (!isAutoPlaying) speakContent(currentSlide + 1); } }
        function previousSlide() { if (currentSlide > 0) { showSlide(currentSlide - 1); if (!isAutoPlaying) speakContent(currentSlide + 1); } }
        function restart() { showSlide(0); if (avatarPlatform) { avatarPlatform.stop(); } isConnected = false; isTeaching = false; isAutoPlaying = false; }
        function updateSubtitle(slideNum) { const subtitleArea = document.getElementById('subtitleArea'); subtitleArea.textContent = subtitleScript[slideNum] || ''; }
        async function speakContent(slideNum) { if (!isTeaching || !isConnected || !avatarPlatform) { console.log('⚠️ 虚拟人未连接'); return; } const content = subtitleScript[slideNum]; if (!content) return; try { const action = actionMap[slideNum]; if (action) { await avatarPlatform.writeCmd("action", action); } await avatarPlatform.writeText(content, { nlp: false }); updateSubtitle(slideNum); } catch (error) { console.error('❌ 讲解失败:', error); } }
        // 计算单页播放时长（用于超时fallback）
        function getSlideDuration(slideNum) {
            const subtitle = subtitleScript[slideNum];
            if (!subtitle) return 5000;
            return subtitle.length * 120 + 2000;
        }
        function updateStatus(message, type = 'normal') { const indicator = document.getElementById('statusIndicator'); if (indicator) { indicator.textContent = message; indicator.className = 'status-indicator'; if (type === 'connected') indicator.classList.add('connected'); else if (type === 'error') indicator.classList.add('error'); else if (type === 'connecting') indicator.classList.add('connecting'); } }
        function waitForSDK() { return new Promise((resolve, reject) => { if (typeof AvatarPlatform !== 'undefined') { resolve(); return; } const timeout = setTimeout(() => { reject(new Error('SDK加载超时')); }, 10000); window.addEventListener('sdkReady', function handler() { clearTimeout(timeout); window.removeEventListener('sdkReady', handler); resolve(); }); }); }
        async function startTeaching() { const startBtn = document.getElementById('startBtn'); startBtn.textContent = '🔄 启动中...'; startBtn.disabled = true; try { updateStatus('等待SDK...', 'connecting'); await waitForSDK(); if(avatarPlatform) { avatarPlatform.destroy(); } avatarPlatform = new AvatarPlatform({ useInlinePlayer: true }); avatarPlatform.on('connected', (initResp) => { console.log('🎉 连接成功'); isConnected = true; isTeaching = true; updateStatus('已连接', 'connected'); startBtn.textContent = '💖 虚拟人已就绪'; setTimeout(() => { speakContent(currentSlide + 1); }, 1000); }).on('disconnected', (err) => { isConnected = false; updateStatus('连接断开', 'error'); }).on('error', (error) => { console.error('❌ 错误:', error); updateStatus('错误', 'error'); startBtn.textContent = '❌ 连接失败'; startBtn.disabled = false; isTeaching = false; }).on('frame_stop', (data) => { console.log('✅ 虚拟人讲解完成 frame_stop:', data); if (isAutoPlaying && speechFinishedResolve) { console.log('🎬 通知自动播放：虚拟人讲解完成'); speechFinishedResolve(); speechFinishedResolve = null; } }); avatarPlatform.setApiInfo({ appId: 'e8c180ed', apiKey: 'e0c44f0e2ef0f47582ffa7e864da0d9b', apiSecret: 'MDZkNDNiZWU4NDkzNWM5MDQzMTY4N2Nh', sceneId: '237415046114840576', serverUrl: 'wss://avatar.cn-huadong-1.xf-yun.com/v1/interact' }); avatarPlatform.setGlobalParams({ stream: { protocol: 'xrtc', alpha: 1, bitrate: 1000000, fps: 25 }, avatar: { avatar_id: '110332017', width: 1920, height: 1080, scale: 1, move_h: 0, move_v: 0, audio_format: 1 }, tts: { vcn: 'x4_yiting', speed: 50, pitch: 50, volume: 100 }, avatar_dispatch: { interactive_mode: 1, content_analysis: 0 } }); await avatarPlatform.start({ wrapper: document.getElementById('avatarWrapper') }); } catch (error) { console.error('❌ 启动失败:', error); updateStatus('启动失败', 'error'); startBtn.textContent = '🎀 开始讲课'; startBtn.disabled = false; } }
        async function startAutoPlay() { if (!avatarPlatform || !isConnected) { await startTeaching(); await new Promise(resolve => setTimeout(resolve, 2000)); } isAutoPlaying = true; document.getElementById('autoPlayBtn').disabled = true; try { for (let i = currentSlide; i < totalSlides; i++) { if (!isAutoPlaying) { console.log('🛑 自动播放被停止'); break; } console.log(`\n🎬 === 开始播放第${i + 1}页/${totalSlides}页 ===`); showSlide(i); if (isConnected && isTeaching && avatarPlatform) { try { const speechPromise = new Promise(resolve => { speechFinishedResolve = resolve; }); await speakContent(i + 1); console.log(`⏳ 等待虚拟人讲解第${i + 1}页完成...`); const timeoutPromise = new Promise(resolve => setTimeout(() => { console.log(`⚠️ 第${i + 1}页讲解超时，继续下一页`); resolve(); }, getSlideDuration(i + 1) + 5000)); await Promise.race([speechPromise, timeoutPromise]); console.log(`✅ 第${i + 1}页讲解完成`); } catch (error) { console.error(`❌ 第${i + 1}页讲解异常:`, error); } } else { console.log('⚠️ 虚拟人未连接，使用固定延时'); await new Promise(resolve => setTimeout(resolve, getSlideDuration(i + 1))); } const waitTime = i === totalSlides - 1 ? 1500 : 200; await new Promise(resolve => setTimeout(resolve, waitTime)); } if (isAutoPlaying) { await new Promise(resolve => setTimeout(resolve, 3000)); } } catch (error) { console.error('❌ 自动播放失败:', error); } finally { isAutoPlaying = false; document.getElementById('autoPlayBtn').disabled = false; window.playbackFinished = true; document.title = "PLAYBACK_FINISHED"; console.log('🎉 播放完成'); } }
        document.addEventListener('keydown', (e) => { if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); } else if (e.key === 'ArrowLeft') { e.preventDefault(); previousSlide(); } else if (e.key === 'Enter') { e.preventDefault(); speakContent(currentSlide + 1); } });
        document.getElementById('totalSlides').textContent = totalSlides; showSlide(0);
        setTimeout(() => { console.log('🚀 自动启动播放...'); startAutoPlay(); }, 3000);
    </script>
</body>
</html>
