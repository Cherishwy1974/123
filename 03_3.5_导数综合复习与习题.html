<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1920, initial-scale=1.0">
    <title>03_3.5_å¯¼æ•°ç»¼åˆå¤ä¹ ä¸ä¹ é¢˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']], processEscapes: true, processEnvironments: true },
            svg: { fontCache: 'global' },
            startup: { pageReady: () => { return MathJax.startup.defaultPageReady().then(() => { console.log('âœ… MathJaxå·²åŠ è½½'); }); } }
        };
    </script>
    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { width: 100%; height: 100%; margin: 0; padding: 0; }
        body { font-family: 'Noto Serif SC', serif; background: #1a1a2e; overflow: hidden; height: 100vh; width: 100vw; }
        .blackboard { width: 100vw; height: 100vh; background: #1a1a2e; position: relative; border: 10px solid #795548; margin: 0; }
        .avatar-container { position: fixed; top: 60%; left: 50%; transform: translate(-50%, -50%); width: 975px; height: 1105px; overflow: hidden; z-index: 50; pointer-events: none; background: transparent; }
        .wrapper { width: 100%; height: 100%; background: transparent; pointer-events: auto; }
        .slide-container { width: 100%; height: 100%; position: relative; }
        .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; visibility: hidden; transition: opacity 0.6s ease-in-out; display: flex; justify-content: center; align-items: center; padding: 2rem; background-color: transparent; }
        .slide.active { opacity: 1; visibility: visible; }
        .slide-content { display: flex; flex-direction: row; gap: 2rem; width: 100%; height: 95%; }
        .chalkboard { flex: 0 0 45%; padding: 20px; display: flex; flex-direction: column; justify-content: center; overflow-y: auto; }
        .chalkboard h2 { color: #f1c40f; border-bottom: 2px solid #f39c12; font-size: 28px; padding-bottom: 10px; margin-bottom: 20px; }
        .chalkboard h3 { color: #1abc9c; font-size: 22px; margin-top: 20px; margin-bottom: 10px; }
        .chalkboard p, .chalkboard li { color: #e0e0e0; font-size: 18px; line-height: 1.8; margin: 8px 0; }
        .chalkboard strong { color: #e74c3c; }
        .math-formula { background-color: rgba(0,0,0,0.2); padding: 15px; border-radius: 5px; border-left: 4px solid #f39c12; font-size: 20px; color: #1abc9c; text-align: center; margin: 15px 0; }
        .visualization { flex: 1; padding: 20px; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .control-bar { position: fixed; left: -9999px; top: 50%; transform: translateY(-50%); width: 270px; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(15px); display: flex; flex-direction: column; gap: 12px; z-index: 200; border-radius: 0 20px 20px 0; padding: 25px 20px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2); border: 1px solid rgba(255, 255, 255, 0.2); }
        .btn { padding: 14px 22px; background: rgba(255, 255, 255, 0.25); color: #333; border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 12px; cursor: pointer; font-size: 14px; font-weight: 600; width: 100%; text-align: center; }
        .btn.primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; }
        .subtitle-area { position: absolute; bottom: 20px; left: 50px; right: 50px; min-height: 50px; background: rgba(0,0,0,0.8); border-radius: 8px; display: flex; align-items: center; justify-content: center; z-index: 60; color: white; font-size: 23px; text-align: center; padding: 15px 20px; line-height: 1.4; }
        .status-indicator { position: absolute; top: 10px; right: 10px; padding: 5px 10px; background: rgba(0,0,0,0.5); color: white; border-radius: 5px; font-size: 16px; z-index: 100; display: none; }
        .status-indicator.connected { background: rgba(76, 175, 80, 0.8); display: block; }
        .status-indicator.error { background: rgba(244, 67, 54, 0.8); display: block; }
        .status-indicator.connecting { background: rgba(255, 152, 0, 0.8); display: block; }
    </style>
</head>
<body class="blackboard">
    <div class="status-indicator" id="statusIndicator">ç­‰å¾…è¿æ¥</div>
    <div class="avatar-container"><div class="wrapper" id="avatarWrapper"></div></div>
    <div class="slide-container">
        <!-- ç¬¬1é¡µ:å¼•å…¥ - å¯¼æ•°çŸ¥è¯†æ¡†æ¶ -->
        <div class="slide active">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>å¯¼æ•°ç»¼åˆå¤ä¹ </h2>
                    <p>å‰é¢æˆ‘ä»¬å­¦ä¹ äº†å¯¼æ•°çš„å…¨éƒ¨å†…å®¹,</p>
                    <p>ä»Šå¤©è¿›è¡Œ<strong>ç³»ç»Ÿå¤ä¹ </strong>å’Œ<strong>ç»¼åˆç»ƒä¹ </strong>!</p>

                    <h3>ç¬¬3ç« çŸ¥è¯†ç»“æ„</h3>
                    <ul style="margin-left: 30px;">
                        <li><strong>3.1</strong> å¯¼æ•°çš„æ¦‚å¿µä¸å‡ ä½•æ„ä¹‰</li>
                        <li><strong>3.2</strong> åŸºæœ¬æ±‚å¯¼å…¬å¼ä¸å››åˆ™è¿ç®—</li>
                        <li><strong>3.3</strong> å¤åˆå‡½æ•°æ±‚å¯¼ä¸é“¾å¼æ³•åˆ™</li>
                        <li><strong>3.4</strong> å¾®åˆ†çš„æ¦‚å¿µä¸åº”ç”¨</li>
                    </ul>

                    <p style="margin-top: 20px;"><strong>æ ¸å¿ƒæ€æƒ³:</strong></p>
                    <p>å¯¼æ•° = <strong>ç¬æ—¶å˜åŒ–ç‡</strong></p>
                    <p>å‡ ä½•æ„ä¹‰ = <strong>åˆ‡çº¿æ–œç‡</strong></p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="32" text-anchor="middle" x="300" y="60">å¯¼æ•°çŸ¥è¯†ä½“ç³»</text>

                        <!-- ä¸­å¿ƒåœ† -->
                        <circle cx="300" cy="250" r="80" fill="rgba(241,196,15,0.3)" stroke="#f39c12" stroke-width="4">
                            <animate attributeName="r" dur="3s" values="80;90;80" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#f1c40f" font-size="24" text-anchor="middle" x="300" y="245">å¯¼æ•°</text>
                        <text fill="#f1c40f" font-size="20" text-anchor="middle" x="300" y="270">f'(x)</text>

                        <!-- æ¦‚å¿µ -->
                        <circle cx="150" cy="150" r="60" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="0.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="150" y="145">æ¦‚å¿µ</text>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="150" y="165">3.1</text>
                        <line x1="210" y1="190" x2="260" y2="220" stroke="#f39c12" stroke-width="2"/>

                        <!-- å…¬å¼ -->
                        <circle cx="450" cy="150" r="60" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="1s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="450" y="145">å…¬å¼</text>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="450" y="165">3.2</text>
                        <line x1="390" y1="190" x2="340" y2="220" stroke="#f39c12" stroke-width="2"/>

                        <!-- é“¾å¼ -->
                        <circle cx="150" cy="380" r="60" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="1.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="150" y="375">é“¾å¼</text>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="150" y="395">3.3</text>
                        <line x1="210" y1="340" x2="260" y2="300" stroke="#f39c12" stroke-width="2"/>

                        <!-- å¾®åˆ† -->
                        <circle cx="450" cy="380" r="60" fill="rgba(155,89,182,0.2)" stroke="#9b59b6" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="60;70;60" repeatCount="indefinite" begin="2s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="450" y="375">å¾®åˆ†</text>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="450" y="395">3.4</text>
                        <line x1="390" y1="340" x2="340" y2="300" stroke="#f39c12" stroke-width="2"/>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬2é¡µ:åŸºæœ¬å…¬å¼å›é¡¾ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>åŸºæœ¬æ±‚å¯¼å…¬å¼å›é¡¾</h2>
                    <p>è¿™äº›å…¬å¼<strong>å¿…é¡»ç†Ÿè®°</strong>!</p>

                    <h3>å¹‚å‡½æ•°ä¸å¸¸æ•°</h3>
                    <div class="math-formula">
                        $$(x^n)' = nx^{n-1}, \quad (C)' = 0$$
                    </div>

                    <h3>æŒ‡æ•°ä¸å¯¹æ•°</h3>
                    <div class="math-formula">
                        $$(e^x)' = e^x, \quad (a^x)' = a^x \ln a$$
                    </div>
                    <div class="math-formula">
                        $$(\ln x)' = \frac{1}{x}, \quad (\log_a x)' = \frac{1}{x \ln a}$$
                    </div>

                    <h3>ä¸‰è§’å‡½æ•°</h3>
                    <div class="math-formula">
                        $$(\sin x)' = \cos x, \quad (\cos x)' = -\sin x$$
                    </div>
                    <div class="math-formula">
                        $$(\tan x)' = \sec^2 x = \frac{1}{\cos^2 x}$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="50">å…¬å¼é€ŸæŸ¥è¡¨</text>

                        <!-- å¹‚å‡½æ•° -->
                        <g opacity="0">
                            <rect x="80" y="100" width="440" height="60" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="138">(x^n)' = nx^(n-1)</text>
                            <animate attributeName="opacity" dur="8s" values="0;1;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <!-- æŒ‡æ•° -->
                        <g opacity="0">
                            <rect x="80" y="180" width="440" height="60" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="218">(e^x)' = e^x</text>
                            <animate attributeName="opacity" dur="8s" values="0;0;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <!-- å¯¹æ•° -->
                        <g opacity="0">
                            <rect x="80" y="260" width="440" height="60" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="298">(ln x)' = 1/x</text>
                            <animate attributeName="opacity" dur="8s" values="0;0;0;1;1" repeatCount="indefinite"/>
                        </g>

                        <!-- ä¸‰è§’ -->
                        <g opacity="0">
                            <rect x="80" y="340" width="440" height="60" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="300" y="378">(sin x)' = cos x</text>
                            <animate attributeName="opacity" dur="8s" values="0;0;0;0;1" repeatCount="indefinite"/>
                        </g>

                        <!-- å¼ºè°ƒ -->
                        <text fill="#f39c12" font-size="22" text-anchor="middle" x="300" y="450">å¿…é¡»èƒŒç†Ÿ!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬3é¡µ:è¿ç®—æ³•åˆ™å›é¡¾ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>è¿ç®—æ³•åˆ™å›é¡¾</h2>

                    <h3>1. çº¿æ€§æ€§è´¨</h3>
                    <div class="math-formula">
                        $$(af \pm bg)' = af' \pm bg'$$
                    </div>
                    <p>å¸¸æ•°å¯ä»¥æå‡º,å’Œå·®åˆ†åˆ«æ±‚å¯¼</p>

                    <h3>2. ä¹˜æ³•æ³•åˆ™</h3>
                    <div class="math-formula">
                        $$(fg)' = f'g + fg'$$
                    </div>
                    <p><strong>å£è¯€:</strong> å‰å¯¼åä¸å¯¼ + å‰ä¸å¯¼åå¯¼</p>

                    <h3>3. é™¤æ³•æ³•åˆ™</h3>
                    <div class="math-formula">
                        $$\left(\frac{f}{g}\right)' = \frac{f'g - fg'}{g^2}$$
                    </div>
                    <p><strong>å£è¯€:</strong> ä¸Šå¯¼ä¸‹ - ä¸Šä¸‹å¯¼,é™¤ä»¥ä¸‹å¹³æ–¹</p>

                    <h3>4. é“¾å¼æ³•åˆ™</h3>
                    <div class="math-formula">
                        $$(f(g(x)))' = f'(g(x)) \cdot g'(x)$$
                    </div>
                    <p>ä»å¤–åˆ°å†…,<strong>é€å±‚æ±‚å¯¼</strong>!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="26" text-anchor="middle" x="300" y="50">å››å¤§æ³•åˆ™</text>

                        <!-- çº¿æ€§ -->
                        <rect x="100" y="100" width="180" height="150" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="190" y="130">çº¿æ€§</text>
                        <text fill="#e74c3c" font-size="16" text-anchor="middle" x="190" y="160">af' Â± bg'</text>

                        <!-- ä¹˜æ³• -->
                        <rect x="320" y="100" width="180" height="150" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="410" y="130">ä¹˜æ³•</text>
                        <text fill="#3498db" font-size="16" text-anchor="middle" x="410" y="160">f'g + fg'</text>

                        <!-- é™¤æ³• -->
                        <rect x="100" y="280" width="180" height="150" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="190" y="310">é™¤æ³•</text>
                        <text fill="#2ecc71" font-size="14" text-anchor="middle" x="190" y="340">(f'g-fg')/gÂ²</text>

                        <!-- é“¾å¼ -->
                        <rect x="320" y="280" width="180" height="150" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="2" rx="10"/>
                        <text fill="#ecf0f1" font-size="20" text-anchor="middle" x="410" y="310">é“¾å¼</text>
                        <text fill="#9b59b6" font-size="16" text-anchor="middle" x="410" y="340">f'(g)Â·g'(x)</text>

                        <!-- ä¸­å¿ƒè¿æ¥ -->
                        <circle cx="300" cy="260" r="40" fill="rgba(241,196,15,0.3)" stroke="#f39c12" stroke-width="3">
                            <animate attributeName="r" dur="2s" values="40;50;40" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#f1c40f" font-size="18" text-anchor="middle" x="300" y="268">æ±‚å¯¼</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬4é¡µ:ç»¼åˆé¢˜1 - é“¾å¼æ³•åˆ™ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>ç»¼åˆç»ƒä¹ 1:é“¾å¼æ³•åˆ™</h2>
                    <h3>ä¾‹é¢˜</h3>
                    <p>æ±‚ $y = \ln(\sin(x^2 + 1))$ çš„å¯¼æ•°</p>

                    <p><strong>è§£é¢˜æ­¥éª¤:</strong></p>
                    <p style="margin-left: 30px;">1. è¯†åˆ«å¤åˆå±‚æ¬¡:</p>
                    <p style="margin-left: 50px;">å¤–å±‚: $\ln u$, å…¶ä¸­ $u = \sin(x^2+1)$</p>
                    <p style="margin-left: 50px;">ä¸­å±‚: $\sin v$, å…¶ä¸­ $v = x^2+1$</p>
                    <p style="margin-left: 50px;">å†…å±‚: $v = x^2+1$</p>

                    <p style="margin-left: 30px;">2. é€å±‚æ±‚å¯¼:</p>
                    <div class="math-formula">
                        $$y' = \frac{1}{\sin(x^2+1)} \cdot \cos(x^2+1) \cdot 2x$$
                    </div>

                    <p style="margin-left: 30px;">3. åŒ–ç®€:</p>
                    <div class="math-formula">
                        $$y' = 2x \cot(x^2+1)$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">å¤åˆå‡½æ•°åˆ†è§£</text>

                        <!-- å¤–å±‚ ln -->
                        <circle cx="300" cy="120" r="70" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="125">ln</text>
                        <text fill="#f39c12" font-size="14" x="380" y="125">â†’ 1/u</text>

                        <line x1="300" y1="190" x2="300" y2="230" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow4)"/>

                        <!-- ä¸­å±‚ sin -->
                        <circle cx="300" cy="270" r="60" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="18" text-anchor="middle" x="300" y="275">sin</text>
                        <text fill="#3498db" font-size="14" x="380" y="275">â†’ cos</text>

                        <line x1="300" y1="330" x2="300" y2="360" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow4)"/>

                        <!-- å†…å±‚ xÂ²+1 -->
                        <circle cx="300" cy="400" r="50" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="405">xÂ²+1</text>
                        <text fill="#e74c3c" font-size="14" x="380" y="405">â†’ 2x</text>

                        <!-- ç»“æœæ¡† -->
                        <rect x="50" y="450" width="500" height="40" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="2" rx="5"/>
                        <text fill="#1abc9c" font-size="16" text-anchor="middle" x="300" y="475">y' = (1/sin)Â·cosÂ·2x = 2x cot(xÂ²+1)</text>

                        <defs>
                            <marker id="arrow4" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                <path d="M0,0 L0,6 L9,3 z" fill="#f39c12"/>
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬5é¡µ:ç»¼åˆé¢˜2 - ä¹˜é™¤æ··åˆ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>ç»¼åˆç»ƒä¹ 2:ä¹˜é™¤æ··åˆ</h2>
                    <h3>ä¾‹é¢˜</h3>
                    <p>æ±‚ $y = \frac{x^2 e^x}{\ln x}$ çš„å¯¼æ•°</p>

                    <p><strong>åˆ†æ:</strong> å…ˆç”¨<strong>é™¤æ³•æ³•åˆ™</strong>,åˆ†å­å†ç”¨<strong>ä¹˜æ³•æ³•åˆ™</strong></p>

                    <p><strong>è§£:</strong></p>
                    <p style="margin-left: 30px;">ä»¤ $u = x^2 e^x$, $v = \ln x$</p>

                    <p style="margin-left: 30px;">å…ˆæ±‚ $u'$:</p>
                    <div class="math-formula">
                        $$u' = (x^2)' e^x + x^2 (e^x)' = 2x e^x + x^2 e^x$$
                    </div>

                    <p style="margin-left: 30px;">å†æ±‚ $v'$:</p>
                    <div class="math-formula">
                        $$v' = \frac{1}{x}$$
                    </div>

                    <p style="margin-left: 30px;">æœ€åç”¨é™¤æ³•æ³•åˆ™:</p>
                    <div class="math-formula">
                        $$y' = \frac{u'v - uv'}{v^2} = \frac{(2x+x^2)e^x \ln x - x^2 e^x \cdot \frac{1}{x}}{(\ln x)^2}$$
                    </div>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">è§£é¢˜æ­¥éª¤æ‹†è§£</text>

                        <!-- æ­¥éª¤1:è¯†åˆ«ç»“æ„ -->
                        <g opacity="0">
                            <rect x="80" y="100" width="440" height="70" fill="rgba(52,152,219,0.1)" stroke="#3498db" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="18" x="100" y="130">æ­¥éª¤1: è¯†åˆ«ç»“æ„</text>
                            <text fill="#3498db" font-size="16" x="100" y="155">é™¤æ³• â†’ (xÂ²e^x) / (ln x)</text>
                            <animate attributeName="opacity" dur="12s" values="0;1;1;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <!-- æ­¥éª¤2:åˆ†å­æ±‚å¯¼ -->
                        <g opacity="0">
                            <rect x="80" y="190" width="440" height="70" fill="rgba(46,204,113,0.1)" stroke="#2ecc71" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="18" x="100" y="220">æ­¥éª¤2: åˆ†å­æ±‚å¯¼(ä¹˜æ³•)</text>
                            <text fill="#2ecc71" font-size="16" x="100" y="245">(xÂ²e^x)' = 2xe^x + xÂ²e^x</text>
                            <animate attributeName="opacity" dur="12s" values="0;0;1;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <!-- æ­¥éª¤3:åˆ†æ¯æ±‚å¯¼ -->
                        <g opacity="0">
                            <rect x="80" y="280" width="440" height="70" fill="rgba(155,89,182,0.1)" stroke="#9b59b6" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="18" x="100" y="310">æ­¥éª¤3: åˆ†æ¯æ±‚å¯¼</text>
                            <text fill="#9b59b6" font-size="16" x="100" y="335">(ln x)' = 1/x</text>
                            <animate attributeName="opacity" dur="12s" values="0;0;0;1;1;1" repeatCount="indefinite"/>
                        </g>

                        <!-- æ­¥éª¤4:é™¤æ³•æ³•åˆ™ -->
                        <g opacity="0">
                            <rect x="80" y="370" width="440" height="70" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="2" rx="8"/>
                            <text fill="#ecf0f1" font-size="18" x="100" y="400">æ­¥éª¤4: é™¤æ³•æ³•åˆ™</text>
                            <text fill="#e74c3c" font-size="14" x="100" y="425">(u'v - uv') / vÂ²</text>
                            <animate attributeName="opacity" dur="12s" values="0;0;0;0;1;1" repeatCount="indefinite"/>
                        </g>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬6é¡µ:å¾®åˆ†åº”ç”¨ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>å¾®åˆ†çš„åº”ç”¨</h2>
                    <h3>ä¾‹é¢˜:è¿‘ä¼¼è®¡ç®—</h3>
                    <p>ç”¨å¾®åˆ†ä¼°ç®— $\sqrt{1.05}$ çš„è¿‘ä¼¼å€¼</p>

                    <p><strong>è§£:</strong></p>
                    <p style="margin-left: 30px;">è®¾ $f(x) = \sqrt{x}$, åœ¨ $x = 1$ é™„è¿‘</p>
                    <p style="margin-left: 30px;">$f'(x) = \frac{1}{2\sqrt{x}}$, $f'(1) = \frac{1}{2}$</p>

                    <p style="margin-left: 30px;">å– $x_0 = 1$, $\Delta x = 0.05$</p>

                    <div class="math-formula">
                        $$f(1.05) \approx f(1) + f'(1) \cdot 0.05$$
                    </div>
                    <div class="math-formula">
                        $$= 1 + \frac{1}{2} \times 0.05 = 1.025$$
                    </div>

                    <p style="margin-top: 20px; color: #95a5a6;">å®é™…å€¼: $\sqrt{1.05} = 1.024695...$</p>
                    <p style="color: #95a5a6;">è¯¯å·®å¾ˆå°!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="24" text-anchor="middle" x="300" y="50">å¾®åˆ†è¿‘ä¼¼åŸç†</text>

                        <!-- åæ ‡ç³» -->
                        <line x1="100" y1="350" x2="550" y2="350" stroke="#ecf0f1" stroke-width="2"/>
                        <line x1="200" y1="100" x2="200" y2="400" stroke="#ecf0f1" stroke-width="2"/>

                        <!-- æ›²çº¿ y = âˆšx -->
                        <path d="M 200 350 Q 300 180 450 120"
                              fill="none" stroke="#3498db" stroke-width="3"/>
                        <text fill="#3498db" font-size="16" x="460" y="120">y = âˆšx</text>

                        <!-- ç‚¹ (1, 1) -->
                        <circle cx="300" cy="250" r="6" fill="#e74c3c"/>
                        <text fill="#e74c3c" font-size="14" x="260" y="235">(1, 1)</text>
                        <line x1="300" y1="350" x2="300" y2="355" stroke="#e74c3c" stroke-width="2"/>
                        <text fill="#e74c3c" font-size="14" text-anchor="middle" x="300" y="375">1</text>

                        <!-- åˆ‡çº¿ -->
                        <line x1="250" y1="275" x2="400" y2="200" stroke="#2ecc71" stroke-width="2" stroke-dasharray="5,5"/>
                        <text fill="#2ecc71" font-size="14" x="380" y="190">åˆ‡çº¿</text>

                        <!-- Î”x -->
                        <line x1="300" y1="355" x2="330" y2="355" stroke="#f39c12" stroke-width="3"/>
                        <text fill="#f39c12" font-size="14" text-anchor="middle" x="315" y="375">Î”x=0.05</text>

                        <!-- è¿‘ä¼¼ç‚¹ -->
                        <circle cx="330" cy="235" r="6" fill="#2ecc71"/>
                        <text fill="#2ecc71" font-size="14" x="340" y="235">â‰ˆ 1.025</text>

                        <!-- è¯´æ˜ -->
                        <rect x="100" y="420" width="400" height="60" fill="rgba(241,196,15,0.2)" stroke="#f39c12" stroke-width="2" rx="8"/>
                        <text fill="#ecf0f1" font-size="16" text-anchor="middle" x="300" y="450">åˆ‡çº¿è¿‘ä¼¼æ›²çº¿</text>
                        <text fill="#1abc9c" font-size="16" text-anchor="middle" x="300" y="470">f(x+Î”x) â‰ˆ f(x) + f'(x)Â·Î”x</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬7é¡µ:å¸¸è§æ˜“é”™ç‚¹ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>å¸¸è§æ˜“é”™ç‚¹æ€»ç»“</h2>

                    <h3>1. é“¾å¼æ³•åˆ™é—æ¼</h3>
                    <p><strong>é”™è¯¯:</strong> $(\sin(2x))' = \cos(2x)$ âŒ</p>
                    <p><strong>æ­£ç¡®:</strong> $(\sin(2x))' = \cos(2x) \cdot 2 = 2\cos(2x)$ âœ“</p>
                    <p style="color: #e74c3c;">ä¸è¦å¿˜è®°å†…å±‚å‡½æ•°çš„å¯¼æ•°!</p>

                    <h3>2. é™¤æ³•æ³•åˆ™ç¬¦å·</h3>
                    <p><strong>é”™è¯¯:</strong> $\left(\frac{f}{g}\right)' = \frac{f'g + fg'}{g^2}$ âŒ</p>
                    <p><strong>æ­£ç¡®:</strong> $\left(\frac{f}{g}\right)' = \frac{f'g - fg'}{g^2}$ âœ“</p>
                    <p style="color: #e74c3c;">æ˜¯å‡å·,ä¸æ˜¯åŠ å·!</p>

                    <h3>3. å¯¹æ•°åº•æ•°</h3>
                    <p><strong>é”™è¯¯:</strong> $(\log_2 x)' = \frac{1}{x}$ âŒ</p>
                    <p><strong>æ­£ç¡®:</strong> $(\log_2 x)' = \frac{1}{x \ln 2}$ âœ“</p>
                    <p style="color: #e74c3c;">ä¸æ˜¯è‡ªç„¶å¯¹æ•°æ—¶è¦é™¤ä»¥ $\ln a$!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="28" text-anchor="middle" x="300" y="60">æ˜“é”™ç‚¹è­¦ç¤º</text>

                        <!-- é”™è¯¯1 -->
                        <g>
                            <rect x="80" y="100" width="440" height="90" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="3" rx="10"/>
                            <text fill="#e74c3c" font-size="24" text-anchor="middle" x="300" y="130">âŒ</text>
                            <text fill="#ecf0f1" font-size="16" x="100" y="160">é“¾å¼æ³•åˆ™</text>
                            <text fill="#e74c3c" font-size="14" x="100" y="180">åˆ«å¿˜äº†å†…å±‚å¯¼æ•°!</text>
                        </g>

                        <!-- é”™è¯¯2 -->
                        <g>
                            <rect x="80" y="210" width="440" height="90" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="3" rx="10"/>
                            <text fill="#e74c3c" font-size="24" text-anchor="middle" x="300" y="240">âŒ</text>
                            <text fill="#ecf0f1" font-size="16" x="100" y="270">é™¤æ³•æ³•åˆ™</text>
                            <text fill="#e74c3c" font-size="14" x="100" y="290">æ˜¯å‡å·ä¸æ˜¯åŠ å·!</text>
                        </g>

                        <!-- é”™è¯¯3 -->
                        <g>
                            <rect x="80" y="320" width="440" height="90" fill="rgba(231,76,60,0.1)" stroke="#e74c3c" stroke-width="3" rx="10"/>
                            <text fill="#e74c3c" font-size="24" text-anchor="middle" x="300" y="350">âŒ</text>
                            <text fill="#ecf0f1" font-size="16" x="100" y="380">å¯¹æ•°åº•æ•°</text>
                            <text fill="#e74c3c" font-size="14" x="100" y="400">éeåº•è¦é™¤ln a!</text>
                        </g>

                        <!-- è­¦å‘Šæ ‡å¿— -->
                        <circle cx="550" cy="250" r="35" fill="none" stroke="#e74c3c" stroke-width="4">
                            <animate attributeName="r" dur="2s" values="35;45;35" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#e74c3c" font-size="36" text-anchor="middle" x="550" y="265">!</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- ç¬¬8é¡µ:æ€»ç»“ -->
        <div class="slide">
            <div class="slide-content">
                <div class="chalkboard">
                    <h2>ç¬¬3ç« æ€»ç»“</h2>
                    <h3>æ ¸å¿ƒçŸ¥è¯†ç‚¹</h3>
                    <ul style="margin-left: 30px;">
                        <li><strong>å¯¼æ•°å®šä¹‰:</strong> ç¬æ—¶å˜åŒ–ç‡</li>
                        <li><strong>å‡ ä½•æ„ä¹‰:</strong> åˆ‡çº¿æ–œç‡</li>
                        <li><strong>åŸºæœ¬å…¬å¼:</strong> å¹‚ã€æŒ‡ã€å¯¹ã€ä¸‰è§’</li>
                        <li><strong>å››å¤§æ³•åˆ™:</strong> çº¿æ€§ã€ä¹˜ã€é™¤ã€é“¾å¼</li>
                        <li><strong>å¾®åˆ†åº”ç”¨:</strong> è¿‘ä¼¼è®¡ç®—ä¸è¯¯å·®ä¼°è®¡</li>
                    </ul>

                    <h3 style="margin-top: 25px;">å­¦ä¹ å»ºè®®</h3>
                    <ul style="margin-left: 30px;">
                        <li>ç†Ÿè®°åŸºæœ¬å…¬å¼</li>
                        <li>æŒæ¡è¿ç®—æ³•åˆ™</li>
                        <li>å¤šåšç»¼åˆç»ƒä¹ </li>
                        <li>æ³¨æ„æ˜“é”™ç‚¹</li>
                    </ul>

                    <p style="margin-top: 25px; color: #f39c12;"><strong>è®°ä½:</strong></p>
                    <p>å¯¼æ•°æ˜¯ç ”ç©¶å‡½æ•°å˜åŒ–çš„<strong>åŸºç¡€å·¥å…·</strong>,</p>
                    <p>ç†Ÿç»ƒæŒæ¡å,æ‰èƒ½å­¦å¥½åç»­çš„å¯¼æ•°åº”ç”¨!</p>
                </div>
                <div class="visualization">
                    <svg viewBox="0 0 600 500" style="width: 100%; height: 100%;">
                        <text fill="#f39c12" font-size="32" text-anchor="middle" x="300" y="60">ç¬¬3ç« çŸ¥è¯†åœ°å›¾</text>

                        <!-- ä¸­å¿ƒ -->
                        <circle cx="300" cy="250" r="90" fill="rgba(241,196,15,0.3)" stroke="#f39c12" stroke-width="4">
                            <animate attributeName="r" dur="3s" values="90;100;90" repeatCount="indefinite"/>
                        </circle>
                        <text fill="#f1c40f" font-size="26" text-anchor="middle" x="300" y="245">å¯¼æ•°</text>
                        <text fill="#f1c40f" font-size="20" text-anchor="middle" x="300" y="275">ç¬¬3ç« </text>

                        <!-- 4ä¸ªåˆ†æ”¯ -->
                        <circle cx="140" cy="140" r="50" fill="rgba(231,76,60,0.2)" stroke="#e74c3c" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="0.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="140" y="135">æ¦‚å¿µ</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="140" y="153">å®šä¹‰&å‡ ä½•</text>
                        <line x1="210" y1="180" x2="260" y2="210" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="460" cy="140" r="50" fill="rgba(52,152,219,0.2)" stroke="#3498db" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="1s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="460" y="135">å…¬å¼</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="460" y="153">åŸºæœ¬å…¬å¼</text>
                        <line x1="390" y1="180" x2="340" y2="210" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="140" cy="380" r="50" fill="rgba(46,204,113,0.2)" stroke="#2ecc71" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="1.5s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="140" y="375">æ³•åˆ™</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="140" y="393">å››å¤§æ³•åˆ™</text>
                        <line x1="210" y1="340" x2="260" y2="300" stroke="#f39c12" stroke-width="2"/>

                        <circle cx="460" cy="380" r="50" fill="rgba(155,89,182,0.2)" stroke="#9b59b6" stroke-width="3">
                            <animate attributeName="r" dur="3s" values="50;60;50" repeatCount="indefinite" begin="2s"/>
                        </circle>
                        <text fill="#ecf0f1" font-size="14" text-anchor="middle" x="460" y="375">å¾®åˆ†</text>
                        <text fill="#ecf0f1" font-size="12" text-anchor="middle" x="460" y="393">åº”ç”¨</text>
                        <line x1="390" y1="340" x2="340" y2="300" stroke="#f39c12" stroke-width="2"/>

                        <!-- åº•éƒ¨æ€»ç»“ -->
                        <text fill="#2ecc71" font-size="20" text-anchor="middle" x="300" y="470">ç†Ÿç»ƒæŒæ¡,ä¸ºåç»­å­¦ä¹ æ‰“å¥½åŸºç¡€!</text>
                    </svg>
                </div>
            </div>
        </div>
    </div>
    <div class="subtitle-area" id="subtitleArea">æ¬¢è¿å­¦ä¹ å¯¼æ•°ç»¼åˆå¤ä¹ ä¸ä¹ é¢˜!</div>
    <div class="control-bar">
        <div style="color: #f1c40f; font-weight: bold; margin-bottom: 15px; text-align: center;">ç¬¬ <span id="currentSlide">1</span> / <span id="totalSlides">8</span> é¡µ</div>
        <button class="btn" id="prevBtn" onclick="previousSlide()">â¬…ï¸ ä¸Šä¸€é¡µ</button>
        <button class="btn primary" id="startBtn" onclick="startTeaching()">ğŸ€ å¼€å§‹è®²è¯¾</button>
        <button class="btn" id="nextBtn" onclick="nextSlide()">ä¸‹ä¸€é¡µ â¡ï¸</button>
        <button class="btn" onclick="restart()">ğŸ”„ é‡æ–°å¼€å§‹</button>
        <button class="btn" id="autoPlayBtn" onclick="startAutoPlay()">ğŸ¬ è‡ªåŠ¨æ’­æ”¾</button>
    </div>
    <script type="module">
        window.playbackFinished = false;
        try { const { default: AvatarPlatform, SDKEvents, PlayerEvents, RecorderEvents, UserMedia } = await import('./avatar-sdk-web_3.1.2.1002/index.js'); window.AvatarPlatform = AvatarPlatform; window.SDKEvents = SDKEvents; window.PlayerEvents = PlayerEvents; window.RecorderEvents = RecorderEvents; window.UserMedia = UserMedia; console.log('âœ… è®¯é£SDKæ¨¡å—å·²åŠ è½½'); } catch (error) { console.error('âŒ SDKåŠ è½½å¤±è´¥:', error); } window.dispatchEvent(new CustomEvent('sdkReady'));
    </script>
    <script>
        const subtitleScript = { "1": "å‰é¢æˆ‘ä»¬å­¦ä¹ äº†å¯¼æ•°çš„å…¨éƒ¨å†…å®¹,ä»Šå¤©è¿›è¡Œç³»ç»Ÿå¤ä¹ å’Œç»¼åˆç»ƒä¹ !å¯¼æ•°å°±æ˜¯ç¬æ—¶å˜åŒ–ç‡,å‡ ä½•æ„ä¹‰æ˜¯åˆ‡çº¿æ–œç‡ã€‚", "2": "å…ˆå›é¡¾åŸºæœ¬æ±‚å¯¼å…¬å¼:å¹‚å‡½æ•°ã€æŒ‡æ•°å¯¹æ•°ã€ä¸‰è§’å‡½æ•°ã€‚è¿™äº›å…¬å¼å¿…é¡»èƒŒç†Ÿ!xçš„næ¬¡æ–¹å¯¼æ•°æ˜¯nxçš„nå‡1æ¬¡æ–¹ã€‚eçš„xæ¬¡æ–¹å¯¼æ•°è¿˜æ˜¯eçš„xæ¬¡æ–¹ã€‚", "3": "å†å›é¡¾å››å¤§è¿ç®—æ³•åˆ™:çº¿æ€§æ€§è´¨ã€ä¹˜æ³•æ³•åˆ™ã€é™¤æ³•æ³•åˆ™å’Œé“¾å¼æ³•åˆ™ã€‚ä¹˜æ³•æ³•åˆ™è®°ä½å£è¯€:å‰å¯¼åä¸å¯¼åŠ ä¸Šå‰ä¸å¯¼åå¯¼ã€‚é™¤æ³•æ³•åˆ™æ˜¯ä¸Šå¯¼ä¸‹å‡ä¸Šä¸‹å¯¼,é™¤ä»¥ä¸‹å¹³æ–¹ã€‚é“¾å¼æ³•åˆ™è¦ä»å¤–åˆ°å†…é€å±‚æ±‚å¯¼ã€‚", "4": "çœ‹ä¸€é“ç»¼åˆé¢˜:æ±‚ln sinæ‹¬å·xå¹³æ–¹åŠ 1çš„å¯¼æ•°ã€‚è¿™æ˜¯ä¸‰å±‚å¤åˆå‡½æ•°,å¤–å±‚æ˜¯ln,ä¸­å±‚æ˜¯sin,å†…å±‚æ˜¯xå¹³æ–¹åŠ 1ã€‚ä»å¤–åˆ°å†…é€å±‚æ±‚å¯¼,æœ€ååŒ–ç®€å¾—åˆ°2x cotæ‹¬å·xå¹³æ–¹åŠ 1ã€‚", "5": "å†çœ‹ä¸€é“ä¹˜é™¤æ··åˆé¢˜:æ±‚xå¹³æ–¹eçš„xæ¬¡æ–¹é™¤ä»¥ln xçš„å¯¼æ•°ã€‚å…ˆç”¨é™¤æ³•æ³•åˆ™,åˆ†å­ç”¨ä¹˜æ³•æ³•åˆ™ã€‚åˆ†å­çš„å¯¼æ•°æ˜¯2x eçš„xæ¬¡æ–¹åŠ xå¹³æ–¹eçš„xæ¬¡æ–¹,åˆ†æ¯çš„å¯¼æ•°æ˜¯1é™¤ä»¥x,æœ€åå¥—ç”¨é™¤æ³•æ³•åˆ™ã€‚", "6": "å¾®åˆ†çš„åº”ç”¨:ç”¨å¾®åˆ†ä¼°ç®—æ ¹å·1.05ã€‚è®¾å‡½æ•°æ˜¯æ ¹å·x,åœ¨xç­‰äº1å¤„,å¯¼æ•°æ˜¯äºŒåˆ†ä¹‹ä¸€ã€‚æ‰€ä»¥æ ¹å·1.05çº¦ç­‰äº1åŠ äºŒåˆ†ä¹‹ä¸€ä¹˜ä»¥0.05,ç­‰äº1.025ã€‚å®é™…å€¼æ˜¯1.024695,è¯¯å·®éå¸¸å°!", "7": "æ€»ç»“å¸¸è§æ˜“é”™ç‚¹ã€‚ç¬¬ä¸€,é“¾å¼æ³•åˆ™ä¸è¦é—æ¼å†…å±‚å¯¼æ•°ã€‚ç¬¬äºŒ,é™¤æ³•æ³•åˆ™æ˜¯å‡å·ä¸æ˜¯åŠ å·ã€‚ç¬¬ä¸‰,å¯¹æ•°ä¸æ˜¯è‡ªç„¶å¯¹æ•°æ—¶è¦é™¤ä»¥ln aã€‚", "8": "ä»Šå¤©å¤ä¹ äº†ç¬¬3ç« æ‰€æœ‰æ ¸å¿ƒå†…å®¹:å¯¼æ•°çš„å®šä¹‰å’Œå‡ ä½•æ„ä¹‰ã€åŸºæœ¬å…¬å¼ã€å››å¤§æ³•åˆ™ã€å¾®åˆ†åº”ç”¨ã€‚è®°ä½:å¯¼æ•°æ˜¯ç ”ç©¶å‡½æ•°å˜åŒ–çš„åŸºç¡€å·¥å…·,ç†Ÿç»ƒæŒæ¡åæ‰èƒ½å­¦å¥½åç»­çš„å¯¼æ•°åº”ç”¨!" };
        const actionMap = { "1": "A_RLH_welcome_O", "2": "A_RH_point_O", "3": "A_LH_introduced_O", "4": "A_RH_point_O", "5": "A_LH_introduced_O", "6": "A_RH_point_O", "7": "A_RH_point_O", "8": "A_RLH_welcome_O" };
        let currentSlide = 0; const totalSlides = 8; let avatarPlatform = null; let isConnected = false; let isTeaching = false; let isAutoPlaying = false; const slides = document.querySelectorAll('.slide');
        function showSlide(index) { slides.forEach((slide, i) => slide.classList.toggle('active', i === index)); currentSlide = index; document.getElementById('currentSlide').textContent = index + 1; if (window.MathJax && window.MathJax.typesetPromise) { window.MathJax.typesetPromise([slides[index]]).catch(err => console.error(err)); } document.getElementById('prevBtn').disabled = index === 0; document.getElementById('nextBtn').disabled = index === totalSlides - 1; updateSubtitle(index + 1); }
        function nextSlide() { if (currentSlide < totalSlides - 1) { showSlide(currentSlide + 1); if (!isAutoPlaying) speakContent(currentSlide + 1); } }
        function previousSlide() { if (currentSlide > 0) { showSlide(currentSlide - 1); if (!isAutoPlaying) speakContent(currentSlide + 1); } }
        function restart() { showSlide(0); if (avatarPlatform) { avatarPlatform.stop(); } isConnected = false; isTeaching = false; isAutoPlaying = false; }
        function updateSubtitle(slideNum) { const subtitleArea = document.getElementById('subtitleArea'); subtitleArea.textContent = subtitleScript[slideNum] || ''; }
        async function speakContent(slideNum) { if (!isTeaching || !isConnected || !avatarPlatform) { console.log('âš ï¸ è™šæ‹Ÿäººæœªè¿æ¥'); return; } const content = subtitleScript[slideNum]; if (!content) return; try { const action = actionMap[slideNum]; if (action) { await avatarPlatform.writeCmd("action", action); } await avatarPlatform.writeText(content, { nlp: false }); updateSubtitle(slideNum); } catch (error) { console.error('âŒ è®²è§£å¤±è´¥:', error); } }
        function updateStatus(message, type = 'normal') { const indicator = document.getElementById('statusIndicator'); if (indicator) { indicator.textContent = message; indicator.className = 'status-indicator'; if (type === 'connected') indicator.classList.add('connected'); else if (type === 'error') indicator.classList.add('error'); else if (type === 'connecting') indicator.classList.add('connecting'); } }
        function waitForSDK() { return new Promise((resolve, reject) => { if (typeof AvatarPlatform !== 'undefined') { resolve(); return; } const timeout = setTimeout(() => { reject(new Error('SDKåŠ è½½è¶…æ—¶')); }, 10000); window.addEventListener('sdkReady', function handler() { clearTimeout(timeout); window.removeEventListener('sdkReady', handler); resolve(); }); }); }
        async function startTeaching() { const startBtn = document.getElementById('startBtn'); startBtn.textContent = 'ğŸ”„ å¯åŠ¨ä¸­...'; startBtn.disabled = true; try { updateStatus('ç­‰å¾…SDK...', 'connecting'); await waitForSDK(); if(avatarPlatform) { avatarPlatform.destroy(); } avatarPlatform = new AvatarPlatform({ useInlinePlayer: true }); avatarPlatform.on('connected', (initResp) => { console.log('ğŸ‰ è¿æ¥æˆåŠŸ'); isConnected = true; isTeaching = true; updateStatus('å·²è¿æ¥', 'connected'); startBtn.textContent = 'ğŸ’– è™šæ‹Ÿäººå·²å°±ç»ª'; setTimeout(() => { speakContent(currentSlide + 1); }, 1000); }).on('disconnected', (err) => { isConnected = false; updateStatus('è¿æ¥æ–­å¼€', 'error'); }).on('error', (error) => { console.error('âŒ é”™è¯¯:', error); updateStatus('é”™è¯¯', 'error'); startBtn.textContent = 'âŒ è¿æ¥å¤±è´¥'; startBtn.disabled = false; isTeaching = false; }); avatarPlatform.setApiInfo({ appId: 'e8c180ed', apiKey: 'e0c44f0e2ef0f47582ffa7e864da0d9b', apiSecret: 'MDZkNDNiZWU4NDkzNWM5MDQzMTY4N2Nh', sceneId: '237415046114840576', serverUrl: 'wss://avatar.cn-huadong-1.xf-yun.com/v1/interact' }); avatarPlatform.setGlobalParams({ stream: { protocol: 'xrtc', alpha: 1, bitrate: 1000000, fps: 25 }, avatar: { avatar_id: '110332017', width: 1920, height: 1080, scale: 1, move_h: 0, move_v: 0, audio_format: 1 }, tts: { vcn: 'x4_yiting', speed: 50, pitch: 50, volume: 100 }, avatar_dispatch: { interactive_mode: 1, content_analysis: 0 } }); await avatarPlatform.start({ wrapper: document.getElementById('avatarWrapper') }); } catch (error) { console.error('âŒ å¯åŠ¨å¤±è´¥:', error); updateStatus('å¯åŠ¨å¤±è´¥', 'error'); startBtn.textContent = 'ğŸ€ å¼€å§‹è®²è¯¾'; startBtn.disabled = false; } }
        async function startAutoPlay() { if (!avatarPlatform || !isConnected) { await startTeaching(); await new Promise(resolve => setTimeout(resolve, 2000)); } isAutoPlaying = true; document.getElementById('autoPlayBtn').disabled = true; for (let i = currentSlide; i < totalSlides; i++) { showSlide(i); await speakContent(i + 1); const duration = (subtitleScript[i + 1].length / 4) * 1000 + 3000; await new Promise(resolve => setTimeout(resolve, duration)); } isAutoPlaying = false; document.getElementById('autoPlayBtn').disabled = false; window.playbackFinished = true; document.title = "PLAYBACK_FINISHED"; console.log('ğŸ‰ æ’­æ”¾å®Œæˆ'); }
        document.addEventListener('keydown', (e) => { if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextSlide(); } else if (e.key === 'ArrowLeft') { e.preventDefault(); previousSlide(); } else if (e.key === 'Enter') { e.preventDefault(); speakContent(currentSlide + 1); } });
        document.getElementById('totalSlides').textContent = totalSlides; showSlide(0);
        setTimeout(() => { console.log('ğŸš€ è‡ªåŠ¨å¯åŠ¨æ’­æ”¾...'); startAutoPlay(); }, 3000);
    </script>
</body>
</html>
