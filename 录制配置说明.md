# 自动化课件录制系统使用说明

## 一、系统要求

### 必需软件
1. **Python 3.8+**
2. **Google Chrome浏览器**
3. **ChromeDriver**（与Chrome版本匹配）
4. **FFmpeg**（用于视频录制）
5. **VB-Cable**（虚拟音频设备，你已安装）

### Python依赖包
```bash
pip install selenium pyautogui psutil
```

## 二、环境配置

### 1. 安装FFmpeg
- 下载地址：https://ffmpeg.org/download.html
- 下载Windows版本（推荐gyan.dev的完整版）
- 解压后将`bin`目录添加到系统PATH环境变量
- 验证安装：在命令行运行 `ffmpeg -version`

### 2. 安装ChromeDriver
- 查看Chrome版本：打开Chrome -> 设置 -> 关于Chrome
- 下载对应版本：https://chromedriver.chromium.org/downloads
- 将`chromedriver.exe`放到Python的Scripts目录或添加到PATH

### 3. 配置VB-Cable音频
你已经打开了VB-Cable，还需要：
1. 右键任务栏音量图标 -> 声音设置
2. 在"输出设备"中选择"CABLE Input (VB-Audio Virtual Cable)"
3. 确保浏览器音频会输出到VB-Cable

**重要**：录制时，系统声音会通过VB-Cable，你可能听不到。如果需要监听，可以：
- 打开"声音控制面板" -> "录制" -> "CABLE Output" -> "属性" -> "侦听" -> 勾选"侦听此设备"

## 三、使用方法

### 基本使用
```bash
python auto_record_courseware.py
```

### 自定义参数
编辑`auto_record_courseware.py`文件底部的配置：

```python
URL_FILE = r"D:\WPS Office\2025\254805819\WPS云盘\教材\视频讲解\URL编码链接.txt"
OUTPUT_DIR = "录制视频"  # 输出目录
RECORDING_DURATION = 300  # 每个视频录制时长（秒）
START_INDEX = 0  # 从第几个URL开始（0=从头开始）
```

### 断点续录
如果录制中断，可以修改`START_INDEX`从指定位置继续：
```python
START_INDEX = 10  # 从第11个URL开始录制
```

## 四、工作流程

1. **脚本启动** → 读取URL列表
2. **打开浏览器** → 加载第一个课件URL
3. **自动点击播放** → 查找并点击"自动播放"或"播放"按钮
4. **开始录制** → FFmpeg录制浏览器窗口+VB-Cable音频
5. **等待完成** → 录制指定时长后自动停止
6. **保存视频** → 输出为MP4文件
7. **继续下一个** → 重复步骤2-6

## 五、关于"后台录制"的说明

### 当前方案的限制
- 浏览器窗口会打开并显示在屏幕上
- 录制的是该浏览器窗口的内容
- **你可以继续使用电脑**，但不要最小化或遮挡浏览器窗口
- 不会锁定鼠标/键盘，你可以在其他窗口工作

### 如何实现真正的后台录制
如果需要完全后台（不显示窗口），需要：

#### 方案A：虚拟显示器（推荐）
1. 安装虚拟显示器驱动（如IddSampleDriver）
2. 在虚拟显示器上打开浏览器
3. 录制虚拟显示器内容

#### 方案B：无头浏览器+Canvas录制
1. 使用Puppeteer（Node.js）或Playwright
2. 在无头模式下运行浏览器
3. 使用浏览器内置的媒体录制API

**当前脚本采用的是"半后台"方案**：
- ✓ 不影响你的鼠标/键盘操作
- ✓ 可以在其他窗口工作
- ✗ 浏览器窗口会可见（但可以放在第二个显示器）
- ✗ 不能最小化浏览器窗口

## 六、常见问题

### Q1: 提示找不到FFmpeg
**A**: 确保FFmpeg已添加到PATH环境变量，重启命令行窗口

### Q2: 录制的视频没有声音
**A**: 检查：
1. VB-Cable是否正确安装
2. 系统音频输出是否设置为"CABLE Input"
3. FFmpeg命令中的音频设备名称是否正确

验证音频设备名称：
```bash
ffmpeg -list_devices true -f dshow -i dummy
```
查找"CABLE Output"的准确名称

### Q3: 找不到播放按钮
**A**: 脚本会尝试多种方式查找，如果失败会继续录制。你可以：
1. 手动在浏览器中点击播放（脚本会等待几秒）
2. 修改脚本中的选择器以匹配你的网页

### Q4: 录制时长如何确定
**A**: 建议：
1. 先手动打开一个课件，看完整播放需要多长时间
2. 设置`RECORDING_DURATION`为该时长+10秒缓冲

### Q5: 可以同时录制多个吗
**A**: 当前脚本是顺序录制。如果要并行录制：
1. 需要多个浏览器实例
2. 需要更复杂的窗口管理
3. 建议使用虚拟显示器方案

## 七、优化建议

### 1. 双显示器设置
如果有第二个显示器：
- 将浏览器窗口移到第二个显示器
- 在主显示器上正常工作
- 互不干扰

### 2. 自动检测播放完成
当前是固定时长录制，可以改进为：
- 检测网页中的"播放完成"标志
- 自动停止录制

### 3. 批量处理优化
- 使用多线程/多进程
- 使用虚拟显示器
- 云端录制（如使用Selenium Grid）

## 八、测试步骤

### 首次使用建议
1. **测试单个URL**：
   ```python
   START_INDEX = 0
   RECORDING_DURATION = 30  # 先录30秒测试
   ```

2. **检查输出**：
   - 查看`录制视频`目录
   - 播放视频检查画面和声音

3. **调整参数**：
   - 根据实际课件时长调整`RECORDING_DURATION`
   - 如果播放按钮未找到，添加自定义选择器

4. **批量录制**：
   - 确认无误后，设置完整时长
   - 运行完整批次

## 九、脚本输出

### 控制台输出示例
```
共找到 53 个URL
从第 1 个开始录制
每个视频录制时长: 300秒

============================================================
正在录制 [1/53]: https://cherishwy1974.github.io/123/01_1.1_...
============================================================
正在加载网页...
浏览器窗口: {'x': 0, 'y': 0, 'width': 1920, 'height': 1080}
找到播放按钮: //button[contains(text(), '自动播放')]
已点击播放按钮
开始录制，时长: 300秒
录制进行中...
已录制 0/300 秒
已录制 30/300 秒
...
正在停止录制...
录制已停止
✓ 录制完成: 录制视频\01_1.1_指数的概念与运算.mp4
```

### 输出文件结构
```
录制视频/
├── 01_1.1_指数的概念与运算.mp4
├── 01_1.2_对数的概念与运算.mp4
├── 01_1.3_函数的基本概念.mp4
└── ...
```

## 十、进阶：完全后台录制方案

如果确实需要完全后台，我可以提供：
1. **虚拟显示器方案**的详细配置脚本
2. **Puppeteer方案**的Node.js脚本
3. **云端录制方案**（使用Docker + Selenium Grid）

请告诉我是否需要这些进阶方案。

